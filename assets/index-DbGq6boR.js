(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();function rs(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var eu={exports:{}},Vi={},tu={exports:{}},Ie={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lh;function yy(){if(Lh)return Ie;Lh=1;var o=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),m=Symbol.iterator;function y(D){return D===null||typeof D!="object"?null:(D=m&&D[m]||D["@@iterator"],typeof D=="function"?D:null)}var T={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,x={};function S(D,$,se){this.props=D,this.context=$,this.refs=x,this.updater=se||T}S.prototype.isReactComponent={},S.prototype.setState=function(D,$){if(typeof D!="object"&&typeof D!="function"&&D!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,D,$,"setState")},S.prototype.forceUpdate=function(D){this.updater.enqueueForceUpdate(this,D,"forceUpdate")};function R(){}R.prototype=S.prototype;function I(D,$,se){this.props=D,this.context=$,this.refs=x,this.updater=se||T}var w=I.prototype=new R;w.constructor=I,v(w,S.prototype),w.isPureReactComponent=!0;var b=Array.isArray,_=Object.prototype.hasOwnProperty,K={current:null},U={key:!0,ref:!0,__self:!0,__source:!0};function z(D,$,se){var de,xe={},Se=null,Ce=null;if($!=null)for(de in $.ref!==void 0&&(Ce=$.ref),$.key!==void 0&&(Se=""+$.key),$)_.call($,de)&&!U.hasOwnProperty(de)&&(xe[de]=$[de]);var ke=arguments.length-2;if(ke===1)xe.children=se;else if(1<ke){for(var Ne=Array(ke),It=0;It<ke;It++)Ne[It]=arguments[It+2];xe.children=Ne}if(D&&D.defaultProps)for(de in ke=D.defaultProps,ke)xe[de]===void 0&&(xe[de]=ke[de]);return{$$typeof:o,type:D,key:Se,ref:Ce,props:xe,_owner:K.current}}function ee(D,$){return{$$typeof:o,type:D.type,key:$,ref:D.ref,props:D.props,_owner:D._owner}}function V(D){return typeof D=="object"&&D!==null&&D.$$typeof===o}function Q(D){var $={"=":"=0",":":"=2"};return"$"+D.replace(/[=:]/g,function(se){return $[se]})}var ge=/\/+/g;function re(D,$){return typeof D=="object"&&D!==null&&D.key!=null?Q(""+D.key):$.toString(36)}function he(D,$,se,de,xe){var Se=typeof D;(Se==="undefined"||Se==="boolean")&&(D=null);var Ce=!1;if(D===null)Ce=!0;else switch(Se){case"string":case"number":Ce=!0;break;case"object":switch(D.$$typeof){case o:case e:Ce=!0}}if(Ce)return Ce=D,xe=xe(Ce),D=de===""?"."+re(Ce,0):de,b(xe)?(se="",D!=null&&(se=D.replace(ge,"$&/")+"/"),he(xe,$,se,"",function(It){return It})):xe!=null&&(V(xe)&&(xe=ee(xe,se+(!xe.key||Ce&&Ce.key===xe.key?"":(""+xe.key).replace(ge,"$&/")+"/")+D)),$.push(xe)),1;if(Ce=0,de=de===""?".":de+":",b(D))for(var ke=0;ke<D.length;ke++){Se=D[ke];var Ne=de+re(Se,ke);Ce+=he(Se,$,se,Ne,xe)}else if(Ne=y(D),typeof Ne=="function")for(D=Ne.call(D),ke=0;!(Se=D.next()).done;)Se=Se.value,Ne=de+re(Se,ke++),Ce+=he(Se,$,se,Ne,xe);else if(Se==="object")throw $=String(D),Error("Objects are not valid as a React child (found: "+($==="[object Object]"?"object with keys {"+Object.keys(D).join(", ")+"}":$)+"). If you meant to render a collection of children, use an array instead.");return Ce}function pe(D,$,se){if(D==null)return D;var de=[],xe=0;return he(D,de,"","",function(Se){return $.call(se,Se,xe++)}),de}function le(D){if(D._status===-1){var $=D._result;$=$(),$.then(function(se){(D._status===0||D._status===-1)&&(D._status=1,D._result=se)},function(se){(D._status===0||D._status===-1)&&(D._status=2,D._result=se)}),D._status===-1&&(D._status=0,D._result=$)}if(D._status===1)return D._result.default;throw D._result}var me={current:null},J={transition:null},W={ReactCurrentDispatcher:me,ReactCurrentBatchConfig:J,ReactCurrentOwner:K};function H(){throw Error("act(...) is not supported in production builds of React.")}return Ie.Children={map:pe,forEach:function(D,$,se){pe(D,function(){$.apply(this,arguments)},se)},count:function(D){var $=0;return pe(D,function(){$++}),$},toArray:function(D){return pe(D,function($){return $})||[]},only:function(D){if(!V(D))throw Error("React.Children.only expected to receive a single React element child.");return D}},Ie.Component=S,Ie.Fragment=t,Ie.Profiler=i,Ie.PureComponent=I,Ie.StrictMode=n,Ie.Suspense=f,Ie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W,Ie.act=H,Ie.cloneElement=function(D,$,se){if(D==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+D+".");var de=v({},D.props),xe=D.key,Se=D.ref,Ce=D._owner;if($!=null){if($.ref!==void 0&&(Se=$.ref,Ce=K.current),$.key!==void 0&&(xe=""+$.key),D.type&&D.type.defaultProps)var ke=D.type.defaultProps;for(Ne in $)_.call($,Ne)&&!U.hasOwnProperty(Ne)&&(de[Ne]=$[Ne]===void 0&&ke!==void 0?ke[Ne]:$[Ne])}var Ne=arguments.length-2;if(Ne===1)de.children=se;else if(1<Ne){ke=Array(Ne);for(var It=0;It<Ne;It++)ke[It]=arguments[It+2];de.children=ke}return{$$typeof:o,type:D.type,key:xe,ref:Se,props:de,_owner:Ce}},Ie.createContext=function(D){return D={$$typeof:l,_currentValue:D,_currentValue2:D,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},D.Provider={$$typeof:a,_context:D},D.Consumer=D},Ie.createElement=z,Ie.createFactory=function(D){var $=z.bind(null,D);return $.type=D,$},Ie.createRef=function(){return{current:null}},Ie.forwardRef=function(D){return{$$typeof:u,render:D}},Ie.isValidElement=V,Ie.lazy=function(D){return{$$typeof:p,_payload:{_status:-1,_result:D},_init:le}},Ie.memo=function(D,$){return{$$typeof:d,type:D,compare:$===void 0?null:$}},Ie.startTransition=function(D){var $=J.transition;J.transition={};try{D()}finally{J.transition=$}},Ie.unstable_act=H,Ie.useCallback=function(D,$){return me.current.useCallback(D,$)},Ie.useContext=function(D){return me.current.useContext(D)},Ie.useDebugValue=function(){},Ie.useDeferredValue=function(D){return me.current.useDeferredValue(D)},Ie.useEffect=function(D,$){return me.current.useEffect(D,$)},Ie.useId=function(){return me.current.useId()},Ie.useImperativeHandle=function(D,$,se){return me.current.useImperativeHandle(D,$,se)},Ie.useInsertionEffect=function(D,$){return me.current.useInsertionEffect(D,$)},Ie.useLayoutEffect=function(D,$){return me.current.useLayoutEffect(D,$)},Ie.useMemo=function(D,$){return me.current.useMemo(D,$)},Ie.useReducer=function(D,$,se){return me.current.useReducer(D,$,se)},Ie.useRef=function(D){return me.current.useRef(D)},Ie.useState=function(D){return me.current.useState(D)},Ie.useSyncExternalStore=function(D,$,se){return me.current.useSyncExternalStore(D,$,se)},Ie.useTransition=function(){return me.current.useTransition()},Ie.version="18.3.1",Ie}var Ah;function to(){return Ah||(Ah=1,tu.exports=yy()),tu.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rh;function Ey(){if(Rh)return Vi;Rh=1;var o=to(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function l(u,f,d){var p,m={},y=null,T=null;d!==void 0&&(y=""+d),f.key!==void 0&&(y=""+f.key),f.ref!==void 0&&(T=f.ref);for(p in f)n.call(f,p)&&!a.hasOwnProperty(p)&&(m[p]=f[p]);if(u&&u.defaultProps)for(p in f=u.defaultProps,f)m[p]===void 0&&(m[p]=f[p]);return{$$typeof:e,type:u,key:y,ref:T,props:m,_owner:i.current}}return Vi.Fragment=t,Vi.jsx=l,Vi.jsxs=l,Vi}var wh;function vy(){return wh||(wh=1,eu.exports=Ey()),eu.exports}var X=vy(),j=to();const qi=rs(j);var ya={},nu={exports:{}},At={},ru={exports:{}},iu={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ch;function Ty(){return Ch||(Ch=1,function(o){function e(J,W){var H=J.length;J.push(W);e:for(;0<H;){var D=H-1>>>1,$=J[D];if(0<i($,W))J[D]=W,J[H]=$,H=D;else break e}}function t(J){return J.length===0?null:J[0]}function n(J){if(J.length===0)return null;var W=J[0],H=J.pop();if(H!==W){J[0]=H;e:for(var D=0,$=J.length,se=$>>>1;D<se;){var de=2*(D+1)-1,xe=J[de],Se=de+1,Ce=J[Se];if(0>i(xe,H))Se<$&&0>i(Ce,xe)?(J[D]=Ce,J[Se]=H,D=Se):(J[D]=xe,J[de]=H,D=de);else if(Se<$&&0>i(Ce,H))J[D]=Ce,J[Se]=H,D=Se;else break e}}return W}function i(J,W){var H=J.sortIndex-W.sortIndex;return H!==0?H:J.id-W.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;o.unstable_now=function(){return a.now()}}else{var l=Date,u=l.now();o.unstable_now=function(){return l.now()-u}}var f=[],d=[],p=1,m=null,y=3,T=!1,v=!1,x=!1,S=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(J){for(var W=t(d);W!==null;){if(W.callback===null)n(d);else if(W.startTime<=J)n(d),W.sortIndex=W.expirationTime,e(f,W);else break;W=t(d)}}function b(J){if(x=!1,w(J),!v)if(t(f)!==null)v=!0,le(_);else{var W=t(d);W!==null&&me(b,W.startTime-J)}}function _(J,W){v=!1,x&&(x=!1,R(z),z=-1),T=!0;var H=y;try{for(w(W),m=t(f);m!==null&&(!(m.expirationTime>W)||J&&!Q());){var D=m.callback;if(typeof D=="function"){m.callback=null,y=m.priorityLevel;var $=D(m.expirationTime<=W);W=o.unstable_now(),typeof $=="function"?m.callback=$:m===t(f)&&n(f),w(W)}else n(f);m=t(f)}if(m!==null)var se=!0;else{var de=t(d);de!==null&&me(b,de.startTime-W),se=!1}return se}finally{m=null,y=H,T=!1}}var K=!1,U=null,z=-1,ee=5,V=-1;function Q(){return!(o.unstable_now()-V<ee)}function ge(){if(U!==null){var J=o.unstable_now();V=J;var W=!0;try{W=U(!0,J)}finally{W?re():(K=!1,U=null)}}else K=!1}var re;if(typeof I=="function")re=function(){I(ge)};else if(typeof MessageChannel<"u"){var he=new MessageChannel,pe=he.port2;he.port1.onmessage=ge,re=function(){pe.postMessage(null)}}else re=function(){S(ge,0)};function le(J){U=J,K||(K=!0,re())}function me(J,W){z=S(function(){J(o.unstable_now())},W)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(J){J.callback=null},o.unstable_continueExecution=function(){v||T||(v=!0,le(_))},o.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ee=0<J?Math.floor(1e3/J):5},o.unstable_getCurrentPriorityLevel=function(){return y},o.unstable_getFirstCallbackNode=function(){return t(f)},o.unstable_next=function(J){switch(y){case 1:case 2:case 3:var W=3;break;default:W=y}var H=y;y=W;try{return J()}finally{y=H}},o.unstable_pauseExecution=function(){},o.unstable_requestPaint=function(){},o.unstable_runWithPriority=function(J,W){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var H=y;y=J;try{return W()}finally{y=H}},o.unstable_scheduleCallback=function(J,W,H){var D=o.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?D+H:D):H=D,J){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=H+$,J={id:p++,callback:W,priorityLevel:J,startTime:H,expirationTime:$,sortIndex:-1},H>D?(J.sortIndex=H,e(d,J),t(f)===null&&J===t(d)&&(x?(R(z),z=-1):x=!0,me(b,H-D))):(J.sortIndex=$,e(f,J),v||T||(v=!0,le(_))),J},o.unstable_shouldYield=Q,o.unstable_wrapCallback=function(J){var W=y;return function(){var H=y;y=W;try{return J.apply(this,arguments)}finally{y=H}}}}(iu)),iu}var Ih;function xy(){return Ih||(Ih=1,ru.exports=Ty()),ru.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kh;function Sy(){if(kh)return At;kh=1;var o=to(),e=xy();function t(r){for(var s="https://reactjs.org/docs/error-decoder.html?invariant="+r,c=1;c<arguments.length;c++)s+="&args[]="+encodeURIComponent(arguments[c]);return"Minified React error #"+r+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,i={};function a(r,s){l(r,s),l(r+"Capture",s)}function l(r,s){for(i[r]=s,r=0;r<s.length;r++)n.add(s[r])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},m={};function y(r){return f.call(m,r)?!0:f.call(p,r)?!1:d.test(r)?m[r]=!0:(p[r]=!0,!1)}function T(r,s,c,h){if(c!==null&&c.type===0)return!1;switch(typeof s){case"function":case"symbol":return!0;case"boolean":return h?!1:c!==null?!c.acceptsBooleans:(r=r.toLowerCase().slice(0,5),r!=="data-"&&r!=="aria-");default:return!1}}function v(r,s,c,h){if(s===null||typeof s>"u"||T(r,s,c,h))return!0;if(h)return!1;if(c!==null)switch(c.type){case 3:return!s;case 4:return s===!1;case 5:return isNaN(s);case 6:return isNaN(s)||1>s}return!1}function x(r,s,c,h,g,E,A){this.acceptsBooleans=s===2||s===3||s===4,this.attributeName=h,this.attributeNamespace=g,this.mustUseProperty=c,this.propertyName=r,this.type=s,this.sanitizeURL=E,this.removeEmptyString=A}var S={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(r){S[r]=new x(r,0,!1,r,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var s=r[0];S[s]=new x(s,1,!1,r[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(r){S[r]=new x(r,2,!1,r.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){S[r]=new x(r,2,!1,r,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(r){S[r]=new x(r,3,!1,r.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(r){S[r]=new x(r,3,!0,r,null,!1,!1)}),["capture","download"].forEach(function(r){S[r]=new x(r,4,!1,r,null,!1,!1)}),["cols","rows","size","span"].forEach(function(r){S[r]=new x(r,6,!1,r,null,!1,!1)}),["rowSpan","start"].forEach(function(r){S[r]=new x(r,5,!1,r.toLowerCase(),null,!1,!1)});var R=/[\-:]([a-z])/g;function I(r){return r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(r){var s=r.replace(R,I);S[s]=new x(s,1,!1,r,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(r){var s=r.replace(R,I);S[s]=new x(s,1,!1,r,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(r){var s=r.replace(R,I);S[s]=new x(s,1,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(r){S[r]=new x(r,1,!1,r.toLowerCase(),null,!1,!1)}),S.xlinkHref=new x("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(r){S[r]=new x(r,1,!1,r.toLowerCase(),null,!0,!0)});function w(r,s,c,h){var g=S.hasOwnProperty(s)?S[s]:null;(g!==null?g.type!==0:h||!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(v(s,c,g,h)&&(c=null),h||g===null?y(s)&&(c===null?r.removeAttribute(s):r.setAttribute(s,""+c)):g.mustUseProperty?r[g.propertyName]=c===null?g.type===3?!1:"":c:(s=g.attributeName,h=g.attributeNamespace,c===null?r.removeAttribute(s):(g=g.type,c=g===3||g===4&&c===!0?"":""+c,h?r.setAttributeNS(h,s,c):r.setAttribute(s,c))))}var b=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_=Symbol.for("react.element"),K=Symbol.for("react.portal"),U=Symbol.for("react.fragment"),z=Symbol.for("react.strict_mode"),ee=Symbol.for("react.profiler"),V=Symbol.for("react.provider"),Q=Symbol.for("react.context"),ge=Symbol.for("react.forward_ref"),re=Symbol.for("react.suspense"),he=Symbol.for("react.suspense_list"),pe=Symbol.for("react.memo"),le=Symbol.for("react.lazy"),me=Symbol.for("react.offscreen"),J=Symbol.iterator;function W(r){return r===null||typeof r!="object"?null:(r=J&&r[J]||r["@@iterator"],typeof r=="function"?r:null)}var H=Object.assign,D;function $(r){if(D===void 0)try{throw Error()}catch(c){var s=c.stack.trim().match(/\n( *(at )?)/);D=s&&s[1]||""}return`
`+D+r}var se=!1;function de(r,s){if(!r||se)return"";se=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(s)if(s=function(){throw Error()},Object.defineProperty(s.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(s,[])}catch(B){var h=B}Reflect.construct(r,[],s)}else{try{s.call()}catch(B){h=B}r.call(s.prototype)}else{try{throw Error()}catch(B){h=B}r()}}catch(B){if(B&&h&&typeof B.stack=="string"){for(var g=B.stack.split(`
`),E=h.stack.split(`
`),A=g.length-1,C=E.length-1;1<=A&&0<=C&&g[A]!==E[C];)C--;for(;1<=A&&0<=C;A--,C--)if(g[A]!==E[C]){if(A!==1||C!==1)do if(A--,C--,0>C||g[A]!==E[C]){var k=`
`+g[A].replace(" at new "," at ");return r.displayName&&k.includes("<anonymous>")&&(k=k.replace("<anonymous>",r.displayName)),k}while(1<=A&&0<=C);break}}}finally{se=!1,Error.prepareStackTrace=c}return(r=r?r.displayName||r.name:"")?$(r):""}function xe(r){switch(r.tag){case 5:return $(r.type);case 16:return $("Lazy");case 13:return $("Suspense");case 19:return $("SuspenseList");case 0:case 2:case 15:return r=de(r.type,!1),r;case 11:return r=de(r.type.render,!1),r;case 1:return r=de(r.type,!0),r;default:return""}}function Se(r){if(r==null)return null;if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case U:return"Fragment";case K:return"Portal";case ee:return"Profiler";case z:return"StrictMode";case re:return"Suspense";case he:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case Q:return(r.displayName||"Context")+".Consumer";case V:return(r._context.displayName||"Context")+".Provider";case ge:var s=r.render;return r=r.displayName,r||(r=s.displayName||s.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case pe:return s=r.displayName||null,s!==null?s:Se(r.type)||"Memo";case le:s=r._payload,r=r._init;try{return Se(r(s))}catch{}}return null}function Ce(r){var s=r.type;switch(r.tag){case 24:return"Cache";case 9:return(s.displayName||"Context")+".Consumer";case 10:return(s._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return r=s.render,r=r.displayName||r.name||"",s.displayName||(r!==""?"ForwardRef("+r+")":"ForwardRef");case 7:return"Fragment";case 5:return s;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Se(s);case 8:return s===z?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s}return null}function ke(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Ne(r){var s=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function It(r){var s=Ne(r)?"checked":"value",c=Object.getOwnPropertyDescriptor(r.constructor.prototype,s),h=""+r[s];if(!r.hasOwnProperty(s)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var g=c.get,E=c.set;return Object.defineProperty(r,s,{configurable:!0,get:function(){return g.call(this)},set:function(A){h=""+A,E.call(this,A)}}),Object.defineProperty(r,s,{enumerable:c.enumerable}),{getValue:function(){return h},setValue:function(A){h=""+A},stopTracking:function(){r._valueTracker=null,delete r[s]}}}}function os(r){r._valueTracker||(r._valueTracker=It(r))}function Ic(r){if(!r)return!1;var s=r._valueTracker;if(!s)return!0;var c=s.getValue(),h="";return r&&(h=Ne(r)?r.checked?"true":"false":r.value),r=h,r!==c?(s.setValue(r),!0):!1}function ls(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}function ao(r,s){var c=s.checked;return H({},s,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:c??r._wrapperState.initialChecked})}function kc(r,s){var c=s.defaultValue==null?"":s.defaultValue,h=s.checked!=null?s.checked:s.defaultChecked;c=ke(s.value!=null?s.value:c),r._wrapperState={initialChecked:h,initialValue:c,controlled:s.type==="checkbox"||s.type==="radio"?s.checked!=null:s.value!=null}}function Dc(r,s){s=s.checked,s!=null&&w(r,"checked",s,!1)}function oo(r,s){Dc(r,s);var c=ke(s.value),h=s.type;if(c!=null)h==="number"?(c===0&&r.value===""||r.value!=c)&&(r.value=""+c):r.value!==""+c&&(r.value=""+c);else if(h==="submit"||h==="reset"){r.removeAttribute("value");return}s.hasOwnProperty("value")?lo(r,s.type,c):s.hasOwnProperty("defaultValue")&&lo(r,s.type,ke(s.defaultValue)),s.checked==null&&s.defaultChecked!=null&&(r.defaultChecked=!!s.defaultChecked)}function _c(r,s,c){if(s.hasOwnProperty("value")||s.hasOwnProperty("defaultValue")){var h=s.type;if(!(h!=="submit"&&h!=="reset"||s.value!==void 0&&s.value!==null))return;s=""+r._wrapperState.initialValue,c||s===r.value||(r.value=s),r.defaultValue=s}c=r.name,c!==""&&(r.name=""),r.defaultChecked=!!r._wrapperState.initialChecked,c!==""&&(r.name=c)}function lo(r,s,c){(s!=="number"||ls(r.ownerDocument)!==r)&&(c==null?r.defaultValue=""+r._wrapperState.initialValue:r.defaultValue!==""+c&&(r.defaultValue=""+c))}var ii=Array.isArray;function Tr(r,s,c,h){if(r=r.options,s){s={};for(var g=0;g<c.length;g++)s["$"+c[g]]=!0;for(c=0;c<r.length;c++)g=s.hasOwnProperty("$"+r[c].value),r[c].selected!==g&&(r[c].selected=g),g&&h&&(r[c].defaultSelected=!0)}else{for(c=""+ke(c),s=null,g=0;g<r.length;g++){if(r[g].value===c){r[g].selected=!0,h&&(r[g].defaultSelected=!0);return}s!==null||r[g].disabled||(s=r[g])}s!==null&&(s.selected=!0)}}function uo(r,s){if(s.dangerouslySetInnerHTML!=null)throw Error(t(91));return H({},s,{value:void 0,defaultValue:void 0,children:""+r._wrapperState.initialValue})}function Pc(r,s){var c=s.value;if(c==null){if(c=s.children,s=s.defaultValue,c!=null){if(s!=null)throw Error(t(92));if(ii(c)){if(1<c.length)throw Error(t(93));c=c[0]}s=c}s==null&&(s=""),c=s}r._wrapperState={initialValue:ke(c)}}function bc(r,s){var c=ke(s.value),h=ke(s.defaultValue);c!=null&&(c=""+c,c!==r.value&&(r.value=c),s.defaultValue==null&&r.defaultValue!==c&&(r.defaultValue=c)),h!=null&&(r.defaultValue=""+h)}function Oc(r){var s=r.textContent;s===r._wrapperState.initialValue&&s!==""&&s!==null&&(r.value=s)}function Fc(r){switch(r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function co(r,s){return r==null||r==="http://www.w3.org/1999/xhtml"?Fc(s):r==="http://www.w3.org/2000/svg"&&s==="foreignObject"?"http://www.w3.org/1999/xhtml":r}var us,Nc=function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(s,c,h,g){MSApp.execUnsafeLocalFunction(function(){return r(s,c,h,g)})}:r}(function(r,s){if(r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in r)r.innerHTML=s;else{for(us=us||document.createElement("div"),us.innerHTML="<svg>"+s.valueOf().toString()+"</svg>",s=us.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;s.firstChild;)r.appendChild(s.firstChild)}});function si(r,s){if(s){var c=r.firstChild;if(c&&c===r.lastChild&&c.nodeType===3){c.nodeValue=s;return}}r.textContent=s}var ai={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Sg=["Webkit","ms","Moz","O"];Object.keys(ai).forEach(function(r){Sg.forEach(function(s){s=s+r.charAt(0).toUpperCase()+r.substring(1),ai[s]=ai[r]})});function Mc(r,s,c){return s==null||typeof s=="boolean"||s===""?"":c||typeof s!="number"||s===0||ai.hasOwnProperty(r)&&ai[r]?(""+s).trim():s+"px"}function Uc(r,s){r=r.style;for(var c in s)if(s.hasOwnProperty(c)){var h=c.indexOf("--")===0,g=Mc(c,s[c],h);c==="float"&&(c="cssFloat"),h?r.setProperty(c,g):r[c]=g}}var Lg=H({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function fo(r,s){if(s){if(Lg[r]&&(s.children!=null||s.dangerouslySetInnerHTML!=null))throw Error(t(137,r));if(s.dangerouslySetInnerHTML!=null){if(s.children!=null)throw Error(t(60));if(typeof s.dangerouslySetInnerHTML!="object"||!("__html"in s.dangerouslySetInnerHTML))throw Error(t(61))}if(s.style!=null&&typeof s.style!="object")throw Error(t(62))}}function ho(r,s){if(r.indexOf("-")===-1)return typeof s.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var po=null;function mo(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var go=null,xr=null,Sr=null;function Bc(r){if(r=Ii(r)){if(typeof go!="function")throw Error(t(280));var s=r.stateNode;s&&(s=Ps(s),go(r.stateNode,r.type,s))}}function $c(r){xr?Sr?Sr.push(r):Sr=[r]:xr=r}function Gc(){if(xr){var r=xr,s=Sr;if(Sr=xr=null,Bc(r),s)for(r=0;r<s.length;r++)Bc(s[r])}}function Hc(r,s){return r(s)}function Vc(){}var yo=!1;function Kc(r,s,c){if(yo)return r(s,c);yo=!0;try{return Hc(r,s,c)}finally{yo=!1,(xr!==null||Sr!==null)&&(Vc(),Gc())}}function oi(r,s){var c=r.stateNode;if(c===null)return null;var h=Ps(c);if(h===null)return null;c=h[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(r=r.type,h=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!h;break e;default:r=!1}if(r)return null;if(c&&typeof c!="function")throw Error(t(231,s,typeof c));return c}var Eo=!1;if(u)try{var li={};Object.defineProperty(li,"passive",{get:function(){Eo=!0}}),window.addEventListener("test",li,li),window.removeEventListener("test",li,li)}catch{Eo=!1}function Ag(r,s,c,h,g,E,A,C,k){var B=Array.prototype.slice.call(arguments,3);try{s.apply(c,B)}catch(Z){this.onError(Z)}}var ui=!1,cs=null,fs=!1,vo=null,Rg={onError:function(r){ui=!0,cs=r}};function wg(r,s,c,h,g,E,A,C,k){ui=!1,cs=null,Ag.apply(Rg,arguments)}function Cg(r,s,c,h,g,E,A,C,k){if(wg.apply(this,arguments),ui){if(ui){var B=cs;ui=!1,cs=null}else throw Error(t(198));fs||(fs=!0,vo=B)}}function Zn(r){var s=r,c=r;if(r.alternate)for(;s.return;)s=s.return;else{r=s;do s=r,s.flags&4098&&(c=s.return),r=s.return;while(r)}return s.tag===3?c:null}function jc(r){if(r.tag===13){var s=r.memoizedState;if(s===null&&(r=r.alternate,r!==null&&(s=r.memoizedState)),s!==null)return s.dehydrated}return null}function zc(r){if(Zn(r)!==r)throw Error(t(188))}function Ig(r){var s=r.alternate;if(!s){if(s=Zn(r),s===null)throw Error(t(188));return s!==r?null:r}for(var c=r,h=s;;){var g=c.return;if(g===null)break;var E=g.alternate;if(E===null){if(h=g.return,h!==null){c=h;continue}break}if(g.child===E.child){for(E=g.child;E;){if(E===c)return zc(g),r;if(E===h)return zc(g),s;E=E.sibling}throw Error(t(188))}if(c.return!==h.return)c=g,h=E;else{for(var A=!1,C=g.child;C;){if(C===c){A=!0,c=g,h=E;break}if(C===h){A=!0,h=g,c=E;break}C=C.sibling}if(!A){for(C=E.child;C;){if(C===c){A=!0,c=E,h=g;break}if(C===h){A=!0,h=E,c=g;break}C=C.sibling}if(!A)throw Error(t(189))}}if(c.alternate!==h)throw Error(t(190))}if(c.tag!==3)throw Error(t(188));return c.stateNode.current===c?r:s}function Wc(r){return r=Ig(r),r!==null?Yc(r):null}function Yc(r){if(r.tag===5||r.tag===6)return r;for(r=r.child;r!==null;){var s=Yc(r);if(s!==null)return s;r=r.sibling}return null}var qc=e.unstable_scheduleCallback,Xc=e.unstable_cancelCallback,kg=e.unstable_shouldYield,Dg=e.unstable_requestPaint,Xe=e.unstable_now,_g=e.unstable_getCurrentPriorityLevel,To=e.unstable_ImmediatePriority,Qc=e.unstable_UserBlockingPriority,ds=e.unstable_NormalPriority,Pg=e.unstable_LowPriority,Jc=e.unstable_IdlePriority,hs=null,Zt=null;function bg(r){if(Zt&&typeof Zt.onCommitFiberRoot=="function")try{Zt.onCommitFiberRoot(hs,r,void 0,(r.current.flags&128)===128)}catch{}}var Ht=Math.clz32?Math.clz32:Ng,Og=Math.log,Fg=Math.LN2;function Ng(r){return r>>>=0,r===0?32:31-(Og(r)/Fg|0)|0}var ps=64,ms=4194304;function ci(r){switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return r}}function gs(r,s){var c=r.pendingLanes;if(c===0)return 0;var h=0,g=r.suspendedLanes,E=r.pingedLanes,A=c&268435455;if(A!==0){var C=A&~g;C!==0?h=ci(C):(E&=A,E!==0&&(h=ci(E)))}else A=c&~g,A!==0?h=ci(A):E!==0&&(h=ci(E));if(h===0)return 0;if(s!==0&&s!==h&&!(s&g)&&(g=h&-h,E=s&-s,g>=E||g===16&&(E&4194240)!==0))return s;if(h&4&&(h|=c&16),s=r.entangledLanes,s!==0)for(r=r.entanglements,s&=h;0<s;)c=31-Ht(s),g=1<<c,h|=r[c],s&=~g;return h}function Mg(r,s){switch(r){case 1:case 2:case 4:return s+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ug(r,s){for(var c=r.suspendedLanes,h=r.pingedLanes,g=r.expirationTimes,E=r.pendingLanes;0<E;){var A=31-Ht(E),C=1<<A,k=g[A];k===-1?(!(C&c)||C&h)&&(g[A]=Mg(C,s)):k<=s&&(r.expiredLanes|=C),E&=~C}}function xo(r){return r=r.pendingLanes&-1073741825,r!==0?r:r&1073741824?1073741824:0}function Zc(){var r=ps;return ps<<=1,!(ps&4194240)&&(ps=64),r}function So(r){for(var s=[],c=0;31>c;c++)s.push(r);return s}function fi(r,s,c){r.pendingLanes|=s,s!==536870912&&(r.suspendedLanes=0,r.pingedLanes=0),r=r.eventTimes,s=31-Ht(s),r[s]=c}function Bg(r,s){var c=r.pendingLanes&~s;r.pendingLanes=s,r.suspendedLanes=0,r.pingedLanes=0,r.expiredLanes&=s,r.mutableReadLanes&=s,r.entangledLanes&=s,s=r.entanglements;var h=r.eventTimes;for(r=r.expirationTimes;0<c;){var g=31-Ht(c),E=1<<g;s[g]=0,h[g]=-1,r[g]=-1,c&=~E}}function Lo(r,s){var c=r.entangledLanes|=s;for(r=r.entanglements;c;){var h=31-Ht(c),g=1<<h;g&s|r[h]&s&&(r[h]|=s),c&=~g}}var Oe=0;function ef(r){return r&=-r,1<r?4<r?r&268435455?16:536870912:4:1}var tf,Ao,nf,rf,sf,Ro=!1,ys=[],_n=null,Pn=null,bn=null,di=new Map,hi=new Map,On=[],$g="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function af(r,s){switch(r){case"focusin":case"focusout":_n=null;break;case"dragenter":case"dragleave":Pn=null;break;case"mouseover":case"mouseout":bn=null;break;case"pointerover":case"pointerout":di.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":hi.delete(s.pointerId)}}function pi(r,s,c,h,g,E){return r===null||r.nativeEvent!==E?(r={blockedOn:s,domEventName:c,eventSystemFlags:h,nativeEvent:E,targetContainers:[g]},s!==null&&(s=Ii(s),s!==null&&Ao(s)),r):(r.eventSystemFlags|=h,s=r.targetContainers,g!==null&&s.indexOf(g)===-1&&s.push(g),r)}function Gg(r,s,c,h,g){switch(s){case"focusin":return _n=pi(_n,r,s,c,h,g),!0;case"dragenter":return Pn=pi(Pn,r,s,c,h,g),!0;case"mouseover":return bn=pi(bn,r,s,c,h,g),!0;case"pointerover":var E=g.pointerId;return di.set(E,pi(di.get(E)||null,r,s,c,h,g)),!0;case"gotpointercapture":return E=g.pointerId,hi.set(E,pi(hi.get(E)||null,r,s,c,h,g)),!0}return!1}function of(r){var s=er(r.target);if(s!==null){var c=Zn(s);if(c!==null){if(s=c.tag,s===13){if(s=jc(c),s!==null){r.blockedOn=s,sf(r.priority,function(){nf(c)});return}}else if(s===3&&c.stateNode.current.memoizedState.isDehydrated){r.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Es(r){if(r.blockedOn!==null)return!1;for(var s=r.targetContainers;0<s.length;){var c=Co(r.domEventName,r.eventSystemFlags,s[0],r.nativeEvent);if(c===null){c=r.nativeEvent;var h=new c.constructor(c.type,c);po=h,c.target.dispatchEvent(h),po=null}else return s=Ii(c),s!==null&&Ao(s),r.blockedOn=c,!1;s.shift()}return!0}function lf(r,s,c){Es(r)&&c.delete(s)}function Hg(){Ro=!1,_n!==null&&Es(_n)&&(_n=null),Pn!==null&&Es(Pn)&&(Pn=null),bn!==null&&Es(bn)&&(bn=null),di.forEach(lf),hi.forEach(lf)}function mi(r,s){r.blockedOn===s&&(r.blockedOn=null,Ro||(Ro=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Hg)))}function gi(r){function s(g){return mi(g,r)}if(0<ys.length){mi(ys[0],r);for(var c=1;c<ys.length;c++){var h=ys[c];h.blockedOn===r&&(h.blockedOn=null)}}for(_n!==null&&mi(_n,r),Pn!==null&&mi(Pn,r),bn!==null&&mi(bn,r),di.forEach(s),hi.forEach(s),c=0;c<On.length;c++)h=On[c],h.blockedOn===r&&(h.blockedOn=null);for(;0<On.length&&(c=On[0],c.blockedOn===null);)of(c),c.blockedOn===null&&On.shift()}var Lr=b.ReactCurrentBatchConfig,vs=!0;function Vg(r,s,c,h){var g=Oe,E=Lr.transition;Lr.transition=null;try{Oe=1,wo(r,s,c,h)}finally{Oe=g,Lr.transition=E}}function Kg(r,s,c,h){var g=Oe,E=Lr.transition;Lr.transition=null;try{Oe=4,wo(r,s,c,h)}finally{Oe=g,Lr.transition=E}}function wo(r,s,c,h){if(vs){var g=Co(r,s,c,h);if(g===null)Ko(r,s,h,Ts,c),af(r,h);else if(Gg(g,r,s,c,h))h.stopPropagation();else if(af(r,h),s&4&&-1<$g.indexOf(r)){for(;g!==null;){var E=Ii(g);if(E!==null&&tf(E),E=Co(r,s,c,h),E===null&&Ko(r,s,h,Ts,c),E===g)break;g=E}g!==null&&h.stopPropagation()}else Ko(r,s,h,null,c)}}var Ts=null;function Co(r,s,c,h){if(Ts=null,r=mo(h),r=er(r),r!==null)if(s=Zn(r),s===null)r=null;else if(c=s.tag,c===13){if(r=jc(s),r!==null)return r;r=null}else if(c===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;r=null}else s!==r&&(r=null);return Ts=r,null}function uf(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(_g()){case To:return 1;case Qc:return 4;case ds:case Pg:return 16;case Jc:return 536870912;default:return 16}default:return 16}}var Fn=null,Io=null,xs=null;function cf(){if(xs)return xs;var r,s=Io,c=s.length,h,g="value"in Fn?Fn.value:Fn.textContent,E=g.length;for(r=0;r<c&&s[r]===g[r];r++);var A=c-r;for(h=1;h<=A&&s[c-h]===g[E-h];h++);return xs=g.slice(r,1<h?1-h:void 0)}function Ss(r){var s=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&s===13&&(r=13)):r=s,r===10&&(r=13),32<=r||r===13?r:0}function Ls(){return!0}function ff(){return!1}function kt(r){function s(c,h,g,E,A){this._reactName=c,this._targetInst=g,this.type=h,this.nativeEvent=E,this.target=A,this.currentTarget=null;for(var C in r)r.hasOwnProperty(C)&&(c=r[C],this[C]=c?c(E):E[C]);return this.isDefaultPrevented=(E.defaultPrevented!=null?E.defaultPrevented:E.returnValue===!1)?Ls:ff,this.isPropagationStopped=ff,this}return H(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Ls)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Ls)},persist:function(){},isPersistent:Ls}),s}var Ar={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ko=kt(Ar),yi=H({},Ar,{view:0,detail:0}),jg=kt(yi),Do,_o,Ei,As=H({},yi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:bo,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Ei&&(Ei&&r.type==="mousemove"?(Do=r.screenX-Ei.screenX,_o=r.screenY-Ei.screenY):_o=Do=0,Ei=r),Do)},movementY:function(r){return"movementY"in r?r.movementY:_o}}),df=kt(As),zg=H({},As,{dataTransfer:0}),Wg=kt(zg),Yg=H({},yi,{relatedTarget:0}),Po=kt(Yg),qg=H({},Ar,{animationName:0,elapsedTime:0,pseudoElement:0}),Xg=kt(qg),Qg=H({},Ar,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Jg=kt(Qg),Zg=H({},Ar,{data:0}),hf=kt(Zg),e0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},t0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},n0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function r0(r){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(r):(r=n0[r])?!!s[r]:!1}function bo(){return r0}var i0=H({},yi,{key:function(r){if(r.key){var s=e0[r.key]||r.key;if(s!=="Unidentified")return s}return r.type==="keypress"?(r=Ss(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?t0[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:bo,charCode:function(r){return r.type==="keypress"?Ss(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Ss(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),s0=kt(i0),a0=H({},As,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),pf=kt(a0),o0=H({},yi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:bo}),l0=kt(o0),u0=H({},Ar,{propertyName:0,elapsedTime:0,pseudoElement:0}),c0=kt(u0),f0=H({},As,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),d0=kt(f0),h0=[9,13,27,32],Oo=u&&"CompositionEvent"in window,vi=null;u&&"documentMode"in document&&(vi=document.documentMode);var p0=u&&"TextEvent"in window&&!vi,mf=u&&(!Oo||vi&&8<vi&&11>=vi),gf=" ",yf=!1;function Ef(r,s){switch(r){case"keyup":return h0.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function vf(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Rr=!1;function m0(r,s){switch(r){case"compositionend":return vf(s);case"keypress":return s.which!==32?null:(yf=!0,gf);case"textInput":return r=s.data,r===gf&&yf?null:r;default:return null}}function g0(r,s){if(Rr)return r==="compositionend"||!Oo&&Ef(r,s)?(r=cf(),xs=Io=Fn=null,Rr=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return mf&&s.locale!=="ko"?null:s.data;default:return null}}var y0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Tf(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s==="input"?!!y0[r.type]:s==="textarea"}function xf(r,s,c,h){$c(h),s=ks(s,"onChange"),0<s.length&&(c=new ko("onChange","change",null,c,h),r.push({event:c,listeners:s}))}var Ti=null,xi=null;function E0(r){Bf(r,0)}function Rs(r){var s=Dr(r);if(Ic(s))return r}function v0(r,s){if(r==="change")return s}var Sf=!1;if(u){var Fo;if(u){var No="oninput"in document;if(!No){var Lf=document.createElement("div");Lf.setAttribute("oninput","return;"),No=typeof Lf.oninput=="function"}Fo=No}else Fo=!1;Sf=Fo&&(!document.documentMode||9<document.documentMode)}function Af(){Ti&&(Ti.detachEvent("onpropertychange",Rf),xi=Ti=null)}function Rf(r){if(r.propertyName==="value"&&Rs(xi)){var s=[];xf(s,xi,r,mo(r)),Kc(E0,s)}}function T0(r,s,c){r==="focusin"?(Af(),Ti=s,xi=c,Ti.attachEvent("onpropertychange",Rf)):r==="focusout"&&Af()}function x0(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Rs(xi)}function S0(r,s){if(r==="click")return Rs(s)}function L0(r,s){if(r==="input"||r==="change")return Rs(s)}function A0(r,s){return r===s&&(r!==0||1/r===1/s)||r!==r&&s!==s}var Vt=typeof Object.is=="function"?Object.is:A0;function Si(r,s){if(Vt(r,s))return!0;if(typeof r!="object"||r===null||typeof s!="object"||s===null)return!1;var c=Object.keys(r),h=Object.keys(s);if(c.length!==h.length)return!1;for(h=0;h<c.length;h++){var g=c[h];if(!f.call(s,g)||!Vt(r[g],s[g]))return!1}return!0}function wf(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function Cf(r,s){var c=wf(r);r=0;for(var h;c;){if(c.nodeType===3){if(h=r+c.textContent.length,r<=s&&h>=s)return{node:c,offset:s-r};r=h}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=wf(c)}}function If(r,s){return r&&s?r===s?!0:r&&r.nodeType===3?!1:s&&s.nodeType===3?If(r,s.parentNode):"contains"in r?r.contains(s):r.compareDocumentPosition?!!(r.compareDocumentPosition(s)&16):!1:!1}function kf(){for(var r=window,s=ls();s instanceof r.HTMLIFrameElement;){try{var c=typeof s.contentWindow.location.href=="string"}catch{c=!1}if(c)r=s.contentWindow;else break;s=ls(r.document)}return s}function Mo(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s&&(s==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||s==="textarea"||r.contentEditable==="true")}function R0(r){var s=kf(),c=r.focusedElem,h=r.selectionRange;if(s!==c&&c&&c.ownerDocument&&If(c.ownerDocument.documentElement,c)){if(h!==null&&Mo(c)){if(s=h.start,r=h.end,r===void 0&&(r=s),"selectionStart"in c)c.selectionStart=s,c.selectionEnd=Math.min(r,c.value.length);else if(r=(s=c.ownerDocument||document)&&s.defaultView||window,r.getSelection){r=r.getSelection();var g=c.textContent.length,E=Math.min(h.start,g);h=h.end===void 0?E:Math.min(h.end,g),!r.extend&&E>h&&(g=h,h=E,E=g),g=Cf(c,E);var A=Cf(c,h);g&&A&&(r.rangeCount!==1||r.anchorNode!==g.node||r.anchorOffset!==g.offset||r.focusNode!==A.node||r.focusOffset!==A.offset)&&(s=s.createRange(),s.setStart(g.node,g.offset),r.removeAllRanges(),E>h?(r.addRange(s),r.extend(A.node,A.offset)):(s.setEnd(A.node,A.offset),r.addRange(s)))}}for(s=[],r=c;r=r.parentNode;)r.nodeType===1&&s.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof c.focus=="function"&&c.focus(),c=0;c<s.length;c++)r=s[c],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var w0=u&&"documentMode"in document&&11>=document.documentMode,wr=null,Uo=null,Li=null,Bo=!1;function Df(r,s,c){var h=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Bo||wr==null||wr!==ls(h)||(h=wr,"selectionStart"in h&&Mo(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Li&&Si(Li,h)||(Li=h,h=ks(Uo,"onSelect"),0<h.length&&(s=new ko("onSelect","select",null,s,c),r.push({event:s,listeners:h}),s.target=wr)))}function ws(r,s){var c={};return c[r.toLowerCase()]=s.toLowerCase(),c["Webkit"+r]="webkit"+s,c["Moz"+r]="moz"+s,c}var Cr={animationend:ws("Animation","AnimationEnd"),animationiteration:ws("Animation","AnimationIteration"),animationstart:ws("Animation","AnimationStart"),transitionend:ws("Transition","TransitionEnd")},$o={},_f={};u&&(_f=document.createElement("div").style,"AnimationEvent"in window||(delete Cr.animationend.animation,delete Cr.animationiteration.animation,delete Cr.animationstart.animation),"TransitionEvent"in window||delete Cr.transitionend.transition);function Cs(r){if($o[r])return $o[r];if(!Cr[r])return r;var s=Cr[r],c;for(c in s)if(s.hasOwnProperty(c)&&c in _f)return $o[r]=s[c];return r}var Pf=Cs("animationend"),bf=Cs("animationiteration"),Of=Cs("animationstart"),Ff=Cs("transitionend"),Nf=new Map,Mf="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Nn(r,s){Nf.set(r,s),a(s,[r])}for(var Go=0;Go<Mf.length;Go++){var Ho=Mf[Go],C0=Ho.toLowerCase(),I0=Ho[0].toUpperCase()+Ho.slice(1);Nn(C0,"on"+I0)}Nn(Pf,"onAnimationEnd"),Nn(bf,"onAnimationIteration"),Nn(Of,"onAnimationStart"),Nn("dblclick","onDoubleClick"),Nn("focusin","onFocus"),Nn("focusout","onBlur"),Nn(Ff,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ai="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),k0=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ai));function Uf(r,s,c){var h=r.type||"unknown-event";r.currentTarget=c,Cg(h,s,void 0,r),r.currentTarget=null}function Bf(r,s){s=(s&4)!==0;for(var c=0;c<r.length;c++){var h=r[c],g=h.event;h=h.listeners;e:{var E=void 0;if(s)for(var A=h.length-1;0<=A;A--){var C=h[A],k=C.instance,B=C.currentTarget;if(C=C.listener,k!==E&&g.isPropagationStopped())break e;Uf(g,C,B),E=k}else for(A=0;A<h.length;A++){if(C=h[A],k=C.instance,B=C.currentTarget,C=C.listener,k!==E&&g.isPropagationStopped())break e;Uf(g,C,B),E=k}}}if(fs)throw r=vo,fs=!1,vo=null,r}function Be(r,s){var c=s[Xo];c===void 0&&(c=s[Xo]=new Set);var h=r+"__bubble";c.has(h)||($f(s,r,2,!1),c.add(h))}function Vo(r,s,c){var h=0;s&&(h|=4),$f(c,r,h,s)}var Is="_reactListening"+Math.random().toString(36).slice(2);function Ri(r){if(!r[Is]){r[Is]=!0,n.forEach(function(c){c!=="selectionchange"&&(k0.has(c)||Vo(c,!1,r),Vo(c,!0,r))});var s=r.nodeType===9?r:r.ownerDocument;s===null||s[Is]||(s[Is]=!0,Vo("selectionchange",!1,s))}}function $f(r,s,c,h){switch(uf(s)){case 1:var g=Vg;break;case 4:g=Kg;break;default:g=wo}c=g.bind(null,s,c,r),g=void 0,!Eo||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(g=!0),h?g!==void 0?r.addEventListener(s,c,{capture:!0,passive:g}):r.addEventListener(s,c,!0):g!==void 0?r.addEventListener(s,c,{passive:g}):r.addEventListener(s,c,!1)}function Ko(r,s,c,h,g){var E=h;if(!(s&1)&&!(s&2)&&h!==null)e:for(;;){if(h===null)return;var A=h.tag;if(A===3||A===4){var C=h.stateNode.containerInfo;if(C===g||C.nodeType===8&&C.parentNode===g)break;if(A===4)for(A=h.return;A!==null;){var k=A.tag;if((k===3||k===4)&&(k=A.stateNode.containerInfo,k===g||k.nodeType===8&&k.parentNode===g))return;A=A.return}for(;C!==null;){if(A=er(C),A===null)return;if(k=A.tag,k===5||k===6){h=E=A;continue e}C=C.parentNode}}h=h.return}Kc(function(){var B=E,Z=mo(c),te=[];e:{var q=Nf.get(r);if(q!==void 0){var ie=ko,ue=r;switch(r){case"keypress":if(Ss(c)===0)break e;case"keydown":case"keyup":ie=s0;break;case"focusin":ue="focus",ie=Po;break;case"focusout":ue="blur",ie=Po;break;case"beforeblur":case"afterblur":ie=Po;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ie=df;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ie=Wg;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ie=l0;break;case Pf:case bf:case Of:ie=Xg;break;case Ff:ie=c0;break;case"scroll":ie=jg;break;case"wheel":ie=d0;break;case"copy":case"cut":case"paste":ie=Jg;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ie=pf}var ce=(s&4)!==0,Qe=!ce&&r==="scroll",F=ce?q!==null?q+"Capture":null:q;ce=[];for(var P=B,M;P!==null;){M=P;var ne=M.stateNode;if(M.tag===5&&ne!==null&&(M=ne,F!==null&&(ne=oi(P,F),ne!=null&&ce.push(wi(P,ne,M)))),Qe)break;P=P.return}0<ce.length&&(q=new ie(q,ue,null,c,Z),te.push({event:q,listeners:ce}))}}if(!(s&7)){e:{if(q=r==="mouseover"||r==="pointerover",ie=r==="mouseout"||r==="pointerout",q&&c!==po&&(ue=c.relatedTarget||c.fromElement)&&(er(ue)||ue[mn]))break e;if((ie||q)&&(q=Z.window===Z?Z:(q=Z.ownerDocument)?q.defaultView||q.parentWindow:window,ie?(ue=c.relatedTarget||c.toElement,ie=B,ue=ue?er(ue):null,ue!==null&&(Qe=Zn(ue),ue!==Qe||ue.tag!==5&&ue.tag!==6)&&(ue=null)):(ie=null,ue=B),ie!==ue)){if(ce=df,ne="onMouseLeave",F="onMouseEnter",P="mouse",(r==="pointerout"||r==="pointerover")&&(ce=pf,ne="onPointerLeave",F="onPointerEnter",P="pointer"),Qe=ie==null?q:Dr(ie),M=ue==null?q:Dr(ue),q=new ce(ne,P+"leave",ie,c,Z),q.target=Qe,q.relatedTarget=M,ne=null,er(Z)===B&&(ce=new ce(F,P+"enter",ue,c,Z),ce.target=M,ce.relatedTarget=Qe,ne=ce),Qe=ne,ie&&ue)t:{for(ce=ie,F=ue,P=0,M=ce;M;M=Ir(M))P++;for(M=0,ne=F;ne;ne=Ir(ne))M++;for(;0<P-M;)ce=Ir(ce),P--;for(;0<M-P;)F=Ir(F),M--;for(;P--;){if(ce===F||F!==null&&ce===F.alternate)break t;ce=Ir(ce),F=Ir(F)}ce=null}else ce=null;ie!==null&&Gf(te,q,ie,ce,!1),ue!==null&&Qe!==null&&Gf(te,Qe,ue,ce,!0)}}e:{if(q=B?Dr(B):window,ie=q.nodeName&&q.nodeName.toLowerCase(),ie==="select"||ie==="input"&&q.type==="file")var fe=v0;else if(Tf(q))if(Sf)fe=L0;else{fe=x0;var ye=T0}else(ie=q.nodeName)&&ie.toLowerCase()==="input"&&(q.type==="checkbox"||q.type==="radio")&&(fe=S0);if(fe&&(fe=fe(r,B))){xf(te,fe,c,Z);break e}ye&&ye(r,q,B),r==="focusout"&&(ye=q._wrapperState)&&ye.controlled&&q.type==="number"&&lo(q,"number",q.value)}switch(ye=B?Dr(B):window,r){case"focusin":(Tf(ye)||ye.contentEditable==="true")&&(wr=ye,Uo=B,Li=null);break;case"focusout":Li=Uo=wr=null;break;case"mousedown":Bo=!0;break;case"contextmenu":case"mouseup":case"dragend":Bo=!1,Df(te,c,Z);break;case"selectionchange":if(w0)break;case"keydown":case"keyup":Df(te,c,Z)}var Ee;if(Oo)e:{switch(r){case"compositionstart":var Ae="onCompositionStart";break e;case"compositionend":Ae="onCompositionEnd";break e;case"compositionupdate":Ae="onCompositionUpdate";break e}Ae=void 0}else Rr?Ef(r,c)&&(Ae="onCompositionEnd"):r==="keydown"&&c.keyCode===229&&(Ae="onCompositionStart");Ae&&(mf&&c.locale!=="ko"&&(Rr||Ae!=="onCompositionStart"?Ae==="onCompositionEnd"&&Rr&&(Ee=cf()):(Fn=Z,Io="value"in Fn?Fn.value:Fn.textContent,Rr=!0)),ye=ks(B,Ae),0<ye.length&&(Ae=new hf(Ae,r,null,c,Z),te.push({event:Ae,listeners:ye}),Ee?Ae.data=Ee:(Ee=vf(c),Ee!==null&&(Ae.data=Ee)))),(Ee=p0?m0(r,c):g0(r,c))&&(B=ks(B,"onBeforeInput"),0<B.length&&(Z=new hf("onBeforeInput","beforeinput",null,c,Z),te.push({event:Z,listeners:B}),Z.data=Ee))}Bf(te,s)})}function wi(r,s,c){return{instance:r,listener:s,currentTarget:c}}function ks(r,s){for(var c=s+"Capture",h=[];r!==null;){var g=r,E=g.stateNode;g.tag===5&&E!==null&&(g=E,E=oi(r,c),E!=null&&h.unshift(wi(r,E,g)),E=oi(r,s),E!=null&&h.push(wi(r,E,g))),r=r.return}return h}function Ir(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5);return r||null}function Gf(r,s,c,h,g){for(var E=s._reactName,A=[];c!==null&&c!==h;){var C=c,k=C.alternate,B=C.stateNode;if(k!==null&&k===h)break;C.tag===5&&B!==null&&(C=B,g?(k=oi(c,E),k!=null&&A.unshift(wi(c,k,C))):g||(k=oi(c,E),k!=null&&A.push(wi(c,k,C)))),c=c.return}A.length!==0&&r.push({event:s,listeners:A})}var D0=/\r\n?/g,_0=/\u0000|\uFFFD/g;function Hf(r){return(typeof r=="string"?r:""+r).replace(D0,`
`).replace(_0,"")}function Ds(r,s,c){if(s=Hf(s),Hf(r)!==s&&c)throw Error(t(425))}function _s(){}var jo=null,zo=null;function Wo(r,s){return r==="textarea"||r==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Yo=typeof setTimeout=="function"?setTimeout:void 0,P0=typeof clearTimeout=="function"?clearTimeout:void 0,Vf=typeof Promise=="function"?Promise:void 0,b0=typeof queueMicrotask=="function"?queueMicrotask:typeof Vf<"u"?function(r){return Vf.resolve(null).then(r).catch(O0)}:Yo;function O0(r){setTimeout(function(){throw r})}function qo(r,s){var c=s,h=0;do{var g=c.nextSibling;if(r.removeChild(c),g&&g.nodeType===8)if(c=g.data,c==="/$"){if(h===0){r.removeChild(g),gi(s);return}h--}else c!=="$"&&c!=="$?"&&c!=="$!"||h++;c=g}while(c);gi(s)}function Mn(r){for(;r!=null;r=r.nextSibling){var s=r.nodeType;if(s===1||s===3)break;if(s===8){if(s=r.data,s==="$"||s==="$!"||s==="$?")break;if(s==="/$")return null}}return r}function Kf(r){r=r.previousSibling;for(var s=0;r;){if(r.nodeType===8){var c=r.data;if(c==="$"||c==="$!"||c==="$?"){if(s===0)return r;s--}else c==="/$"&&s++}r=r.previousSibling}return null}var kr=Math.random().toString(36).slice(2),en="__reactFiber$"+kr,Ci="__reactProps$"+kr,mn="__reactContainer$"+kr,Xo="__reactEvents$"+kr,F0="__reactListeners$"+kr,N0="__reactHandles$"+kr;function er(r){var s=r[en];if(s)return s;for(var c=r.parentNode;c;){if(s=c[mn]||c[en]){if(c=s.alternate,s.child!==null||c!==null&&c.child!==null)for(r=Kf(r);r!==null;){if(c=r[en])return c;r=Kf(r)}return s}r=c,c=r.parentNode}return null}function Ii(r){return r=r[en]||r[mn],!r||r.tag!==5&&r.tag!==6&&r.tag!==13&&r.tag!==3?null:r}function Dr(r){if(r.tag===5||r.tag===6)return r.stateNode;throw Error(t(33))}function Ps(r){return r[Ci]||null}var Qo=[],_r=-1;function Un(r){return{current:r}}function $e(r){0>_r||(r.current=Qo[_r],Qo[_r]=null,_r--)}function Me(r,s){_r++,Qo[_r]=r.current,r.current=s}var Bn={},dt=Un(Bn),vt=Un(!1),tr=Bn;function Pr(r,s){var c=r.type.contextTypes;if(!c)return Bn;var h=r.stateNode;if(h&&h.__reactInternalMemoizedUnmaskedChildContext===s)return h.__reactInternalMemoizedMaskedChildContext;var g={},E;for(E in c)g[E]=s[E];return h&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=s,r.__reactInternalMemoizedMaskedChildContext=g),g}function Tt(r){return r=r.childContextTypes,r!=null}function bs(){$e(vt),$e(dt)}function jf(r,s,c){if(dt.current!==Bn)throw Error(t(168));Me(dt,s),Me(vt,c)}function zf(r,s,c){var h=r.stateNode;if(s=s.childContextTypes,typeof h.getChildContext!="function")return c;h=h.getChildContext();for(var g in h)if(!(g in s))throw Error(t(108,Ce(r)||"Unknown",g));return H({},c,h)}function Os(r){return r=(r=r.stateNode)&&r.__reactInternalMemoizedMergedChildContext||Bn,tr=dt.current,Me(dt,r),Me(vt,vt.current),!0}function Wf(r,s,c){var h=r.stateNode;if(!h)throw Error(t(169));c?(r=zf(r,s,tr),h.__reactInternalMemoizedMergedChildContext=r,$e(vt),$e(dt),Me(dt,r)):$e(vt),Me(vt,c)}var gn=null,Fs=!1,Jo=!1;function Yf(r){gn===null?gn=[r]:gn.push(r)}function M0(r){Fs=!0,Yf(r)}function $n(){if(!Jo&&gn!==null){Jo=!0;var r=0,s=Oe;try{var c=gn;for(Oe=1;r<c.length;r++){var h=c[r];do h=h(!0);while(h!==null)}gn=null,Fs=!1}catch(g){throw gn!==null&&(gn=gn.slice(r+1)),qc(To,$n),g}finally{Oe=s,Jo=!1}}return null}var br=[],Or=0,Ns=null,Ms=0,bt=[],Ot=0,nr=null,yn=1,En="";function rr(r,s){br[Or++]=Ms,br[Or++]=Ns,Ns=r,Ms=s}function qf(r,s,c){bt[Ot++]=yn,bt[Ot++]=En,bt[Ot++]=nr,nr=r;var h=yn;r=En;var g=32-Ht(h)-1;h&=~(1<<g),c+=1;var E=32-Ht(s)+g;if(30<E){var A=g-g%5;E=(h&(1<<A)-1).toString(32),h>>=A,g-=A,yn=1<<32-Ht(s)+g|c<<g|h,En=E+r}else yn=1<<E|c<<g|h,En=r}function Zo(r){r.return!==null&&(rr(r,1),qf(r,1,0))}function el(r){for(;r===Ns;)Ns=br[--Or],br[Or]=null,Ms=br[--Or],br[Or]=null;for(;r===nr;)nr=bt[--Ot],bt[Ot]=null,En=bt[--Ot],bt[Ot]=null,yn=bt[--Ot],bt[Ot]=null}var Dt=null,_t=null,He=!1,Kt=null;function Xf(r,s){var c=Ut(5,null,null,0);c.elementType="DELETED",c.stateNode=s,c.return=r,s=r.deletions,s===null?(r.deletions=[c],r.flags|=16):s.push(c)}function Qf(r,s){switch(r.tag){case 5:var c=r.type;return s=s.nodeType!==1||c.toLowerCase()!==s.nodeName.toLowerCase()?null:s,s!==null?(r.stateNode=s,Dt=r,_t=Mn(s.firstChild),!0):!1;case 6:return s=r.pendingProps===""||s.nodeType!==3?null:s,s!==null?(r.stateNode=s,Dt=r,_t=null,!0):!1;case 13:return s=s.nodeType!==8?null:s,s!==null?(c=nr!==null?{id:yn,overflow:En}:null,r.memoizedState={dehydrated:s,treeContext:c,retryLane:1073741824},c=Ut(18,null,null,0),c.stateNode=s,c.return=r,r.child=c,Dt=r,_t=null,!0):!1;default:return!1}}function tl(r){return(r.mode&1)!==0&&(r.flags&128)===0}function nl(r){if(He){var s=_t;if(s){var c=s;if(!Qf(r,s)){if(tl(r))throw Error(t(418));s=Mn(c.nextSibling);var h=Dt;s&&Qf(r,s)?Xf(h,c):(r.flags=r.flags&-4097|2,He=!1,Dt=r)}}else{if(tl(r))throw Error(t(418));r.flags=r.flags&-4097|2,He=!1,Dt=r}}}function Jf(r){for(r=r.return;r!==null&&r.tag!==5&&r.tag!==3&&r.tag!==13;)r=r.return;Dt=r}function Us(r){if(r!==Dt)return!1;if(!He)return Jf(r),He=!0,!1;var s;if((s=r.tag!==3)&&!(s=r.tag!==5)&&(s=r.type,s=s!=="head"&&s!=="body"&&!Wo(r.type,r.memoizedProps)),s&&(s=_t)){if(tl(r))throw Zf(),Error(t(418));for(;s;)Xf(r,s),s=Mn(s.nextSibling)}if(Jf(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(t(317));e:{for(r=r.nextSibling,s=0;r;){if(r.nodeType===8){var c=r.data;if(c==="/$"){if(s===0){_t=Mn(r.nextSibling);break e}s--}else c!=="$"&&c!=="$!"&&c!=="$?"||s++}r=r.nextSibling}_t=null}}else _t=Dt?Mn(r.stateNode.nextSibling):null;return!0}function Zf(){for(var r=_t;r;)r=Mn(r.nextSibling)}function Fr(){_t=Dt=null,He=!1}function rl(r){Kt===null?Kt=[r]:Kt.push(r)}var U0=b.ReactCurrentBatchConfig;function ki(r,s,c){if(r=c.ref,r!==null&&typeof r!="function"&&typeof r!="object"){if(c._owner){if(c=c._owner,c){if(c.tag!==1)throw Error(t(309));var h=c.stateNode}if(!h)throw Error(t(147,r));var g=h,E=""+r;return s!==null&&s.ref!==null&&typeof s.ref=="function"&&s.ref._stringRef===E?s.ref:(s=function(A){var C=g.refs;A===null?delete C[E]:C[E]=A},s._stringRef=E,s)}if(typeof r!="string")throw Error(t(284));if(!c._owner)throw Error(t(290,r))}return r}function Bs(r,s){throw r=Object.prototype.toString.call(s),Error(t(31,r==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":r))}function ed(r){var s=r._init;return s(r._payload)}function td(r){function s(F,P){if(r){var M=F.deletions;M===null?(F.deletions=[P],F.flags|=16):M.push(P)}}function c(F,P){if(!r)return null;for(;P!==null;)s(F,P),P=P.sibling;return null}function h(F,P){for(F=new Map;P!==null;)P.key!==null?F.set(P.key,P):F.set(P.index,P),P=P.sibling;return F}function g(F,P){return F=Yn(F,P),F.index=0,F.sibling=null,F}function E(F,P,M){return F.index=M,r?(M=F.alternate,M!==null?(M=M.index,M<P?(F.flags|=2,P):M):(F.flags|=2,P)):(F.flags|=1048576,P)}function A(F){return r&&F.alternate===null&&(F.flags|=2),F}function C(F,P,M,ne){return P===null||P.tag!==6?(P=Yl(M,F.mode,ne),P.return=F,P):(P=g(P,M),P.return=F,P)}function k(F,P,M,ne){var fe=M.type;return fe===U?Z(F,P,M.props.children,ne,M.key):P!==null&&(P.elementType===fe||typeof fe=="object"&&fe!==null&&fe.$$typeof===le&&ed(fe)===P.type)?(ne=g(P,M.props),ne.ref=ki(F,P,M),ne.return=F,ne):(ne=ua(M.type,M.key,M.props,null,F.mode,ne),ne.ref=ki(F,P,M),ne.return=F,ne)}function B(F,P,M,ne){return P===null||P.tag!==4||P.stateNode.containerInfo!==M.containerInfo||P.stateNode.implementation!==M.implementation?(P=ql(M,F.mode,ne),P.return=F,P):(P=g(P,M.children||[]),P.return=F,P)}function Z(F,P,M,ne,fe){return P===null||P.tag!==7?(P=fr(M,F.mode,ne,fe),P.return=F,P):(P=g(P,M),P.return=F,P)}function te(F,P,M){if(typeof P=="string"&&P!==""||typeof P=="number")return P=Yl(""+P,F.mode,M),P.return=F,P;if(typeof P=="object"&&P!==null){switch(P.$$typeof){case _:return M=ua(P.type,P.key,P.props,null,F.mode,M),M.ref=ki(F,null,P),M.return=F,M;case K:return P=ql(P,F.mode,M),P.return=F,P;case le:var ne=P._init;return te(F,ne(P._payload),M)}if(ii(P)||W(P))return P=fr(P,F.mode,M,null),P.return=F,P;Bs(F,P)}return null}function q(F,P,M,ne){var fe=P!==null?P.key:null;if(typeof M=="string"&&M!==""||typeof M=="number")return fe!==null?null:C(F,P,""+M,ne);if(typeof M=="object"&&M!==null){switch(M.$$typeof){case _:return M.key===fe?k(F,P,M,ne):null;case K:return M.key===fe?B(F,P,M,ne):null;case le:return fe=M._init,q(F,P,fe(M._payload),ne)}if(ii(M)||W(M))return fe!==null?null:Z(F,P,M,ne,null);Bs(F,M)}return null}function ie(F,P,M,ne,fe){if(typeof ne=="string"&&ne!==""||typeof ne=="number")return F=F.get(M)||null,C(P,F,""+ne,fe);if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case _:return F=F.get(ne.key===null?M:ne.key)||null,k(P,F,ne,fe);case K:return F=F.get(ne.key===null?M:ne.key)||null,B(P,F,ne,fe);case le:var ye=ne._init;return ie(F,P,M,ye(ne._payload),fe)}if(ii(ne)||W(ne))return F=F.get(M)||null,Z(P,F,ne,fe,null);Bs(P,ne)}return null}function ue(F,P,M,ne){for(var fe=null,ye=null,Ee=P,Ae=P=0,st=null;Ee!==null&&Ae<M.length;Ae++){Ee.index>Ae?(st=Ee,Ee=null):st=Ee.sibling;var Pe=q(F,Ee,M[Ae],ne);if(Pe===null){Ee===null&&(Ee=st);break}r&&Ee&&Pe.alternate===null&&s(F,Ee),P=E(Pe,P,Ae),ye===null?fe=Pe:ye.sibling=Pe,ye=Pe,Ee=st}if(Ae===M.length)return c(F,Ee),He&&rr(F,Ae),fe;if(Ee===null){for(;Ae<M.length;Ae++)Ee=te(F,M[Ae],ne),Ee!==null&&(P=E(Ee,P,Ae),ye===null?fe=Ee:ye.sibling=Ee,ye=Ee);return He&&rr(F,Ae),fe}for(Ee=h(F,Ee);Ae<M.length;Ae++)st=ie(Ee,F,Ae,M[Ae],ne),st!==null&&(r&&st.alternate!==null&&Ee.delete(st.key===null?Ae:st.key),P=E(st,P,Ae),ye===null?fe=st:ye.sibling=st,ye=st);return r&&Ee.forEach(function(qn){return s(F,qn)}),He&&rr(F,Ae),fe}function ce(F,P,M,ne){var fe=W(M);if(typeof fe!="function")throw Error(t(150));if(M=fe.call(M),M==null)throw Error(t(151));for(var ye=fe=null,Ee=P,Ae=P=0,st=null,Pe=M.next();Ee!==null&&!Pe.done;Ae++,Pe=M.next()){Ee.index>Ae?(st=Ee,Ee=null):st=Ee.sibling;var qn=q(F,Ee,Pe.value,ne);if(qn===null){Ee===null&&(Ee=st);break}r&&Ee&&qn.alternate===null&&s(F,Ee),P=E(qn,P,Ae),ye===null?fe=qn:ye.sibling=qn,ye=qn,Ee=st}if(Pe.done)return c(F,Ee),He&&rr(F,Ae),fe;if(Ee===null){for(;!Pe.done;Ae++,Pe=M.next())Pe=te(F,Pe.value,ne),Pe!==null&&(P=E(Pe,P,Ae),ye===null?fe=Pe:ye.sibling=Pe,ye=Pe);return He&&rr(F,Ae),fe}for(Ee=h(F,Ee);!Pe.done;Ae++,Pe=M.next())Pe=ie(Ee,F,Ae,Pe.value,ne),Pe!==null&&(r&&Pe.alternate!==null&&Ee.delete(Pe.key===null?Ae:Pe.key),P=E(Pe,P,Ae),ye===null?fe=Pe:ye.sibling=Pe,ye=Pe);return r&&Ee.forEach(function(gy){return s(F,gy)}),He&&rr(F,Ae),fe}function Qe(F,P,M,ne){if(typeof M=="object"&&M!==null&&M.type===U&&M.key===null&&(M=M.props.children),typeof M=="object"&&M!==null){switch(M.$$typeof){case _:e:{for(var fe=M.key,ye=P;ye!==null;){if(ye.key===fe){if(fe=M.type,fe===U){if(ye.tag===7){c(F,ye.sibling),P=g(ye,M.props.children),P.return=F,F=P;break e}}else if(ye.elementType===fe||typeof fe=="object"&&fe!==null&&fe.$$typeof===le&&ed(fe)===ye.type){c(F,ye.sibling),P=g(ye,M.props),P.ref=ki(F,ye,M),P.return=F,F=P;break e}c(F,ye);break}else s(F,ye);ye=ye.sibling}M.type===U?(P=fr(M.props.children,F.mode,ne,M.key),P.return=F,F=P):(ne=ua(M.type,M.key,M.props,null,F.mode,ne),ne.ref=ki(F,P,M),ne.return=F,F=ne)}return A(F);case K:e:{for(ye=M.key;P!==null;){if(P.key===ye)if(P.tag===4&&P.stateNode.containerInfo===M.containerInfo&&P.stateNode.implementation===M.implementation){c(F,P.sibling),P=g(P,M.children||[]),P.return=F,F=P;break e}else{c(F,P);break}else s(F,P);P=P.sibling}P=ql(M,F.mode,ne),P.return=F,F=P}return A(F);case le:return ye=M._init,Qe(F,P,ye(M._payload),ne)}if(ii(M))return ue(F,P,M,ne);if(W(M))return ce(F,P,M,ne);Bs(F,M)}return typeof M=="string"&&M!==""||typeof M=="number"?(M=""+M,P!==null&&P.tag===6?(c(F,P.sibling),P=g(P,M),P.return=F,F=P):(c(F,P),P=Yl(M,F.mode,ne),P.return=F,F=P),A(F)):c(F,P)}return Qe}var Nr=td(!0),nd=td(!1),$s=Un(null),Gs=null,Mr=null,il=null;function sl(){il=Mr=Gs=null}function al(r){var s=$s.current;$e($s),r._currentValue=s}function ol(r,s,c){for(;r!==null;){var h=r.alternate;if((r.childLanes&s)!==s?(r.childLanes|=s,h!==null&&(h.childLanes|=s)):h!==null&&(h.childLanes&s)!==s&&(h.childLanes|=s),r===c)break;r=r.return}}function Ur(r,s){Gs=r,il=Mr=null,r=r.dependencies,r!==null&&r.firstContext!==null&&(r.lanes&s&&(xt=!0),r.firstContext=null)}function Ft(r){var s=r._currentValue;if(il!==r)if(r={context:r,memoizedValue:s,next:null},Mr===null){if(Gs===null)throw Error(t(308));Mr=r,Gs.dependencies={lanes:0,firstContext:r}}else Mr=Mr.next=r;return s}var ir=null;function ll(r){ir===null?ir=[r]:ir.push(r)}function rd(r,s,c,h){var g=s.interleaved;return g===null?(c.next=c,ll(s)):(c.next=g.next,g.next=c),s.interleaved=c,vn(r,h)}function vn(r,s){r.lanes|=s;var c=r.alternate;for(c!==null&&(c.lanes|=s),c=r,r=r.return;r!==null;)r.childLanes|=s,c=r.alternate,c!==null&&(c.childLanes|=s),c=r,r=r.return;return c.tag===3?c.stateNode:null}var Gn=!1;function ul(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function id(r,s){r=r.updateQueue,s.updateQueue===r&&(s.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,effects:r.effects})}function Tn(r,s){return{eventTime:r,lane:s,tag:0,payload:null,callback:null,next:null}}function Hn(r,s,c){var h=r.updateQueue;if(h===null)return null;if(h=h.shared,_e&2){var g=h.pending;return g===null?s.next=s:(s.next=g.next,g.next=s),h.pending=s,vn(r,c)}return g=h.interleaved,g===null?(s.next=s,ll(h)):(s.next=g.next,g.next=s),h.interleaved=s,vn(r,c)}function Hs(r,s,c){if(s=s.updateQueue,s!==null&&(s=s.shared,(c&4194240)!==0)){var h=s.lanes;h&=r.pendingLanes,c|=h,s.lanes=c,Lo(r,c)}}function sd(r,s){var c=r.updateQueue,h=r.alternate;if(h!==null&&(h=h.updateQueue,c===h)){var g=null,E=null;if(c=c.firstBaseUpdate,c!==null){do{var A={eventTime:c.eventTime,lane:c.lane,tag:c.tag,payload:c.payload,callback:c.callback,next:null};E===null?g=E=A:E=E.next=A,c=c.next}while(c!==null);E===null?g=E=s:E=E.next=s}else g=E=s;c={baseState:h.baseState,firstBaseUpdate:g,lastBaseUpdate:E,shared:h.shared,effects:h.effects},r.updateQueue=c;return}r=c.lastBaseUpdate,r===null?c.firstBaseUpdate=s:r.next=s,c.lastBaseUpdate=s}function Vs(r,s,c,h){var g=r.updateQueue;Gn=!1;var E=g.firstBaseUpdate,A=g.lastBaseUpdate,C=g.shared.pending;if(C!==null){g.shared.pending=null;var k=C,B=k.next;k.next=null,A===null?E=B:A.next=B,A=k;var Z=r.alternate;Z!==null&&(Z=Z.updateQueue,C=Z.lastBaseUpdate,C!==A&&(C===null?Z.firstBaseUpdate=B:C.next=B,Z.lastBaseUpdate=k))}if(E!==null){var te=g.baseState;A=0,Z=B=k=null,C=E;do{var q=C.lane,ie=C.eventTime;if((h&q)===q){Z!==null&&(Z=Z.next={eventTime:ie,lane:0,tag:C.tag,payload:C.payload,callback:C.callback,next:null});e:{var ue=r,ce=C;switch(q=s,ie=c,ce.tag){case 1:if(ue=ce.payload,typeof ue=="function"){te=ue.call(ie,te,q);break e}te=ue;break e;case 3:ue.flags=ue.flags&-65537|128;case 0:if(ue=ce.payload,q=typeof ue=="function"?ue.call(ie,te,q):ue,q==null)break e;te=H({},te,q);break e;case 2:Gn=!0}}C.callback!==null&&C.lane!==0&&(r.flags|=64,q=g.effects,q===null?g.effects=[C]:q.push(C))}else ie={eventTime:ie,lane:q,tag:C.tag,payload:C.payload,callback:C.callback,next:null},Z===null?(B=Z=ie,k=te):Z=Z.next=ie,A|=q;if(C=C.next,C===null){if(C=g.shared.pending,C===null)break;q=C,C=q.next,q.next=null,g.lastBaseUpdate=q,g.shared.pending=null}}while(!0);if(Z===null&&(k=te),g.baseState=k,g.firstBaseUpdate=B,g.lastBaseUpdate=Z,s=g.shared.interleaved,s!==null){g=s;do A|=g.lane,g=g.next;while(g!==s)}else E===null&&(g.shared.lanes=0);or|=A,r.lanes=A,r.memoizedState=te}}function ad(r,s,c){if(r=s.effects,s.effects=null,r!==null)for(s=0;s<r.length;s++){var h=r[s],g=h.callback;if(g!==null){if(h.callback=null,h=c,typeof g!="function")throw Error(t(191,g));g.call(h)}}}var Di={},tn=Un(Di),_i=Un(Di),Pi=Un(Di);function sr(r){if(r===Di)throw Error(t(174));return r}function cl(r,s){switch(Me(Pi,s),Me(_i,r),Me(tn,Di),r=s.nodeType,r){case 9:case 11:s=(s=s.documentElement)?s.namespaceURI:co(null,"");break;default:r=r===8?s.parentNode:s,s=r.namespaceURI||null,r=r.tagName,s=co(s,r)}$e(tn),Me(tn,s)}function Br(){$e(tn),$e(_i),$e(Pi)}function od(r){sr(Pi.current);var s=sr(tn.current),c=co(s,r.type);s!==c&&(Me(_i,r),Me(tn,c))}function fl(r){_i.current===r&&($e(tn),$e(_i))}var je=Un(0);function Ks(r){for(var s=r;s!==null;){if(s.tag===13){var c=s.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||c.data==="$!"))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if(s.flags&128)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var dl=[];function hl(){for(var r=0;r<dl.length;r++)dl[r]._workInProgressVersionPrimary=null;dl.length=0}var js=b.ReactCurrentDispatcher,pl=b.ReactCurrentBatchConfig,ar=0,ze=null,et=null,rt=null,zs=!1,bi=!1,Oi=0,B0=0;function ht(){throw Error(t(321))}function ml(r,s){if(s===null)return!1;for(var c=0;c<s.length&&c<r.length;c++)if(!Vt(r[c],s[c]))return!1;return!0}function gl(r,s,c,h,g,E){if(ar=E,ze=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,js.current=r===null||r.memoizedState===null?V0:K0,r=c(h,g),bi){E=0;do{if(bi=!1,Oi=0,25<=E)throw Error(t(301));E+=1,rt=et=null,s.updateQueue=null,js.current=j0,r=c(h,g)}while(bi)}if(js.current=qs,s=et!==null&&et.next!==null,ar=0,rt=et=ze=null,zs=!1,s)throw Error(t(300));return r}function yl(){var r=Oi!==0;return Oi=0,r}function nn(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return rt===null?ze.memoizedState=rt=r:rt=rt.next=r,rt}function Nt(){if(et===null){var r=ze.alternate;r=r!==null?r.memoizedState:null}else r=et.next;var s=rt===null?ze.memoizedState:rt.next;if(s!==null)rt=s,et=r;else{if(r===null)throw Error(t(310));et=r,r={memoizedState:et.memoizedState,baseState:et.baseState,baseQueue:et.baseQueue,queue:et.queue,next:null},rt===null?ze.memoizedState=rt=r:rt=rt.next=r}return rt}function Fi(r,s){return typeof s=="function"?s(r):s}function El(r){var s=Nt(),c=s.queue;if(c===null)throw Error(t(311));c.lastRenderedReducer=r;var h=et,g=h.baseQueue,E=c.pending;if(E!==null){if(g!==null){var A=g.next;g.next=E.next,E.next=A}h.baseQueue=g=E,c.pending=null}if(g!==null){E=g.next,h=h.baseState;var C=A=null,k=null,B=E;do{var Z=B.lane;if((ar&Z)===Z)k!==null&&(k=k.next={lane:0,action:B.action,hasEagerState:B.hasEagerState,eagerState:B.eagerState,next:null}),h=B.hasEagerState?B.eagerState:r(h,B.action);else{var te={lane:Z,action:B.action,hasEagerState:B.hasEagerState,eagerState:B.eagerState,next:null};k===null?(C=k=te,A=h):k=k.next=te,ze.lanes|=Z,or|=Z}B=B.next}while(B!==null&&B!==E);k===null?A=h:k.next=C,Vt(h,s.memoizedState)||(xt=!0),s.memoizedState=h,s.baseState=A,s.baseQueue=k,c.lastRenderedState=h}if(r=c.interleaved,r!==null){g=r;do E=g.lane,ze.lanes|=E,or|=E,g=g.next;while(g!==r)}else g===null&&(c.lanes=0);return[s.memoizedState,c.dispatch]}function vl(r){var s=Nt(),c=s.queue;if(c===null)throw Error(t(311));c.lastRenderedReducer=r;var h=c.dispatch,g=c.pending,E=s.memoizedState;if(g!==null){c.pending=null;var A=g=g.next;do E=r(E,A.action),A=A.next;while(A!==g);Vt(E,s.memoizedState)||(xt=!0),s.memoizedState=E,s.baseQueue===null&&(s.baseState=E),c.lastRenderedState=E}return[E,h]}function ld(){}function ud(r,s){var c=ze,h=Nt(),g=s(),E=!Vt(h.memoizedState,g);if(E&&(h.memoizedState=g,xt=!0),h=h.queue,Tl(dd.bind(null,c,h,r),[r]),h.getSnapshot!==s||E||rt!==null&&rt.memoizedState.tag&1){if(c.flags|=2048,Ni(9,fd.bind(null,c,h,g,s),void 0,null),it===null)throw Error(t(349));ar&30||cd(c,s,g)}return g}function cd(r,s,c){r.flags|=16384,r={getSnapshot:s,value:c},s=ze.updateQueue,s===null?(s={lastEffect:null,stores:null},ze.updateQueue=s,s.stores=[r]):(c=s.stores,c===null?s.stores=[r]:c.push(r))}function fd(r,s,c,h){s.value=c,s.getSnapshot=h,hd(s)&&pd(r)}function dd(r,s,c){return c(function(){hd(s)&&pd(r)})}function hd(r){var s=r.getSnapshot;r=r.value;try{var c=s();return!Vt(r,c)}catch{return!0}}function pd(r){var s=vn(r,1);s!==null&&Yt(s,r,1,-1)}function md(r){var s=nn();return typeof r=="function"&&(r=r()),s.memoizedState=s.baseState=r,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Fi,lastRenderedState:r},s.queue=r,r=r.dispatch=H0.bind(null,ze,r),[s.memoizedState,r]}function Ni(r,s,c,h){return r={tag:r,create:s,destroy:c,deps:h,next:null},s=ze.updateQueue,s===null?(s={lastEffect:null,stores:null},ze.updateQueue=s,s.lastEffect=r.next=r):(c=s.lastEffect,c===null?s.lastEffect=r.next=r:(h=c.next,c.next=r,r.next=h,s.lastEffect=r)),r}function gd(){return Nt().memoizedState}function Ws(r,s,c,h){var g=nn();ze.flags|=r,g.memoizedState=Ni(1|s,c,void 0,h===void 0?null:h)}function Ys(r,s,c,h){var g=Nt();h=h===void 0?null:h;var E=void 0;if(et!==null){var A=et.memoizedState;if(E=A.destroy,h!==null&&ml(h,A.deps)){g.memoizedState=Ni(s,c,E,h);return}}ze.flags|=r,g.memoizedState=Ni(1|s,c,E,h)}function yd(r,s){return Ws(8390656,8,r,s)}function Tl(r,s){return Ys(2048,8,r,s)}function Ed(r,s){return Ys(4,2,r,s)}function vd(r,s){return Ys(4,4,r,s)}function Td(r,s){if(typeof s=="function")return r=r(),s(r),function(){s(null)};if(s!=null)return r=r(),s.current=r,function(){s.current=null}}function xd(r,s,c){return c=c!=null?c.concat([r]):null,Ys(4,4,Td.bind(null,s,r),c)}function xl(){}function Sd(r,s){var c=Nt();s=s===void 0?null:s;var h=c.memoizedState;return h!==null&&s!==null&&ml(s,h[1])?h[0]:(c.memoizedState=[r,s],r)}function Ld(r,s){var c=Nt();s=s===void 0?null:s;var h=c.memoizedState;return h!==null&&s!==null&&ml(s,h[1])?h[0]:(r=r(),c.memoizedState=[r,s],r)}function Ad(r,s,c){return ar&21?(Vt(c,s)||(c=Zc(),ze.lanes|=c,or|=c,r.baseState=!0),s):(r.baseState&&(r.baseState=!1,xt=!0),r.memoizedState=c)}function $0(r,s){var c=Oe;Oe=c!==0&&4>c?c:4,r(!0);var h=pl.transition;pl.transition={};try{r(!1),s()}finally{Oe=c,pl.transition=h}}function Rd(){return Nt().memoizedState}function G0(r,s,c){var h=zn(r);if(c={lane:h,action:c,hasEagerState:!1,eagerState:null,next:null},wd(r))Cd(s,c);else if(c=rd(r,s,c,h),c!==null){var g=Et();Yt(c,r,h,g),Id(c,s,h)}}function H0(r,s,c){var h=zn(r),g={lane:h,action:c,hasEagerState:!1,eagerState:null,next:null};if(wd(r))Cd(s,g);else{var E=r.alternate;if(r.lanes===0&&(E===null||E.lanes===0)&&(E=s.lastRenderedReducer,E!==null))try{var A=s.lastRenderedState,C=E(A,c);if(g.hasEagerState=!0,g.eagerState=C,Vt(C,A)){var k=s.interleaved;k===null?(g.next=g,ll(s)):(g.next=k.next,k.next=g),s.interleaved=g;return}}catch{}finally{}c=rd(r,s,g,h),c!==null&&(g=Et(),Yt(c,r,h,g),Id(c,s,h))}}function wd(r){var s=r.alternate;return r===ze||s!==null&&s===ze}function Cd(r,s){bi=zs=!0;var c=r.pending;c===null?s.next=s:(s.next=c.next,c.next=s),r.pending=s}function Id(r,s,c){if(c&4194240){var h=s.lanes;h&=r.pendingLanes,c|=h,s.lanes=c,Lo(r,c)}}var qs={readContext:Ft,useCallback:ht,useContext:ht,useEffect:ht,useImperativeHandle:ht,useInsertionEffect:ht,useLayoutEffect:ht,useMemo:ht,useReducer:ht,useRef:ht,useState:ht,useDebugValue:ht,useDeferredValue:ht,useTransition:ht,useMutableSource:ht,useSyncExternalStore:ht,useId:ht,unstable_isNewReconciler:!1},V0={readContext:Ft,useCallback:function(r,s){return nn().memoizedState=[r,s===void 0?null:s],r},useContext:Ft,useEffect:yd,useImperativeHandle:function(r,s,c){return c=c!=null?c.concat([r]):null,Ws(4194308,4,Td.bind(null,s,r),c)},useLayoutEffect:function(r,s){return Ws(4194308,4,r,s)},useInsertionEffect:function(r,s){return Ws(4,2,r,s)},useMemo:function(r,s){var c=nn();return s=s===void 0?null:s,r=r(),c.memoizedState=[r,s],r},useReducer:function(r,s,c){var h=nn();return s=c!==void 0?c(s):s,h.memoizedState=h.baseState=s,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:s},h.queue=r,r=r.dispatch=G0.bind(null,ze,r),[h.memoizedState,r]},useRef:function(r){var s=nn();return r={current:r},s.memoizedState=r},useState:md,useDebugValue:xl,useDeferredValue:function(r){return nn().memoizedState=r},useTransition:function(){var r=md(!1),s=r[0];return r=$0.bind(null,r[1]),nn().memoizedState=r,[s,r]},useMutableSource:function(){},useSyncExternalStore:function(r,s,c){var h=ze,g=nn();if(He){if(c===void 0)throw Error(t(407));c=c()}else{if(c=s(),it===null)throw Error(t(349));ar&30||cd(h,s,c)}g.memoizedState=c;var E={value:c,getSnapshot:s};return g.queue=E,yd(dd.bind(null,h,E,r),[r]),h.flags|=2048,Ni(9,fd.bind(null,h,E,c,s),void 0,null),c},useId:function(){var r=nn(),s=it.identifierPrefix;if(He){var c=En,h=yn;c=(h&~(1<<32-Ht(h)-1)).toString(32)+c,s=":"+s+"R"+c,c=Oi++,0<c&&(s+="H"+c.toString(32)),s+=":"}else c=B0++,s=":"+s+"r"+c.toString(32)+":";return r.memoizedState=s},unstable_isNewReconciler:!1},K0={readContext:Ft,useCallback:Sd,useContext:Ft,useEffect:Tl,useImperativeHandle:xd,useInsertionEffect:Ed,useLayoutEffect:vd,useMemo:Ld,useReducer:El,useRef:gd,useState:function(){return El(Fi)},useDebugValue:xl,useDeferredValue:function(r){var s=Nt();return Ad(s,et.memoizedState,r)},useTransition:function(){var r=El(Fi)[0],s=Nt().memoizedState;return[r,s]},useMutableSource:ld,useSyncExternalStore:ud,useId:Rd,unstable_isNewReconciler:!1},j0={readContext:Ft,useCallback:Sd,useContext:Ft,useEffect:Tl,useImperativeHandle:xd,useInsertionEffect:Ed,useLayoutEffect:vd,useMemo:Ld,useReducer:vl,useRef:gd,useState:function(){return vl(Fi)},useDebugValue:xl,useDeferredValue:function(r){var s=Nt();return et===null?s.memoizedState=r:Ad(s,et.memoizedState,r)},useTransition:function(){var r=vl(Fi)[0],s=Nt().memoizedState;return[r,s]},useMutableSource:ld,useSyncExternalStore:ud,useId:Rd,unstable_isNewReconciler:!1};function jt(r,s){if(r&&r.defaultProps){s=H({},s),r=r.defaultProps;for(var c in r)s[c]===void 0&&(s[c]=r[c]);return s}return s}function Sl(r,s,c,h){s=r.memoizedState,c=c(h,s),c=c==null?s:H({},s,c),r.memoizedState=c,r.lanes===0&&(r.updateQueue.baseState=c)}var Xs={isMounted:function(r){return(r=r._reactInternals)?Zn(r)===r:!1},enqueueSetState:function(r,s,c){r=r._reactInternals;var h=Et(),g=zn(r),E=Tn(h,g);E.payload=s,c!=null&&(E.callback=c),s=Hn(r,E,g),s!==null&&(Yt(s,r,g,h),Hs(s,r,g))},enqueueReplaceState:function(r,s,c){r=r._reactInternals;var h=Et(),g=zn(r),E=Tn(h,g);E.tag=1,E.payload=s,c!=null&&(E.callback=c),s=Hn(r,E,g),s!==null&&(Yt(s,r,g,h),Hs(s,r,g))},enqueueForceUpdate:function(r,s){r=r._reactInternals;var c=Et(),h=zn(r),g=Tn(c,h);g.tag=2,s!=null&&(g.callback=s),s=Hn(r,g,h),s!==null&&(Yt(s,r,h,c),Hs(s,r,h))}};function kd(r,s,c,h,g,E,A){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(h,E,A):s.prototype&&s.prototype.isPureReactComponent?!Si(c,h)||!Si(g,E):!0}function Dd(r,s,c){var h=!1,g=Bn,E=s.contextType;return typeof E=="object"&&E!==null?E=Ft(E):(g=Tt(s)?tr:dt.current,h=s.contextTypes,E=(h=h!=null)?Pr(r,g):Bn),s=new s(c,E),r.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=Xs,r.stateNode=s,s._reactInternals=r,h&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=g,r.__reactInternalMemoizedMaskedChildContext=E),s}function _d(r,s,c,h){r=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(c,h),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(c,h),s.state!==r&&Xs.enqueueReplaceState(s,s.state,null)}function Ll(r,s,c,h){var g=r.stateNode;g.props=c,g.state=r.memoizedState,g.refs={},ul(r);var E=s.contextType;typeof E=="object"&&E!==null?g.context=Ft(E):(E=Tt(s)?tr:dt.current,g.context=Pr(r,E)),g.state=r.memoizedState,E=s.getDerivedStateFromProps,typeof E=="function"&&(Sl(r,s,E,c),g.state=r.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(s=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),s!==g.state&&Xs.enqueueReplaceState(g,g.state,null),Vs(r,c,g,h),g.state=r.memoizedState),typeof g.componentDidMount=="function"&&(r.flags|=4194308)}function $r(r,s){try{var c="",h=s;do c+=xe(h),h=h.return;while(h);var g=c}catch(E){g=`
Error generating stack: `+E.message+`
`+E.stack}return{value:r,source:s,stack:g,digest:null}}function Al(r,s,c){return{value:r,source:null,stack:c??null,digest:s??null}}function Rl(r,s){try{console.error(s.value)}catch(c){setTimeout(function(){throw c})}}var z0=typeof WeakMap=="function"?WeakMap:Map;function Pd(r,s,c){c=Tn(-1,c),c.tag=3,c.payload={element:null};var h=s.value;return c.callback=function(){ra||(ra=!0,$l=h),Rl(r,s)},c}function bd(r,s,c){c=Tn(-1,c),c.tag=3;var h=r.type.getDerivedStateFromError;if(typeof h=="function"){var g=s.value;c.payload=function(){return h(g)},c.callback=function(){Rl(r,s)}}var E=r.stateNode;return E!==null&&typeof E.componentDidCatch=="function"&&(c.callback=function(){Rl(r,s),typeof h!="function"&&(Kn===null?Kn=new Set([this]):Kn.add(this));var A=s.stack;this.componentDidCatch(s.value,{componentStack:A!==null?A:""})}),c}function Od(r,s,c){var h=r.pingCache;if(h===null){h=r.pingCache=new z0;var g=new Set;h.set(s,g)}else g=h.get(s),g===void 0&&(g=new Set,h.set(s,g));g.has(c)||(g.add(c),r=ay.bind(null,r,s,c),s.then(r,r))}function Fd(r){do{var s;if((s=r.tag===13)&&(s=r.memoizedState,s=s!==null?s.dehydrated!==null:!0),s)return r;r=r.return}while(r!==null);return null}function Nd(r,s,c,h,g){return r.mode&1?(r.flags|=65536,r.lanes=g,r):(r===s?r.flags|=65536:(r.flags|=128,c.flags|=131072,c.flags&=-52805,c.tag===1&&(c.alternate===null?c.tag=17:(s=Tn(-1,1),s.tag=2,Hn(c,s,1))),c.lanes|=1),r)}var W0=b.ReactCurrentOwner,xt=!1;function yt(r,s,c,h){s.child=r===null?nd(s,null,c,h):Nr(s,r.child,c,h)}function Md(r,s,c,h,g){c=c.render;var E=s.ref;return Ur(s,g),h=gl(r,s,c,h,E,g),c=yl(),r!==null&&!xt?(s.updateQueue=r.updateQueue,s.flags&=-2053,r.lanes&=~g,xn(r,s,g)):(He&&c&&Zo(s),s.flags|=1,yt(r,s,h,g),s.child)}function Ud(r,s,c,h,g){if(r===null){var E=c.type;return typeof E=="function"&&!Wl(E)&&E.defaultProps===void 0&&c.compare===null&&c.defaultProps===void 0?(s.tag=15,s.type=E,Bd(r,s,E,h,g)):(r=ua(c.type,null,h,s,s.mode,g),r.ref=s.ref,r.return=s,s.child=r)}if(E=r.child,!(r.lanes&g)){var A=E.memoizedProps;if(c=c.compare,c=c!==null?c:Si,c(A,h)&&r.ref===s.ref)return xn(r,s,g)}return s.flags|=1,r=Yn(E,h),r.ref=s.ref,r.return=s,s.child=r}function Bd(r,s,c,h,g){if(r!==null){var E=r.memoizedProps;if(Si(E,h)&&r.ref===s.ref)if(xt=!1,s.pendingProps=h=E,(r.lanes&g)!==0)r.flags&131072&&(xt=!0);else return s.lanes=r.lanes,xn(r,s,g)}return wl(r,s,c,h,g)}function $d(r,s,c){var h=s.pendingProps,g=h.children,E=r!==null?r.memoizedState:null;if(h.mode==="hidden")if(!(s.mode&1))s.memoizedState={baseLanes:0,cachePool:null,transitions:null},Me(Hr,Pt),Pt|=c;else{if(!(c&1073741824))return r=E!==null?E.baseLanes|c:c,s.lanes=s.childLanes=1073741824,s.memoizedState={baseLanes:r,cachePool:null,transitions:null},s.updateQueue=null,Me(Hr,Pt),Pt|=r,null;s.memoizedState={baseLanes:0,cachePool:null,transitions:null},h=E!==null?E.baseLanes:c,Me(Hr,Pt),Pt|=h}else E!==null?(h=E.baseLanes|c,s.memoizedState=null):h=c,Me(Hr,Pt),Pt|=h;return yt(r,s,g,c),s.child}function Gd(r,s){var c=s.ref;(r===null&&c!==null||r!==null&&r.ref!==c)&&(s.flags|=512,s.flags|=2097152)}function wl(r,s,c,h,g){var E=Tt(c)?tr:dt.current;return E=Pr(s,E),Ur(s,g),c=gl(r,s,c,h,E,g),h=yl(),r!==null&&!xt?(s.updateQueue=r.updateQueue,s.flags&=-2053,r.lanes&=~g,xn(r,s,g)):(He&&h&&Zo(s),s.flags|=1,yt(r,s,c,g),s.child)}function Hd(r,s,c,h,g){if(Tt(c)){var E=!0;Os(s)}else E=!1;if(Ur(s,g),s.stateNode===null)Js(r,s),Dd(s,c,h),Ll(s,c,h,g),h=!0;else if(r===null){var A=s.stateNode,C=s.memoizedProps;A.props=C;var k=A.context,B=c.contextType;typeof B=="object"&&B!==null?B=Ft(B):(B=Tt(c)?tr:dt.current,B=Pr(s,B));var Z=c.getDerivedStateFromProps,te=typeof Z=="function"||typeof A.getSnapshotBeforeUpdate=="function";te||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(C!==h||k!==B)&&_d(s,A,h,B),Gn=!1;var q=s.memoizedState;A.state=q,Vs(s,h,A,g),k=s.memoizedState,C!==h||q!==k||vt.current||Gn?(typeof Z=="function"&&(Sl(s,c,Z,h),k=s.memoizedState),(C=Gn||kd(s,c,C,h,q,k,B))?(te||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount()),typeof A.componentDidMount=="function"&&(s.flags|=4194308)):(typeof A.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=h,s.memoizedState=k),A.props=h,A.state=k,A.context=B,h=C):(typeof A.componentDidMount=="function"&&(s.flags|=4194308),h=!1)}else{A=s.stateNode,id(r,s),C=s.memoizedProps,B=s.type===s.elementType?C:jt(s.type,C),A.props=B,te=s.pendingProps,q=A.context,k=c.contextType,typeof k=="object"&&k!==null?k=Ft(k):(k=Tt(c)?tr:dt.current,k=Pr(s,k));var ie=c.getDerivedStateFromProps;(Z=typeof ie=="function"||typeof A.getSnapshotBeforeUpdate=="function")||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(C!==te||q!==k)&&_d(s,A,h,k),Gn=!1,q=s.memoizedState,A.state=q,Vs(s,h,A,g);var ue=s.memoizedState;C!==te||q!==ue||vt.current||Gn?(typeof ie=="function"&&(Sl(s,c,ie,h),ue=s.memoizedState),(B=Gn||kd(s,c,B,h,q,ue,k)||!1)?(Z||typeof A.UNSAFE_componentWillUpdate!="function"&&typeof A.componentWillUpdate!="function"||(typeof A.componentWillUpdate=="function"&&A.componentWillUpdate(h,ue,k),typeof A.UNSAFE_componentWillUpdate=="function"&&A.UNSAFE_componentWillUpdate(h,ue,k)),typeof A.componentDidUpdate=="function"&&(s.flags|=4),typeof A.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof A.componentDidUpdate!="function"||C===r.memoizedProps&&q===r.memoizedState||(s.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||C===r.memoizedProps&&q===r.memoizedState||(s.flags|=1024),s.memoizedProps=h,s.memoizedState=ue),A.props=h,A.state=ue,A.context=k,h=B):(typeof A.componentDidUpdate!="function"||C===r.memoizedProps&&q===r.memoizedState||(s.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||C===r.memoizedProps&&q===r.memoizedState||(s.flags|=1024),h=!1)}return Cl(r,s,c,h,E,g)}function Cl(r,s,c,h,g,E){Gd(r,s);var A=(s.flags&128)!==0;if(!h&&!A)return g&&Wf(s,c,!1),xn(r,s,E);h=s.stateNode,W0.current=s;var C=A&&typeof c.getDerivedStateFromError!="function"?null:h.render();return s.flags|=1,r!==null&&A?(s.child=Nr(s,r.child,null,E),s.child=Nr(s,null,C,E)):yt(r,s,C,E),s.memoizedState=h.state,g&&Wf(s,c,!0),s.child}function Vd(r){var s=r.stateNode;s.pendingContext?jf(r,s.pendingContext,s.pendingContext!==s.context):s.context&&jf(r,s.context,!1),cl(r,s.containerInfo)}function Kd(r,s,c,h,g){return Fr(),rl(g),s.flags|=256,yt(r,s,c,h),s.child}var Il={dehydrated:null,treeContext:null,retryLane:0};function kl(r){return{baseLanes:r,cachePool:null,transitions:null}}function jd(r,s,c){var h=s.pendingProps,g=je.current,E=!1,A=(s.flags&128)!==0,C;if((C=A)||(C=r!==null&&r.memoizedState===null?!1:(g&2)!==0),C?(E=!0,s.flags&=-129):(r===null||r.memoizedState!==null)&&(g|=1),Me(je,g&1),r===null)return nl(s),r=s.memoizedState,r!==null&&(r=r.dehydrated,r!==null)?(s.mode&1?r.data==="$!"?s.lanes=8:s.lanes=1073741824:s.lanes=1,null):(A=h.children,r=h.fallback,E?(h=s.mode,E=s.child,A={mode:"hidden",children:A},!(h&1)&&E!==null?(E.childLanes=0,E.pendingProps=A):E=ca(A,h,0,null),r=fr(r,h,c,null),E.return=s,r.return=s,E.sibling=r,s.child=E,s.child.memoizedState=kl(c),s.memoizedState=Il,r):Dl(s,A));if(g=r.memoizedState,g!==null&&(C=g.dehydrated,C!==null))return Y0(r,s,A,h,C,g,c);if(E){E=h.fallback,A=s.mode,g=r.child,C=g.sibling;var k={mode:"hidden",children:h.children};return!(A&1)&&s.child!==g?(h=s.child,h.childLanes=0,h.pendingProps=k,s.deletions=null):(h=Yn(g,k),h.subtreeFlags=g.subtreeFlags&14680064),C!==null?E=Yn(C,E):(E=fr(E,A,c,null),E.flags|=2),E.return=s,h.return=s,h.sibling=E,s.child=h,h=E,E=s.child,A=r.child.memoizedState,A=A===null?kl(c):{baseLanes:A.baseLanes|c,cachePool:null,transitions:A.transitions},E.memoizedState=A,E.childLanes=r.childLanes&~c,s.memoizedState=Il,h}return E=r.child,r=E.sibling,h=Yn(E,{mode:"visible",children:h.children}),!(s.mode&1)&&(h.lanes=c),h.return=s,h.sibling=null,r!==null&&(c=s.deletions,c===null?(s.deletions=[r],s.flags|=16):c.push(r)),s.child=h,s.memoizedState=null,h}function Dl(r,s){return s=ca({mode:"visible",children:s},r.mode,0,null),s.return=r,r.child=s}function Qs(r,s,c,h){return h!==null&&rl(h),Nr(s,r.child,null,c),r=Dl(s,s.pendingProps.children),r.flags|=2,s.memoizedState=null,r}function Y0(r,s,c,h,g,E,A){if(c)return s.flags&256?(s.flags&=-257,h=Al(Error(t(422))),Qs(r,s,A,h)):s.memoizedState!==null?(s.child=r.child,s.flags|=128,null):(E=h.fallback,g=s.mode,h=ca({mode:"visible",children:h.children},g,0,null),E=fr(E,g,A,null),E.flags|=2,h.return=s,E.return=s,h.sibling=E,s.child=h,s.mode&1&&Nr(s,r.child,null,A),s.child.memoizedState=kl(A),s.memoizedState=Il,E);if(!(s.mode&1))return Qs(r,s,A,null);if(g.data==="$!"){if(h=g.nextSibling&&g.nextSibling.dataset,h)var C=h.dgst;return h=C,E=Error(t(419)),h=Al(E,h,void 0),Qs(r,s,A,h)}if(C=(A&r.childLanes)!==0,xt||C){if(h=it,h!==null){switch(A&-A){case 4:g=2;break;case 16:g=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:g=32;break;case 536870912:g=268435456;break;default:g=0}g=g&(h.suspendedLanes|A)?0:g,g!==0&&g!==E.retryLane&&(E.retryLane=g,vn(r,g),Yt(h,r,g,-1))}return zl(),h=Al(Error(t(421))),Qs(r,s,A,h)}return g.data==="$?"?(s.flags|=128,s.child=r.child,s=oy.bind(null,r),g._reactRetry=s,null):(r=E.treeContext,_t=Mn(g.nextSibling),Dt=s,He=!0,Kt=null,r!==null&&(bt[Ot++]=yn,bt[Ot++]=En,bt[Ot++]=nr,yn=r.id,En=r.overflow,nr=s),s=Dl(s,h.children),s.flags|=4096,s)}function zd(r,s,c){r.lanes|=s;var h=r.alternate;h!==null&&(h.lanes|=s),ol(r.return,s,c)}function _l(r,s,c,h,g){var E=r.memoizedState;E===null?r.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:h,tail:c,tailMode:g}:(E.isBackwards=s,E.rendering=null,E.renderingStartTime=0,E.last=h,E.tail=c,E.tailMode=g)}function Wd(r,s,c){var h=s.pendingProps,g=h.revealOrder,E=h.tail;if(yt(r,s,h.children,c),h=je.current,h&2)h=h&1|2,s.flags|=128;else{if(r!==null&&r.flags&128)e:for(r=s.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&zd(r,c,s);else if(r.tag===19)zd(r,c,s);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break e;for(;r.sibling===null;){if(r.return===null||r.return===s)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}h&=1}if(Me(je,h),!(s.mode&1))s.memoizedState=null;else switch(g){case"forwards":for(c=s.child,g=null;c!==null;)r=c.alternate,r!==null&&Ks(r)===null&&(g=c),c=c.sibling;c=g,c===null?(g=s.child,s.child=null):(g=c.sibling,c.sibling=null),_l(s,!1,g,c,E);break;case"backwards":for(c=null,g=s.child,s.child=null;g!==null;){if(r=g.alternate,r!==null&&Ks(r)===null){s.child=g;break}r=g.sibling,g.sibling=c,c=g,g=r}_l(s,!0,c,null,E);break;case"together":_l(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function Js(r,s){!(s.mode&1)&&r!==null&&(r.alternate=null,s.alternate=null,s.flags|=2)}function xn(r,s,c){if(r!==null&&(s.dependencies=r.dependencies),or|=s.lanes,!(c&s.childLanes))return null;if(r!==null&&s.child!==r.child)throw Error(t(153));if(s.child!==null){for(r=s.child,c=Yn(r,r.pendingProps),s.child=c,c.return=s;r.sibling!==null;)r=r.sibling,c=c.sibling=Yn(r,r.pendingProps),c.return=s;c.sibling=null}return s.child}function q0(r,s,c){switch(s.tag){case 3:Vd(s),Fr();break;case 5:od(s);break;case 1:Tt(s.type)&&Os(s);break;case 4:cl(s,s.stateNode.containerInfo);break;case 10:var h=s.type._context,g=s.memoizedProps.value;Me($s,h._currentValue),h._currentValue=g;break;case 13:if(h=s.memoizedState,h!==null)return h.dehydrated!==null?(Me(je,je.current&1),s.flags|=128,null):c&s.child.childLanes?jd(r,s,c):(Me(je,je.current&1),r=xn(r,s,c),r!==null?r.sibling:null);Me(je,je.current&1);break;case 19:if(h=(c&s.childLanes)!==0,r.flags&128){if(h)return Wd(r,s,c);s.flags|=128}if(g=s.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),Me(je,je.current),h)break;return null;case 22:case 23:return s.lanes=0,$d(r,s,c)}return xn(r,s,c)}var Yd,Pl,qd,Xd;Yd=function(r,s){for(var c=s.child;c!==null;){if(c.tag===5||c.tag===6)r.appendChild(c.stateNode);else if(c.tag!==4&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===s)break;for(;c.sibling===null;){if(c.return===null||c.return===s)return;c=c.return}c.sibling.return=c.return,c=c.sibling}},Pl=function(){},qd=function(r,s,c,h){var g=r.memoizedProps;if(g!==h){r=s.stateNode,sr(tn.current);var E=null;switch(c){case"input":g=ao(r,g),h=ao(r,h),E=[];break;case"select":g=H({},g,{value:void 0}),h=H({},h,{value:void 0}),E=[];break;case"textarea":g=uo(r,g),h=uo(r,h),E=[];break;default:typeof g.onClick!="function"&&typeof h.onClick=="function"&&(r.onclick=_s)}fo(c,h);var A;c=null;for(B in g)if(!h.hasOwnProperty(B)&&g.hasOwnProperty(B)&&g[B]!=null)if(B==="style"){var C=g[B];for(A in C)C.hasOwnProperty(A)&&(c||(c={}),c[A]="")}else B!=="dangerouslySetInnerHTML"&&B!=="children"&&B!=="suppressContentEditableWarning"&&B!=="suppressHydrationWarning"&&B!=="autoFocus"&&(i.hasOwnProperty(B)?E||(E=[]):(E=E||[]).push(B,null));for(B in h){var k=h[B];if(C=g!=null?g[B]:void 0,h.hasOwnProperty(B)&&k!==C&&(k!=null||C!=null))if(B==="style")if(C){for(A in C)!C.hasOwnProperty(A)||k&&k.hasOwnProperty(A)||(c||(c={}),c[A]="");for(A in k)k.hasOwnProperty(A)&&C[A]!==k[A]&&(c||(c={}),c[A]=k[A])}else c||(E||(E=[]),E.push(B,c)),c=k;else B==="dangerouslySetInnerHTML"?(k=k?k.__html:void 0,C=C?C.__html:void 0,k!=null&&C!==k&&(E=E||[]).push(B,k)):B==="children"?typeof k!="string"&&typeof k!="number"||(E=E||[]).push(B,""+k):B!=="suppressContentEditableWarning"&&B!=="suppressHydrationWarning"&&(i.hasOwnProperty(B)?(k!=null&&B==="onScroll"&&Be("scroll",r),E||C===k||(E=[])):(E=E||[]).push(B,k))}c&&(E=E||[]).push("style",c);var B=E;(s.updateQueue=B)&&(s.flags|=4)}},Xd=function(r,s,c,h){c!==h&&(s.flags|=4)};function Mi(r,s){if(!He)switch(r.tailMode){case"hidden":s=r.tail;for(var c=null;s!==null;)s.alternate!==null&&(c=s),s=s.sibling;c===null?r.tail=null:c.sibling=null;break;case"collapsed":c=r.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?s||r.tail===null?r.tail=null:r.tail.sibling=null:h.sibling=null}}function pt(r){var s=r.alternate!==null&&r.alternate.child===r.child,c=0,h=0;if(s)for(var g=r.child;g!==null;)c|=g.lanes|g.childLanes,h|=g.subtreeFlags&14680064,h|=g.flags&14680064,g.return=r,g=g.sibling;else for(g=r.child;g!==null;)c|=g.lanes|g.childLanes,h|=g.subtreeFlags,h|=g.flags,g.return=r,g=g.sibling;return r.subtreeFlags|=h,r.childLanes=c,s}function X0(r,s,c){var h=s.pendingProps;switch(el(s),s.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return pt(s),null;case 1:return Tt(s.type)&&bs(),pt(s),null;case 3:return h=s.stateNode,Br(),$e(vt),$e(dt),hl(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(r===null||r.child===null)&&(Us(s)?s.flags|=4:r===null||r.memoizedState.isDehydrated&&!(s.flags&256)||(s.flags|=1024,Kt!==null&&(Vl(Kt),Kt=null))),Pl(r,s),pt(s),null;case 5:fl(s);var g=sr(Pi.current);if(c=s.type,r!==null&&s.stateNode!=null)qd(r,s,c,h,g),r.ref!==s.ref&&(s.flags|=512,s.flags|=2097152);else{if(!h){if(s.stateNode===null)throw Error(t(166));return pt(s),null}if(r=sr(tn.current),Us(s)){h=s.stateNode,c=s.type;var E=s.memoizedProps;switch(h[en]=s,h[Ci]=E,r=(s.mode&1)!==0,c){case"dialog":Be("cancel",h),Be("close",h);break;case"iframe":case"object":case"embed":Be("load",h);break;case"video":case"audio":for(g=0;g<Ai.length;g++)Be(Ai[g],h);break;case"source":Be("error",h);break;case"img":case"image":case"link":Be("error",h),Be("load",h);break;case"details":Be("toggle",h);break;case"input":kc(h,E),Be("invalid",h);break;case"select":h._wrapperState={wasMultiple:!!E.multiple},Be("invalid",h);break;case"textarea":Pc(h,E),Be("invalid",h)}fo(c,E),g=null;for(var A in E)if(E.hasOwnProperty(A)){var C=E[A];A==="children"?typeof C=="string"?h.textContent!==C&&(E.suppressHydrationWarning!==!0&&Ds(h.textContent,C,r),g=["children",C]):typeof C=="number"&&h.textContent!==""+C&&(E.suppressHydrationWarning!==!0&&Ds(h.textContent,C,r),g=["children",""+C]):i.hasOwnProperty(A)&&C!=null&&A==="onScroll"&&Be("scroll",h)}switch(c){case"input":os(h),_c(h,E,!0);break;case"textarea":os(h),Oc(h);break;case"select":case"option":break;default:typeof E.onClick=="function"&&(h.onclick=_s)}h=g,s.updateQueue=h,h!==null&&(s.flags|=4)}else{A=g.nodeType===9?g:g.ownerDocument,r==="http://www.w3.org/1999/xhtml"&&(r=Fc(c)),r==="http://www.w3.org/1999/xhtml"?c==="script"?(r=A.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild)):typeof h.is=="string"?r=A.createElement(c,{is:h.is}):(r=A.createElement(c),c==="select"&&(A=r,h.multiple?A.multiple=!0:h.size&&(A.size=h.size))):r=A.createElementNS(r,c),r[en]=s,r[Ci]=h,Yd(r,s,!1,!1),s.stateNode=r;e:{switch(A=ho(c,h),c){case"dialog":Be("cancel",r),Be("close",r),g=h;break;case"iframe":case"object":case"embed":Be("load",r),g=h;break;case"video":case"audio":for(g=0;g<Ai.length;g++)Be(Ai[g],r);g=h;break;case"source":Be("error",r),g=h;break;case"img":case"image":case"link":Be("error",r),Be("load",r),g=h;break;case"details":Be("toggle",r),g=h;break;case"input":kc(r,h),g=ao(r,h),Be("invalid",r);break;case"option":g=h;break;case"select":r._wrapperState={wasMultiple:!!h.multiple},g=H({},h,{value:void 0}),Be("invalid",r);break;case"textarea":Pc(r,h),g=uo(r,h),Be("invalid",r);break;default:g=h}fo(c,g),C=g;for(E in C)if(C.hasOwnProperty(E)){var k=C[E];E==="style"?Uc(r,k):E==="dangerouslySetInnerHTML"?(k=k?k.__html:void 0,k!=null&&Nc(r,k)):E==="children"?typeof k=="string"?(c!=="textarea"||k!=="")&&si(r,k):typeof k=="number"&&si(r,""+k):E!=="suppressContentEditableWarning"&&E!=="suppressHydrationWarning"&&E!=="autoFocus"&&(i.hasOwnProperty(E)?k!=null&&E==="onScroll"&&Be("scroll",r):k!=null&&w(r,E,k,A))}switch(c){case"input":os(r),_c(r,h,!1);break;case"textarea":os(r),Oc(r);break;case"option":h.value!=null&&r.setAttribute("value",""+ke(h.value));break;case"select":r.multiple=!!h.multiple,E=h.value,E!=null?Tr(r,!!h.multiple,E,!1):h.defaultValue!=null&&Tr(r,!!h.multiple,h.defaultValue,!0);break;default:typeof g.onClick=="function"&&(r.onclick=_s)}switch(c){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}}h&&(s.flags|=4)}s.ref!==null&&(s.flags|=512,s.flags|=2097152)}return pt(s),null;case 6:if(r&&s.stateNode!=null)Xd(r,s,r.memoizedProps,h);else{if(typeof h!="string"&&s.stateNode===null)throw Error(t(166));if(c=sr(Pi.current),sr(tn.current),Us(s)){if(h=s.stateNode,c=s.memoizedProps,h[en]=s,(E=h.nodeValue!==c)&&(r=Dt,r!==null))switch(r.tag){case 3:Ds(h.nodeValue,c,(r.mode&1)!==0);break;case 5:r.memoizedProps.suppressHydrationWarning!==!0&&Ds(h.nodeValue,c,(r.mode&1)!==0)}E&&(s.flags|=4)}else h=(c.nodeType===9?c:c.ownerDocument).createTextNode(h),h[en]=s,s.stateNode=h}return pt(s),null;case 13:if($e(je),h=s.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(He&&_t!==null&&s.mode&1&&!(s.flags&128))Zf(),Fr(),s.flags|=98560,E=!1;else if(E=Us(s),h!==null&&h.dehydrated!==null){if(r===null){if(!E)throw Error(t(318));if(E=s.memoizedState,E=E!==null?E.dehydrated:null,!E)throw Error(t(317));E[en]=s}else Fr(),!(s.flags&128)&&(s.memoizedState=null),s.flags|=4;pt(s),E=!1}else Kt!==null&&(Vl(Kt),Kt=null),E=!0;if(!E)return s.flags&65536?s:null}return s.flags&128?(s.lanes=c,s):(h=h!==null,h!==(r!==null&&r.memoizedState!==null)&&h&&(s.child.flags|=8192,s.mode&1&&(r===null||je.current&1?tt===0&&(tt=3):zl())),s.updateQueue!==null&&(s.flags|=4),pt(s),null);case 4:return Br(),Pl(r,s),r===null&&Ri(s.stateNode.containerInfo),pt(s),null;case 10:return al(s.type._context),pt(s),null;case 17:return Tt(s.type)&&bs(),pt(s),null;case 19:if($e(je),E=s.memoizedState,E===null)return pt(s),null;if(h=(s.flags&128)!==0,A=E.rendering,A===null)if(h)Mi(E,!1);else{if(tt!==0||r!==null&&r.flags&128)for(r=s.child;r!==null;){if(A=Ks(r),A!==null){for(s.flags|=128,Mi(E,!1),h=A.updateQueue,h!==null&&(s.updateQueue=h,s.flags|=4),s.subtreeFlags=0,h=c,c=s.child;c!==null;)E=c,r=h,E.flags&=14680066,A=E.alternate,A===null?(E.childLanes=0,E.lanes=r,E.child=null,E.subtreeFlags=0,E.memoizedProps=null,E.memoizedState=null,E.updateQueue=null,E.dependencies=null,E.stateNode=null):(E.childLanes=A.childLanes,E.lanes=A.lanes,E.child=A.child,E.subtreeFlags=0,E.deletions=null,E.memoizedProps=A.memoizedProps,E.memoizedState=A.memoizedState,E.updateQueue=A.updateQueue,E.type=A.type,r=A.dependencies,E.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),c=c.sibling;return Me(je,je.current&1|2),s.child}r=r.sibling}E.tail!==null&&Xe()>Vr&&(s.flags|=128,h=!0,Mi(E,!1),s.lanes=4194304)}else{if(!h)if(r=Ks(A),r!==null){if(s.flags|=128,h=!0,c=r.updateQueue,c!==null&&(s.updateQueue=c,s.flags|=4),Mi(E,!0),E.tail===null&&E.tailMode==="hidden"&&!A.alternate&&!He)return pt(s),null}else 2*Xe()-E.renderingStartTime>Vr&&c!==1073741824&&(s.flags|=128,h=!0,Mi(E,!1),s.lanes=4194304);E.isBackwards?(A.sibling=s.child,s.child=A):(c=E.last,c!==null?c.sibling=A:s.child=A,E.last=A)}return E.tail!==null?(s=E.tail,E.rendering=s,E.tail=s.sibling,E.renderingStartTime=Xe(),s.sibling=null,c=je.current,Me(je,h?c&1|2:c&1),s):(pt(s),null);case 22:case 23:return jl(),h=s.memoizedState!==null,r!==null&&r.memoizedState!==null!==h&&(s.flags|=8192),h&&s.mode&1?Pt&1073741824&&(pt(s),s.subtreeFlags&6&&(s.flags|=8192)):pt(s),null;case 24:return null;case 25:return null}throw Error(t(156,s.tag))}function Q0(r,s){switch(el(s),s.tag){case 1:return Tt(s.type)&&bs(),r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 3:return Br(),$e(vt),$e(dt),hl(),r=s.flags,r&65536&&!(r&128)?(s.flags=r&-65537|128,s):null;case 5:return fl(s),null;case 13:if($e(je),r=s.memoizedState,r!==null&&r.dehydrated!==null){if(s.alternate===null)throw Error(t(340));Fr()}return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 19:return $e(je),null;case 4:return Br(),null;case 10:return al(s.type._context),null;case 22:case 23:return jl(),null;case 24:return null;default:return null}}var Zs=!1,mt=!1,J0=typeof WeakSet=="function"?WeakSet:Set,ae=null;function Gr(r,s){var c=r.ref;if(c!==null)if(typeof c=="function")try{c(null)}catch(h){qe(r,s,h)}else c.current=null}function bl(r,s,c){try{c()}catch(h){qe(r,s,h)}}var Qd=!1;function Z0(r,s){if(jo=vs,r=kf(),Mo(r)){if("selectionStart"in r)var c={start:r.selectionStart,end:r.selectionEnd};else e:{c=(c=r.ownerDocument)&&c.defaultView||window;var h=c.getSelection&&c.getSelection();if(h&&h.rangeCount!==0){c=h.anchorNode;var g=h.anchorOffset,E=h.focusNode;h=h.focusOffset;try{c.nodeType,E.nodeType}catch{c=null;break e}var A=0,C=-1,k=-1,B=0,Z=0,te=r,q=null;t:for(;;){for(var ie;te!==c||g!==0&&te.nodeType!==3||(C=A+g),te!==E||h!==0&&te.nodeType!==3||(k=A+h),te.nodeType===3&&(A+=te.nodeValue.length),(ie=te.firstChild)!==null;)q=te,te=ie;for(;;){if(te===r)break t;if(q===c&&++B===g&&(C=A),q===E&&++Z===h&&(k=A),(ie=te.nextSibling)!==null)break;te=q,q=te.parentNode}te=ie}c=C===-1||k===-1?null:{start:C,end:k}}else c=null}c=c||{start:0,end:0}}else c=null;for(zo={focusedElem:r,selectionRange:c},vs=!1,ae=s;ae!==null;)if(s=ae,r=s.child,(s.subtreeFlags&1028)!==0&&r!==null)r.return=s,ae=r;else for(;ae!==null;){s=ae;try{var ue=s.alternate;if(s.flags&1024)switch(s.tag){case 0:case 11:case 15:break;case 1:if(ue!==null){var ce=ue.memoizedProps,Qe=ue.memoizedState,F=s.stateNode,P=F.getSnapshotBeforeUpdate(s.elementType===s.type?ce:jt(s.type,ce),Qe);F.__reactInternalSnapshotBeforeUpdate=P}break;case 3:var M=s.stateNode.containerInfo;M.nodeType===1?M.textContent="":M.nodeType===9&&M.documentElement&&M.removeChild(M.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(ne){qe(s,s.return,ne)}if(r=s.sibling,r!==null){r.return=s.return,ae=r;break}ae=s.return}return ue=Qd,Qd=!1,ue}function Ui(r,s,c){var h=s.updateQueue;if(h=h!==null?h.lastEffect:null,h!==null){var g=h=h.next;do{if((g.tag&r)===r){var E=g.destroy;g.destroy=void 0,E!==void 0&&bl(s,c,E)}g=g.next}while(g!==h)}}function ea(r,s){if(s=s.updateQueue,s=s!==null?s.lastEffect:null,s!==null){var c=s=s.next;do{if((c.tag&r)===r){var h=c.create;c.destroy=h()}c=c.next}while(c!==s)}}function Ol(r){var s=r.ref;if(s!==null){var c=r.stateNode;switch(r.tag){case 5:r=c;break;default:r=c}typeof s=="function"?s(r):s.current=r}}function Jd(r){var s=r.alternate;s!==null&&(r.alternate=null,Jd(s)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(s=r.stateNode,s!==null&&(delete s[en],delete s[Ci],delete s[Xo],delete s[F0],delete s[N0])),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}function Zd(r){return r.tag===5||r.tag===3||r.tag===4}function eh(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||Zd(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Fl(r,s,c){var h=r.tag;if(h===5||h===6)r=r.stateNode,s?c.nodeType===8?c.parentNode.insertBefore(r,s):c.insertBefore(r,s):(c.nodeType===8?(s=c.parentNode,s.insertBefore(r,c)):(s=c,s.appendChild(r)),c=c._reactRootContainer,c!=null||s.onclick!==null||(s.onclick=_s));else if(h!==4&&(r=r.child,r!==null))for(Fl(r,s,c),r=r.sibling;r!==null;)Fl(r,s,c),r=r.sibling}function Nl(r,s,c){var h=r.tag;if(h===5||h===6)r=r.stateNode,s?c.insertBefore(r,s):c.appendChild(r);else if(h!==4&&(r=r.child,r!==null))for(Nl(r,s,c),r=r.sibling;r!==null;)Nl(r,s,c),r=r.sibling}var ut=null,zt=!1;function Vn(r,s,c){for(c=c.child;c!==null;)th(r,s,c),c=c.sibling}function th(r,s,c){if(Zt&&typeof Zt.onCommitFiberUnmount=="function")try{Zt.onCommitFiberUnmount(hs,c)}catch{}switch(c.tag){case 5:mt||Gr(c,s);case 6:var h=ut,g=zt;ut=null,Vn(r,s,c),ut=h,zt=g,ut!==null&&(zt?(r=ut,c=c.stateNode,r.nodeType===8?r.parentNode.removeChild(c):r.removeChild(c)):ut.removeChild(c.stateNode));break;case 18:ut!==null&&(zt?(r=ut,c=c.stateNode,r.nodeType===8?qo(r.parentNode,c):r.nodeType===1&&qo(r,c),gi(r)):qo(ut,c.stateNode));break;case 4:h=ut,g=zt,ut=c.stateNode.containerInfo,zt=!0,Vn(r,s,c),ut=h,zt=g;break;case 0:case 11:case 14:case 15:if(!mt&&(h=c.updateQueue,h!==null&&(h=h.lastEffect,h!==null))){g=h=h.next;do{var E=g,A=E.destroy;E=E.tag,A!==void 0&&(E&2||E&4)&&bl(c,s,A),g=g.next}while(g!==h)}Vn(r,s,c);break;case 1:if(!mt&&(Gr(c,s),h=c.stateNode,typeof h.componentWillUnmount=="function"))try{h.props=c.memoizedProps,h.state=c.memoizedState,h.componentWillUnmount()}catch(C){qe(c,s,C)}Vn(r,s,c);break;case 21:Vn(r,s,c);break;case 22:c.mode&1?(mt=(h=mt)||c.memoizedState!==null,Vn(r,s,c),mt=h):Vn(r,s,c);break;default:Vn(r,s,c)}}function nh(r){var s=r.updateQueue;if(s!==null){r.updateQueue=null;var c=r.stateNode;c===null&&(c=r.stateNode=new J0),s.forEach(function(h){var g=ly.bind(null,r,h);c.has(h)||(c.add(h),h.then(g,g))})}}function Wt(r,s){var c=s.deletions;if(c!==null)for(var h=0;h<c.length;h++){var g=c[h];try{var E=r,A=s,C=A;e:for(;C!==null;){switch(C.tag){case 5:ut=C.stateNode,zt=!1;break e;case 3:ut=C.stateNode.containerInfo,zt=!0;break e;case 4:ut=C.stateNode.containerInfo,zt=!0;break e}C=C.return}if(ut===null)throw Error(t(160));th(E,A,g),ut=null,zt=!1;var k=g.alternate;k!==null&&(k.return=null),g.return=null}catch(B){qe(g,s,B)}}if(s.subtreeFlags&12854)for(s=s.child;s!==null;)rh(s,r),s=s.sibling}function rh(r,s){var c=r.alternate,h=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:if(Wt(s,r),rn(r),h&4){try{Ui(3,r,r.return),ea(3,r)}catch(ce){qe(r,r.return,ce)}try{Ui(5,r,r.return)}catch(ce){qe(r,r.return,ce)}}break;case 1:Wt(s,r),rn(r),h&512&&c!==null&&Gr(c,c.return);break;case 5:if(Wt(s,r),rn(r),h&512&&c!==null&&Gr(c,c.return),r.flags&32){var g=r.stateNode;try{si(g,"")}catch(ce){qe(r,r.return,ce)}}if(h&4&&(g=r.stateNode,g!=null)){var E=r.memoizedProps,A=c!==null?c.memoizedProps:E,C=r.type,k=r.updateQueue;if(r.updateQueue=null,k!==null)try{C==="input"&&E.type==="radio"&&E.name!=null&&Dc(g,E),ho(C,A);var B=ho(C,E);for(A=0;A<k.length;A+=2){var Z=k[A],te=k[A+1];Z==="style"?Uc(g,te):Z==="dangerouslySetInnerHTML"?Nc(g,te):Z==="children"?si(g,te):w(g,Z,te,B)}switch(C){case"input":oo(g,E);break;case"textarea":bc(g,E);break;case"select":var q=g._wrapperState.wasMultiple;g._wrapperState.wasMultiple=!!E.multiple;var ie=E.value;ie!=null?Tr(g,!!E.multiple,ie,!1):q!==!!E.multiple&&(E.defaultValue!=null?Tr(g,!!E.multiple,E.defaultValue,!0):Tr(g,!!E.multiple,E.multiple?[]:"",!1))}g[Ci]=E}catch(ce){qe(r,r.return,ce)}}break;case 6:if(Wt(s,r),rn(r),h&4){if(r.stateNode===null)throw Error(t(162));g=r.stateNode,E=r.memoizedProps;try{g.nodeValue=E}catch(ce){qe(r,r.return,ce)}}break;case 3:if(Wt(s,r),rn(r),h&4&&c!==null&&c.memoizedState.isDehydrated)try{gi(s.containerInfo)}catch(ce){qe(r,r.return,ce)}break;case 4:Wt(s,r),rn(r);break;case 13:Wt(s,r),rn(r),g=r.child,g.flags&8192&&(E=g.memoizedState!==null,g.stateNode.isHidden=E,!E||g.alternate!==null&&g.alternate.memoizedState!==null||(Bl=Xe())),h&4&&nh(r);break;case 22:if(Z=c!==null&&c.memoizedState!==null,r.mode&1?(mt=(B=mt)||Z,Wt(s,r),mt=B):Wt(s,r),rn(r),h&8192){if(B=r.memoizedState!==null,(r.stateNode.isHidden=B)&&!Z&&r.mode&1)for(ae=r,Z=r.child;Z!==null;){for(te=ae=Z;ae!==null;){switch(q=ae,ie=q.child,q.tag){case 0:case 11:case 14:case 15:Ui(4,q,q.return);break;case 1:Gr(q,q.return);var ue=q.stateNode;if(typeof ue.componentWillUnmount=="function"){h=q,c=q.return;try{s=h,ue.props=s.memoizedProps,ue.state=s.memoizedState,ue.componentWillUnmount()}catch(ce){qe(h,c,ce)}}break;case 5:Gr(q,q.return);break;case 22:if(q.memoizedState!==null){ah(te);continue}}ie!==null?(ie.return=q,ae=ie):ah(te)}Z=Z.sibling}e:for(Z=null,te=r;;){if(te.tag===5){if(Z===null){Z=te;try{g=te.stateNode,B?(E=g.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none"):(C=te.stateNode,k=te.memoizedProps.style,A=k!=null&&k.hasOwnProperty("display")?k.display:null,C.style.display=Mc("display",A))}catch(ce){qe(r,r.return,ce)}}}else if(te.tag===6){if(Z===null)try{te.stateNode.nodeValue=B?"":te.memoizedProps}catch(ce){qe(r,r.return,ce)}}else if((te.tag!==22&&te.tag!==23||te.memoizedState===null||te===r)&&te.child!==null){te.child.return=te,te=te.child;continue}if(te===r)break e;for(;te.sibling===null;){if(te.return===null||te.return===r)break e;Z===te&&(Z=null),te=te.return}Z===te&&(Z=null),te.sibling.return=te.return,te=te.sibling}}break;case 19:Wt(s,r),rn(r),h&4&&nh(r);break;case 21:break;default:Wt(s,r),rn(r)}}function rn(r){var s=r.flags;if(s&2){try{e:{for(var c=r.return;c!==null;){if(Zd(c)){var h=c;break e}c=c.return}throw Error(t(160))}switch(h.tag){case 5:var g=h.stateNode;h.flags&32&&(si(g,""),h.flags&=-33);var E=eh(r);Nl(r,E,g);break;case 3:case 4:var A=h.stateNode.containerInfo,C=eh(r);Fl(r,C,A);break;default:throw Error(t(161))}}catch(k){qe(r,r.return,k)}r.flags&=-3}s&4096&&(r.flags&=-4097)}function ey(r,s,c){ae=r,ih(r)}function ih(r,s,c){for(var h=(r.mode&1)!==0;ae!==null;){var g=ae,E=g.child;if(g.tag===22&&h){var A=g.memoizedState!==null||Zs;if(!A){var C=g.alternate,k=C!==null&&C.memoizedState!==null||mt;C=Zs;var B=mt;if(Zs=A,(mt=k)&&!B)for(ae=g;ae!==null;)A=ae,k=A.child,A.tag===22&&A.memoizedState!==null?oh(g):k!==null?(k.return=A,ae=k):oh(g);for(;E!==null;)ae=E,ih(E),E=E.sibling;ae=g,Zs=C,mt=B}sh(r)}else g.subtreeFlags&8772&&E!==null?(E.return=g,ae=E):sh(r)}}function sh(r){for(;ae!==null;){var s=ae;if(s.flags&8772){var c=s.alternate;try{if(s.flags&8772)switch(s.tag){case 0:case 11:case 15:mt||ea(5,s);break;case 1:var h=s.stateNode;if(s.flags&4&&!mt)if(c===null)h.componentDidMount();else{var g=s.elementType===s.type?c.memoizedProps:jt(s.type,c.memoizedProps);h.componentDidUpdate(g,c.memoizedState,h.__reactInternalSnapshotBeforeUpdate)}var E=s.updateQueue;E!==null&&ad(s,E,h);break;case 3:var A=s.updateQueue;if(A!==null){if(c=null,s.child!==null)switch(s.child.tag){case 5:c=s.child.stateNode;break;case 1:c=s.child.stateNode}ad(s,A,c)}break;case 5:var C=s.stateNode;if(c===null&&s.flags&4){c=C;var k=s.memoizedProps;switch(s.type){case"button":case"input":case"select":case"textarea":k.autoFocus&&c.focus();break;case"img":k.src&&(c.src=k.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(s.memoizedState===null){var B=s.alternate;if(B!==null){var Z=B.memoizedState;if(Z!==null){var te=Z.dehydrated;te!==null&&gi(te)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}mt||s.flags&512&&Ol(s)}catch(q){qe(s,s.return,q)}}if(s===r){ae=null;break}if(c=s.sibling,c!==null){c.return=s.return,ae=c;break}ae=s.return}}function ah(r){for(;ae!==null;){var s=ae;if(s===r){ae=null;break}var c=s.sibling;if(c!==null){c.return=s.return,ae=c;break}ae=s.return}}function oh(r){for(;ae!==null;){var s=ae;try{switch(s.tag){case 0:case 11:case 15:var c=s.return;try{ea(4,s)}catch(k){qe(s,c,k)}break;case 1:var h=s.stateNode;if(typeof h.componentDidMount=="function"){var g=s.return;try{h.componentDidMount()}catch(k){qe(s,g,k)}}var E=s.return;try{Ol(s)}catch(k){qe(s,E,k)}break;case 5:var A=s.return;try{Ol(s)}catch(k){qe(s,A,k)}}}catch(k){qe(s,s.return,k)}if(s===r){ae=null;break}var C=s.sibling;if(C!==null){C.return=s.return,ae=C;break}ae=s.return}}var ty=Math.ceil,ta=b.ReactCurrentDispatcher,Ml=b.ReactCurrentOwner,Mt=b.ReactCurrentBatchConfig,_e=0,it=null,Je=null,ct=0,Pt=0,Hr=Un(0),tt=0,Bi=null,or=0,na=0,Ul=0,$i=null,St=null,Bl=0,Vr=1/0,Sn=null,ra=!1,$l=null,Kn=null,ia=!1,jn=null,sa=0,Gi=0,Gl=null,aa=-1,oa=0;function Et(){return _e&6?Xe():aa!==-1?aa:aa=Xe()}function zn(r){return r.mode&1?_e&2&&ct!==0?ct&-ct:U0.transition!==null?(oa===0&&(oa=Zc()),oa):(r=Oe,r!==0||(r=window.event,r=r===void 0?16:uf(r.type)),r):1}function Yt(r,s,c,h){if(50<Gi)throw Gi=0,Gl=null,Error(t(185));fi(r,c,h),(!(_e&2)||r!==it)&&(r===it&&(!(_e&2)&&(na|=c),tt===4&&Wn(r,ct)),Lt(r,h),c===1&&_e===0&&!(s.mode&1)&&(Vr=Xe()+500,Fs&&$n()))}function Lt(r,s){var c=r.callbackNode;Ug(r,s);var h=gs(r,r===it?ct:0);if(h===0)c!==null&&Xc(c),r.callbackNode=null,r.callbackPriority=0;else if(s=h&-h,r.callbackPriority!==s){if(c!=null&&Xc(c),s===1)r.tag===0?M0(uh.bind(null,r)):Yf(uh.bind(null,r)),b0(function(){!(_e&6)&&$n()}),c=null;else{switch(ef(h)){case 1:c=To;break;case 4:c=Qc;break;case 16:c=ds;break;case 536870912:c=Jc;break;default:c=ds}c=yh(c,lh.bind(null,r))}r.callbackPriority=s,r.callbackNode=c}}function lh(r,s){if(aa=-1,oa=0,_e&6)throw Error(t(327));var c=r.callbackNode;if(Kr()&&r.callbackNode!==c)return null;var h=gs(r,r===it?ct:0);if(h===0)return null;if(h&30||h&r.expiredLanes||s)s=la(r,h);else{s=h;var g=_e;_e|=2;var E=fh();(it!==r||ct!==s)&&(Sn=null,Vr=Xe()+500,ur(r,s));do try{iy();break}catch(C){ch(r,C)}while(!0);sl(),ta.current=E,_e=g,Je!==null?s=0:(it=null,ct=0,s=tt)}if(s!==0){if(s===2&&(g=xo(r),g!==0&&(h=g,s=Hl(r,g))),s===1)throw c=Bi,ur(r,0),Wn(r,h),Lt(r,Xe()),c;if(s===6)Wn(r,h);else{if(g=r.current.alternate,!(h&30)&&!ny(g)&&(s=la(r,h),s===2&&(E=xo(r),E!==0&&(h=E,s=Hl(r,E))),s===1))throw c=Bi,ur(r,0),Wn(r,h),Lt(r,Xe()),c;switch(r.finishedWork=g,r.finishedLanes=h,s){case 0:case 1:throw Error(t(345));case 2:cr(r,St,Sn);break;case 3:if(Wn(r,h),(h&130023424)===h&&(s=Bl+500-Xe(),10<s)){if(gs(r,0)!==0)break;if(g=r.suspendedLanes,(g&h)!==h){Et(),r.pingedLanes|=r.suspendedLanes&g;break}r.timeoutHandle=Yo(cr.bind(null,r,St,Sn),s);break}cr(r,St,Sn);break;case 4:if(Wn(r,h),(h&4194240)===h)break;for(s=r.eventTimes,g=-1;0<h;){var A=31-Ht(h);E=1<<A,A=s[A],A>g&&(g=A),h&=~E}if(h=g,h=Xe()-h,h=(120>h?120:480>h?480:1080>h?1080:1920>h?1920:3e3>h?3e3:4320>h?4320:1960*ty(h/1960))-h,10<h){r.timeoutHandle=Yo(cr.bind(null,r,St,Sn),h);break}cr(r,St,Sn);break;case 5:cr(r,St,Sn);break;default:throw Error(t(329))}}}return Lt(r,Xe()),r.callbackNode===c?lh.bind(null,r):null}function Hl(r,s){var c=$i;return r.current.memoizedState.isDehydrated&&(ur(r,s).flags|=256),r=la(r,s),r!==2&&(s=St,St=c,s!==null&&Vl(s)),r}function Vl(r){St===null?St=r:St.push.apply(St,r)}function ny(r){for(var s=r;;){if(s.flags&16384){var c=s.updateQueue;if(c!==null&&(c=c.stores,c!==null))for(var h=0;h<c.length;h++){var g=c[h],E=g.getSnapshot;g=g.value;try{if(!Vt(E(),g))return!1}catch{return!1}}}if(c=s.child,s.subtreeFlags&16384&&c!==null)c.return=s,s=c;else{if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function Wn(r,s){for(s&=~Ul,s&=~na,r.suspendedLanes|=s,r.pingedLanes&=~s,r=r.expirationTimes;0<s;){var c=31-Ht(s),h=1<<c;r[c]=-1,s&=~h}}function uh(r){if(_e&6)throw Error(t(327));Kr();var s=gs(r,0);if(!(s&1))return Lt(r,Xe()),null;var c=la(r,s);if(r.tag!==0&&c===2){var h=xo(r);h!==0&&(s=h,c=Hl(r,h))}if(c===1)throw c=Bi,ur(r,0),Wn(r,s),Lt(r,Xe()),c;if(c===6)throw Error(t(345));return r.finishedWork=r.current.alternate,r.finishedLanes=s,cr(r,St,Sn),Lt(r,Xe()),null}function Kl(r,s){var c=_e;_e|=1;try{return r(s)}finally{_e=c,_e===0&&(Vr=Xe()+500,Fs&&$n())}}function lr(r){jn!==null&&jn.tag===0&&!(_e&6)&&Kr();var s=_e;_e|=1;var c=Mt.transition,h=Oe;try{if(Mt.transition=null,Oe=1,r)return r()}finally{Oe=h,Mt.transition=c,_e=s,!(_e&6)&&$n()}}function jl(){Pt=Hr.current,$e(Hr)}function ur(r,s){r.finishedWork=null,r.finishedLanes=0;var c=r.timeoutHandle;if(c!==-1&&(r.timeoutHandle=-1,P0(c)),Je!==null)for(c=Je.return;c!==null;){var h=c;switch(el(h),h.tag){case 1:h=h.type.childContextTypes,h!=null&&bs();break;case 3:Br(),$e(vt),$e(dt),hl();break;case 5:fl(h);break;case 4:Br();break;case 13:$e(je);break;case 19:$e(je);break;case 10:al(h.type._context);break;case 22:case 23:jl()}c=c.return}if(it=r,Je=r=Yn(r.current,null),ct=Pt=s,tt=0,Bi=null,Ul=na=or=0,St=$i=null,ir!==null){for(s=0;s<ir.length;s++)if(c=ir[s],h=c.interleaved,h!==null){c.interleaved=null;var g=h.next,E=c.pending;if(E!==null){var A=E.next;E.next=g,h.next=A}c.pending=h}ir=null}return r}function ch(r,s){do{var c=Je;try{if(sl(),js.current=qs,zs){for(var h=ze.memoizedState;h!==null;){var g=h.queue;g!==null&&(g.pending=null),h=h.next}zs=!1}if(ar=0,rt=et=ze=null,bi=!1,Oi=0,Ml.current=null,c===null||c.return===null){tt=1,Bi=s,Je=null;break}e:{var E=r,A=c.return,C=c,k=s;if(s=ct,C.flags|=32768,k!==null&&typeof k=="object"&&typeof k.then=="function"){var B=k,Z=C,te=Z.tag;if(!(Z.mode&1)&&(te===0||te===11||te===15)){var q=Z.alternate;q?(Z.updateQueue=q.updateQueue,Z.memoizedState=q.memoizedState,Z.lanes=q.lanes):(Z.updateQueue=null,Z.memoizedState=null)}var ie=Fd(A);if(ie!==null){ie.flags&=-257,Nd(ie,A,C,E,s),ie.mode&1&&Od(E,B,s),s=ie,k=B;var ue=s.updateQueue;if(ue===null){var ce=new Set;ce.add(k),s.updateQueue=ce}else ue.add(k);break e}else{if(!(s&1)){Od(E,B,s),zl();break e}k=Error(t(426))}}else if(He&&C.mode&1){var Qe=Fd(A);if(Qe!==null){!(Qe.flags&65536)&&(Qe.flags|=256),Nd(Qe,A,C,E,s),rl($r(k,C));break e}}E=k=$r(k,C),tt!==4&&(tt=2),$i===null?$i=[E]:$i.push(E),E=A;do{switch(E.tag){case 3:E.flags|=65536,s&=-s,E.lanes|=s;var F=Pd(E,k,s);sd(E,F);break e;case 1:C=k;var P=E.type,M=E.stateNode;if(!(E.flags&128)&&(typeof P.getDerivedStateFromError=="function"||M!==null&&typeof M.componentDidCatch=="function"&&(Kn===null||!Kn.has(M)))){E.flags|=65536,s&=-s,E.lanes|=s;var ne=bd(E,C,s);sd(E,ne);break e}}E=E.return}while(E!==null)}hh(c)}catch(fe){s=fe,Je===c&&c!==null&&(Je=c=c.return);continue}break}while(!0)}function fh(){var r=ta.current;return ta.current=qs,r===null?qs:r}function zl(){(tt===0||tt===3||tt===2)&&(tt=4),it===null||!(or&268435455)&&!(na&268435455)||Wn(it,ct)}function la(r,s){var c=_e;_e|=2;var h=fh();(it!==r||ct!==s)&&(Sn=null,ur(r,s));do try{ry();break}catch(g){ch(r,g)}while(!0);if(sl(),_e=c,ta.current=h,Je!==null)throw Error(t(261));return it=null,ct=0,tt}function ry(){for(;Je!==null;)dh(Je)}function iy(){for(;Je!==null&&!kg();)dh(Je)}function dh(r){var s=gh(r.alternate,r,Pt);r.memoizedProps=r.pendingProps,s===null?hh(r):Je=s,Ml.current=null}function hh(r){var s=r;do{var c=s.alternate;if(r=s.return,s.flags&32768){if(c=Q0(c,s),c!==null){c.flags&=32767,Je=c;return}if(r!==null)r.flags|=32768,r.subtreeFlags=0,r.deletions=null;else{tt=6,Je=null;return}}else if(c=X0(c,s,Pt),c!==null){Je=c;return}if(s=s.sibling,s!==null){Je=s;return}Je=s=r}while(s!==null);tt===0&&(tt=5)}function cr(r,s,c){var h=Oe,g=Mt.transition;try{Mt.transition=null,Oe=1,sy(r,s,c,h)}finally{Mt.transition=g,Oe=h}return null}function sy(r,s,c,h){do Kr();while(jn!==null);if(_e&6)throw Error(t(327));c=r.finishedWork;var g=r.finishedLanes;if(c===null)return null;if(r.finishedWork=null,r.finishedLanes=0,c===r.current)throw Error(t(177));r.callbackNode=null,r.callbackPriority=0;var E=c.lanes|c.childLanes;if(Bg(r,E),r===it&&(Je=it=null,ct=0),!(c.subtreeFlags&2064)&&!(c.flags&2064)||ia||(ia=!0,yh(ds,function(){return Kr(),null})),E=(c.flags&15990)!==0,c.subtreeFlags&15990||E){E=Mt.transition,Mt.transition=null;var A=Oe;Oe=1;var C=_e;_e|=4,Ml.current=null,Z0(r,c),rh(c,r),R0(zo),vs=!!jo,zo=jo=null,r.current=c,ey(c),Dg(),_e=C,Oe=A,Mt.transition=E}else r.current=c;if(ia&&(ia=!1,jn=r,sa=g),E=r.pendingLanes,E===0&&(Kn=null),bg(c.stateNode),Lt(r,Xe()),s!==null)for(h=r.onRecoverableError,c=0;c<s.length;c++)g=s[c],h(g.value,{componentStack:g.stack,digest:g.digest});if(ra)throw ra=!1,r=$l,$l=null,r;return sa&1&&r.tag!==0&&Kr(),E=r.pendingLanes,E&1?r===Gl?Gi++:(Gi=0,Gl=r):Gi=0,$n(),null}function Kr(){if(jn!==null){var r=ef(sa),s=Mt.transition,c=Oe;try{if(Mt.transition=null,Oe=16>r?16:r,jn===null)var h=!1;else{if(r=jn,jn=null,sa=0,_e&6)throw Error(t(331));var g=_e;for(_e|=4,ae=r.current;ae!==null;){var E=ae,A=E.child;if(ae.flags&16){var C=E.deletions;if(C!==null){for(var k=0;k<C.length;k++){var B=C[k];for(ae=B;ae!==null;){var Z=ae;switch(Z.tag){case 0:case 11:case 15:Ui(8,Z,E)}var te=Z.child;if(te!==null)te.return=Z,ae=te;else for(;ae!==null;){Z=ae;var q=Z.sibling,ie=Z.return;if(Jd(Z),Z===B){ae=null;break}if(q!==null){q.return=ie,ae=q;break}ae=ie}}}var ue=E.alternate;if(ue!==null){var ce=ue.child;if(ce!==null){ue.child=null;do{var Qe=ce.sibling;ce.sibling=null,ce=Qe}while(ce!==null)}}ae=E}}if(E.subtreeFlags&2064&&A!==null)A.return=E,ae=A;else e:for(;ae!==null;){if(E=ae,E.flags&2048)switch(E.tag){case 0:case 11:case 15:Ui(9,E,E.return)}var F=E.sibling;if(F!==null){F.return=E.return,ae=F;break e}ae=E.return}}var P=r.current;for(ae=P;ae!==null;){A=ae;var M=A.child;if(A.subtreeFlags&2064&&M!==null)M.return=A,ae=M;else e:for(A=P;ae!==null;){if(C=ae,C.flags&2048)try{switch(C.tag){case 0:case 11:case 15:ea(9,C)}}catch(fe){qe(C,C.return,fe)}if(C===A){ae=null;break e}var ne=C.sibling;if(ne!==null){ne.return=C.return,ae=ne;break e}ae=C.return}}if(_e=g,$n(),Zt&&typeof Zt.onPostCommitFiberRoot=="function")try{Zt.onPostCommitFiberRoot(hs,r)}catch{}h=!0}return h}finally{Oe=c,Mt.transition=s}}return!1}function ph(r,s,c){s=$r(c,s),s=Pd(r,s,1),r=Hn(r,s,1),s=Et(),r!==null&&(fi(r,1,s),Lt(r,s))}function qe(r,s,c){if(r.tag===3)ph(r,r,c);else for(;s!==null;){if(s.tag===3){ph(s,r,c);break}else if(s.tag===1){var h=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(Kn===null||!Kn.has(h))){r=$r(c,r),r=bd(s,r,1),s=Hn(s,r,1),r=Et(),s!==null&&(fi(s,1,r),Lt(s,r));break}}s=s.return}}function ay(r,s,c){var h=r.pingCache;h!==null&&h.delete(s),s=Et(),r.pingedLanes|=r.suspendedLanes&c,it===r&&(ct&c)===c&&(tt===4||tt===3&&(ct&130023424)===ct&&500>Xe()-Bl?ur(r,0):Ul|=c),Lt(r,s)}function mh(r,s){s===0&&(r.mode&1?(s=ms,ms<<=1,!(ms&130023424)&&(ms=4194304)):s=1);var c=Et();r=vn(r,s),r!==null&&(fi(r,s,c),Lt(r,c))}function oy(r){var s=r.memoizedState,c=0;s!==null&&(c=s.retryLane),mh(r,c)}function ly(r,s){var c=0;switch(r.tag){case 13:var h=r.stateNode,g=r.memoizedState;g!==null&&(c=g.retryLane);break;case 19:h=r.stateNode;break;default:throw Error(t(314))}h!==null&&h.delete(s),mh(r,c)}var gh;gh=function(r,s,c){if(r!==null)if(r.memoizedProps!==s.pendingProps||vt.current)xt=!0;else{if(!(r.lanes&c)&&!(s.flags&128))return xt=!1,q0(r,s,c);xt=!!(r.flags&131072)}else xt=!1,He&&s.flags&1048576&&qf(s,Ms,s.index);switch(s.lanes=0,s.tag){case 2:var h=s.type;Js(r,s),r=s.pendingProps;var g=Pr(s,dt.current);Ur(s,c),g=gl(null,s,h,r,g,c);var E=yl();return s.flags|=1,typeof g=="object"&&g!==null&&typeof g.render=="function"&&g.$$typeof===void 0?(s.tag=1,s.memoizedState=null,s.updateQueue=null,Tt(h)?(E=!0,Os(s)):E=!1,s.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,ul(s),g.updater=Xs,s.stateNode=g,g._reactInternals=s,Ll(s,h,r,c),s=Cl(null,s,h,!0,E,c)):(s.tag=0,He&&E&&Zo(s),yt(null,s,g,c),s=s.child),s;case 16:h=s.elementType;e:{switch(Js(r,s),r=s.pendingProps,g=h._init,h=g(h._payload),s.type=h,g=s.tag=cy(h),r=jt(h,r),g){case 0:s=wl(null,s,h,r,c);break e;case 1:s=Hd(null,s,h,r,c);break e;case 11:s=Md(null,s,h,r,c);break e;case 14:s=Ud(null,s,h,jt(h.type,r),c);break e}throw Error(t(306,h,""))}return s;case 0:return h=s.type,g=s.pendingProps,g=s.elementType===h?g:jt(h,g),wl(r,s,h,g,c);case 1:return h=s.type,g=s.pendingProps,g=s.elementType===h?g:jt(h,g),Hd(r,s,h,g,c);case 3:e:{if(Vd(s),r===null)throw Error(t(387));h=s.pendingProps,E=s.memoizedState,g=E.element,id(r,s),Vs(s,h,null,c);var A=s.memoizedState;if(h=A.element,E.isDehydrated)if(E={element:h,isDehydrated:!1,cache:A.cache,pendingSuspenseBoundaries:A.pendingSuspenseBoundaries,transitions:A.transitions},s.updateQueue.baseState=E,s.memoizedState=E,s.flags&256){g=$r(Error(t(423)),s),s=Kd(r,s,h,c,g);break e}else if(h!==g){g=$r(Error(t(424)),s),s=Kd(r,s,h,c,g);break e}else for(_t=Mn(s.stateNode.containerInfo.firstChild),Dt=s,He=!0,Kt=null,c=nd(s,null,h,c),s.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(Fr(),h===g){s=xn(r,s,c);break e}yt(r,s,h,c)}s=s.child}return s;case 5:return od(s),r===null&&nl(s),h=s.type,g=s.pendingProps,E=r!==null?r.memoizedProps:null,A=g.children,Wo(h,g)?A=null:E!==null&&Wo(h,E)&&(s.flags|=32),Gd(r,s),yt(r,s,A,c),s.child;case 6:return r===null&&nl(s),null;case 13:return jd(r,s,c);case 4:return cl(s,s.stateNode.containerInfo),h=s.pendingProps,r===null?s.child=Nr(s,null,h,c):yt(r,s,h,c),s.child;case 11:return h=s.type,g=s.pendingProps,g=s.elementType===h?g:jt(h,g),Md(r,s,h,g,c);case 7:return yt(r,s,s.pendingProps,c),s.child;case 8:return yt(r,s,s.pendingProps.children,c),s.child;case 12:return yt(r,s,s.pendingProps.children,c),s.child;case 10:e:{if(h=s.type._context,g=s.pendingProps,E=s.memoizedProps,A=g.value,Me($s,h._currentValue),h._currentValue=A,E!==null)if(Vt(E.value,A)){if(E.children===g.children&&!vt.current){s=xn(r,s,c);break e}}else for(E=s.child,E!==null&&(E.return=s);E!==null;){var C=E.dependencies;if(C!==null){A=E.child;for(var k=C.firstContext;k!==null;){if(k.context===h){if(E.tag===1){k=Tn(-1,c&-c),k.tag=2;var B=E.updateQueue;if(B!==null){B=B.shared;var Z=B.pending;Z===null?k.next=k:(k.next=Z.next,Z.next=k),B.pending=k}}E.lanes|=c,k=E.alternate,k!==null&&(k.lanes|=c),ol(E.return,c,s),C.lanes|=c;break}k=k.next}}else if(E.tag===10)A=E.type===s.type?null:E.child;else if(E.tag===18){if(A=E.return,A===null)throw Error(t(341));A.lanes|=c,C=A.alternate,C!==null&&(C.lanes|=c),ol(A,c,s),A=E.sibling}else A=E.child;if(A!==null)A.return=E;else for(A=E;A!==null;){if(A===s){A=null;break}if(E=A.sibling,E!==null){E.return=A.return,A=E;break}A=A.return}E=A}yt(r,s,g.children,c),s=s.child}return s;case 9:return g=s.type,h=s.pendingProps.children,Ur(s,c),g=Ft(g),h=h(g),s.flags|=1,yt(r,s,h,c),s.child;case 14:return h=s.type,g=jt(h,s.pendingProps),g=jt(h.type,g),Ud(r,s,h,g,c);case 15:return Bd(r,s,s.type,s.pendingProps,c);case 17:return h=s.type,g=s.pendingProps,g=s.elementType===h?g:jt(h,g),Js(r,s),s.tag=1,Tt(h)?(r=!0,Os(s)):r=!1,Ur(s,c),Dd(s,h,g),Ll(s,h,g,c),Cl(null,s,h,!0,r,c);case 19:return Wd(r,s,c);case 22:return $d(r,s,c)}throw Error(t(156,s.tag))};function yh(r,s){return qc(r,s)}function uy(r,s,c,h){this.tag=r,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ut(r,s,c,h){return new uy(r,s,c,h)}function Wl(r){return r=r.prototype,!(!r||!r.isReactComponent)}function cy(r){if(typeof r=="function")return Wl(r)?1:0;if(r!=null){if(r=r.$$typeof,r===ge)return 11;if(r===pe)return 14}return 2}function Yn(r,s){var c=r.alternate;return c===null?(c=Ut(r.tag,s,r.key,r.mode),c.elementType=r.elementType,c.type=r.type,c.stateNode=r.stateNode,c.alternate=r,r.alternate=c):(c.pendingProps=s,c.type=r.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=r.flags&14680064,c.childLanes=r.childLanes,c.lanes=r.lanes,c.child=r.child,c.memoizedProps=r.memoizedProps,c.memoizedState=r.memoizedState,c.updateQueue=r.updateQueue,s=r.dependencies,c.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},c.sibling=r.sibling,c.index=r.index,c.ref=r.ref,c}function ua(r,s,c,h,g,E){var A=2;if(h=r,typeof r=="function")Wl(r)&&(A=1);else if(typeof r=="string")A=5;else e:switch(r){case U:return fr(c.children,g,E,s);case z:A=8,g|=8;break;case ee:return r=Ut(12,c,s,g|2),r.elementType=ee,r.lanes=E,r;case re:return r=Ut(13,c,s,g),r.elementType=re,r.lanes=E,r;case he:return r=Ut(19,c,s,g),r.elementType=he,r.lanes=E,r;case me:return ca(c,g,E,s);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case V:A=10;break e;case Q:A=9;break e;case ge:A=11;break e;case pe:A=14;break e;case le:A=16,h=null;break e}throw Error(t(130,r==null?r:typeof r,""))}return s=Ut(A,c,s,g),s.elementType=r,s.type=h,s.lanes=E,s}function fr(r,s,c,h){return r=Ut(7,r,h,s),r.lanes=c,r}function ca(r,s,c,h){return r=Ut(22,r,h,s),r.elementType=me,r.lanes=c,r.stateNode={isHidden:!1},r}function Yl(r,s,c){return r=Ut(6,r,null,s),r.lanes=c,r}function ql(r,s,c){return s=Ut(4,r.children!==null?r.children:[],r.key,s),s.lanes=c,s.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},s}function fy(r,s,c,h,g){this.tag=s,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=So(0),this.expirationTimes=So(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=So(0),this.identifierPrefix=h,this.onRecoverableError=g,this.mutableSourceEagerHydrationData=null}function Xl(r,s,c,h,g,E,A,C,k){return r=new fy(r,s,c,C,k),s===1?(s=1,E===!0&&(s|=8)):s=0,E=Ut(3,null,null,s),r.current=E,E.stateNode=r,E.memoizedState={element:h,isDehydrated:c,cache:null,transitions:null,pendingSuspenseBoundaries:null},ul(E),r}function dy(r,s,c){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:K,key:h==null?null:""+h,children:r,containerInfo:s,implementation:c}}function Eh(r){if(!r)return Bn;r=r._reactInternals;e:{if(Zn(r)!==r||r.tag!==1)throw Error(t(170));var s=r;do{switch(s.tag){case 3:s=s.stateNode.context;break e;case 1:if(Tt(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break e}}s=s.return}while(s!==null);throw Error(t(171))}if(r.tag===1){var c=r.type;if(Tt(c))return zf(r,c,s)}return s}function vh(r,s,c,h,g,E,A,C,k){return r=Xl(c,h,!0,r,g,E,A,C,k),r.context=Eh(null),c=r.current,h=Et(),g=zn(c),E=Tn(h,g),E.callback=s??null,Hn(c,E,g),r.current.lanes=g,fi(r,g,h),Lt(r,h),r}function fa(r,s,c,h){var g=s.current,E=Et(),A=zn(g);return c=Eh(c),s.context===null?s.context=c:s.pendingContext=c,s=Tn(E,A),s.payload={element:r},h=h===void 0?null:h,h!==null&&(s.callback=h),r=Hn(g,s,A),r!==null&&(Yt(r,g,A,E),Hs(r,g,A)),A}function da(r){if(r=r.current,!r.child)return null;switch(r.child.tag){case 5:return r.child.stateNode;default:return r.child.stateNode}}function Th(r,s){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var c=r.retryLane;r.retryLane=c!==0&&c<s?c:s}}function Ql(r,s){Th(r,s),(r=r.alternate)&&Th(r,s)}var xh=typeof reportError=="function"?reportError:function(r){console.error(r)};function Jl(r){this._internalRoot=r}ha.prototype.render=Jl.prototype.render=function(r){var s=this._internalRoot;if(s===null)throw Error(t(409));fa(r,s,null,null)},ha.prototype.unmount=Jl.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var s=r.containerInfo;lr(function(){fa(null,r,null,null)}),s[mn]=null}};function ha(r){this._internalRoot=r}ha.prototype.unstable_scheduleHydration=function(r){if(r){var s=rf();r={blockedOn:null,target:r,priority:s};for(var c=0;c<On.length&&s!==0&&s<On[c].priority;c++);On.splice(c,0,r),c===0&&of(r)}};function Zl(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function pa(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11&&(r.nodeType!==8||r.nodeValue!==" react-mount-point-unstable "))}function Sh(){}function hy(r,s,c,h,g){if(g){if(typeof h=="function"){var E=h;h=function(){var B=da(A);E.call(B)}}var A=vh(s,h,r,0,null,!1,!1,"",Sh);return r._reactRootContainer=A,r[mn]=A.current,Ri(r.nodeType===8?r.parentNode:r),lr(),A}for(;g=r.lastChild;)r.removeChild(g);if(typeof h=="function"){var C=h;h=function(){var B=da(k);C.call(B)}}var k=Xl(r,0,!1,null,null,!1,!1,"",Sh);return r._reactRootContainer=k,r[mn]=k.current,Ri(r.nodeType===8?r.parentNode:r),lr(function(){fa(s,k,c,h)}),k}function ma(r,s,c,h,g){var E=c._reactRootContainer;if(E){var A=E;if(typeof g=="function"){var C=g;g=function(){var k=da(A);C.call(k)}}fa(s,A,r,g)}else A=hy(c,s,r,g,h);return da(A)}tf=function(r){switch(r.tag){case 3:var s=r.stateNode;if(s.current.memoizedState.isDehydrated){var c=ci(s.pendingLanes);c!==0&&(Lo(s,c|1),Lt(s,Xe()),!(_e&6)&&(Vr=Xe()+500,$n()))}break;case 13:lr(function(){var h=vn(r,1);if(h!==null){var g=Et();Yt(h,r,1,g)}}),Ql(r,1)}},Ao=function(r){if(r.tag===13){var s=vn(r,134217728);if(s!==null){var c=Et();Yt(s,r,134217728,c)}Ql(r,134217728)}},nf=function(r){if(r.tag===13){var s=zn(r),c=vn(r,s);if(c!==null){var h=Et();Yt(c,r,s,h)}Ql(r,s)}},rf=function(){return Oe},sf=function(r,s){var c=Oe;try{return Oe=r,s()}finally{Oe=c}},go=function(r,s,c){switch(s){case"input":if(oo(r,c),s=c.name,c.type==="radio"&&s!=null){for(c=r;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll("input[name="+JSON.stringify(""+s)+'][type="radio"]'),s=0;s<c.length;s++){var h=c[s];if(h!==r&&h.form===r.form){var g=Ps(h);if(!g)throw Error(t(90));Ic(h),oo(h,g)}}}break;case"textarea":bc(r,c);break;case"select":s=c.value,s!=null&&Tr(r,!!c.multiple,s,!1)}},Hc=Kl,Vc=lr;var py={usingClientEntryPoint:!1,Events:[Ii,Dr,Ps,$c,Gc,Kl]},Hi={findFiberByHostInstance:er,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},my={bundleType:Hi.bundleType,version:Hi.version,rendererPackageName:Hi.rendererPackageName,rendererConfig:Hi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(r){return r=Wc(r),r===null?null:r.stateNode},findFiberByHostInstance:Hi.findFiberByHostInstance,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ga=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ga.isDisabled&&ga.supportsFiber)try{hs=ga.inject(my),Zt=ga}catch{}}return At.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=py,At.createPortal=function(r,s){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Zl(s))throw Error(t(200));return dy(r,s,null,c)},At.createRoot=function(r,s){if(!Zl(r))throw Error(t(299));var c=!1,h="",g=xh;return s!=null&&(s.unstable_strictMode===!0&&(c=!0),s.identifierPrefix!==void 0&&(h=s.identifierPrefix),s.onRecoverableError!==void 0&&(g=s.onRecoverableError)),s=Xl(r,1,!1,null,null,c,!1,h,g),r[mn]=s.current,Ri(r.nodeType===8?r.parentNode:r),new Jl(s)},At.findDOMNode=function(r){if(r==null)return null;if(r.nodeType===1)return r;var s=r._reactInternals;if(s===void 0)throw typeof r.render=="function"?Error(t(188)):(r=Object.keys(r).join(","),Error(t(268,r)));return r=Wc(s),r=r===null?null:r.stateNode,r},At.flushSync=function(r){return lr(r)},At.hydrate=function(r,s,c){if(!pa(s))throw Error(t(200));return ma(null,r,s,!0,c)},At.hydrateRoot=function(r,s,c){if(!Zl(r))throw Error(t(405));var h=c!=null&&c.hydratedSources||null,g=!1,E="",A=xh;if(c!=null&&(c.unstable_strictMode===!0&&(g=!0),c.identifierPrefix!==void 0&&(E=c.identifierPrefix),c.onRecoverableError!==void 0&&(A=c.onRecoverableError)),s=vh(s,null,r,1,c??null,g,!1,E,A),r[mn]=s.current,Ri(r),h)for(r=0;r<h.length;r++)c=h[r],g=c._getVersion,g=g(c._source),s.mutableSourceEagerHydrationData==null?s.mutableSourceEagerHydrationData=[c,g]:s.mutableSourceEagerHydrationData.push(c,g);return new ha(s)},At.render=function(r,s,c){if(!pa(s))throw Error(t(200));return ma(null,r,s,!1,c)},At.unmountComponentAtNode=function(r){if(!pa(r))throw Error(t(40));return r._reactRootContainer?(lr(function(){ma(null,null,r,!1,function(){r._reactRootContainer=null,r[mn]=null})}),!0):!1},At.unstable_batchedUpdates=Kl,At.unstable_renderSubtreeIntoContainer=function(r,s,c,h){if(!pa(c))throw Error(t(200));if(r==null||r._reactInternals===void 0)throw Error(t(38));return ma(r,s,c,!1,h)},At.version="18.3.1-next-f1338f8080-20240426",At}var Dh;function Ly(){if(Dh)return nu.exports;Dh=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(e){console.error(e)}}return o(),nu.exports=Sy(),nu.exports}var _h;function Ay(){if(_h)return ya;_h=1;var o=Ly();return ya.createRoot=o.createRoot,ya.hydrateRoot=o.hydrateRoot,ya}var Ry=Ay(),Ki={},Ph;function wy(){if(Ph)return Ki;Ph=1,Object.defineProperty(Ki,"__esModule",{value:!0}),Ki.parse=l,Ki.serialize=d;const o=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,n=/^[\u0020-\u003A\u003D-\u007E]*$/,i=Object.prototype.toString,a=(()=>{const y=function(){};return y.prototype=Object.create(null),y})();function l(y,T){const v=new a,x=y.length;if(x<2)return v;const S=(T==null?void 0:T.decode)||p;let R=0;do{const I=y.indexOf("=",R);if(I===-1)break;const w=y.indexOf(";",R),b=w===-1?x:w;if(I>b){R=y.lastIndexOf(";",I-1)+1;continue}const _=u(y,R,I),K=f(y,I,_),U=y.slice(_,K);if(v[U]===void 0){let z=u(y,I+1,b),ee=f(y,b,z);const V=S(y.slice(z,ee));v[U]=V}R=b+1}while(R<x);return v}function u(y,T,v){do{const x=y.charCodeAt(T);if(x!==32&&x!==9)return T}while(++T<v);return v}function f(y,T,v){for(;T>v;){const x=y.charCodeAt(--T);if(x!==32&&x!==9)return T+1}return v}function d(y,T,v){const x=(v==null?void 0:v.encode)||encodeURIComponent;if(!o.test(y))throw new TypeError(`argument name is invalid: ${y}`);const S=x(T);if(!e.test(S))throw new TypeError(`argument val is invalid: ${T}`);let R=y+"="+S;if(!v)return R;if(v.maxAge!==void 0){if(!Number.isInteger(v.maxAge))throw new TypeError(`option maxAge is invalid: ${v.maxAge}`);R+="; Max-Age="+v.maxAge}if(v.domain){if(!t.test(v.domain))throw new TypeError(`option domain is invalid: ${v.domain}`);R+="; Domain="+v.domain}if(v.path){if(!n.test(v.path))throw new TypeError(`option path is invalid: ${v.path}`);R+="; Path="+v.path}if(v.expires){if(!m(v.expires)||!Number.isFinite(v.expires.valueOf()))throw new TypeError(`option expires is invalid: ${v.expires}`);R+="; Expires="+v.expires.toUTCString()}if(v.httpOnly&&(R+="; HttpOnly"),v.secure&&(R+="; Secure"),v.partitioned&&(R+="; Partitioned"),v.priority)switch(typeof v.priority=="string"?v.priority.toLowerCase():void 0){case"low":R+="; Priority=Low";break;case"medium":R+="; Priority=Medium";break;case"high":R+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${v.priority}`)}if(v.sameSite)switch(typeof v.sameSite=="string"?v.sameSite.toLowerCase():v.sameSite){case!0:case"strict":R+="; SameSite=Strict";break;case"lax":R+="; SameSite=Lax";break;case"none":R+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${v.sameSite}`)}return R}function p(y){if(y.indexOf("%")===-1)return y;try{return decodeURIComponent(y)}catch{return y}}function m(y){return i.call(y)==="[object Date]"}return Ki}wy();/**
 * react-router v7.1.5
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var bh="popstate";function Cy(o={}){function e(n,i){let{pathname:a,search:l,hash:u}=n.location;return Mu("",{pathname:a,search:l,hash:u},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function t(n,i){return typeof i=="string"?i:Qi(i)}return ky(e,t,null,o)}function Ye(o,e){if(o===!1||o===null||typeof o>"u")throw new Error(e)}function dn(o,e){if(!o){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Iy(){return Math.random().toString(36).substring(2,10)}function Oh(o,e){return{usr:o.state,key:o.key,idx:e}}function Mu(o,e,t=null,n){return{pathname:typeof o=="string"?o:o.pathname,search:"",hash:"",...typeof e=="string"?ni(e):e,state:t,key:e&&e.key||n||Iy()}}function Qi({pathname:o="/",search:e="",hash:t=""}){return e&&e!=="?"&&(o+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(o+=t.charAt(0)==="#"?t:"#"+t),o}function ni(o){let e={};if(o){let t=o.indexOf("#");t>=0&&(e.hash=o.substring(t),o=o.substring(0,t));let n=o.indexOf("?");n>=0&&(e.search=o.substring(n),o=o.substring(0,n)),o&&(e.pathname=o)}return e}function ky(o,e,t,n={}){let{window:i=document.defaultView,v5Compat:a=!1}=n,l=i.history,u="POP",f=null,d=p();d==null&&(d=0,l.replaceState({...l.state,idx:d},""));function p(){return(l.state||{idx:null}).idx}function m(){u="POP";let S=p(),R=S==null?null:S-d;d=S,f&&f({action:u,location:x.location,delta:R})}function y(S,R){u="PUSH";let I=Mu(x.location,S,R);d=p()+1;let w=Oh(I,d),b=x.createHref(I);try{l.pushState(w,"",b)}catch(_){if(_ instanceof DOMException&&_.name==="DataCloneError")throw _;i.location.assign(b)}a&&f&&f({action:u,location:x.location,delta:1})}function T(S,R){u="REPLACE";let I=Mu(x.location,S,R);d=p();let w=Oh(I,d),b=x.createHref(I);l.replaceState(w,"",b),a&&f&&f({action:u,location:x.location,delta:0})}function v(S){let R=i.location.origin!=="null"?i.location.origin:i.location.href,I=typeof S=="string"?S:Qi(S);return I=I.replace(/ $/,"%20"),Ye(R,`No window.location.(origin|href) available to create URL for href: ${I}`),new URL(I,R)}let x={get action(){return u},get location(){return o(i,l)},listen(S){if(f)throw new Error("A history only accepts one active listener");return i.addEventListener(bh,m),f=S,()=>{i.removeEventListener(bh,m),f=null}},createHref(S){return e(i,S)},createURL:v,encodeLocation(S){let R=v(S);return{pathname:R.pathname,search:R.search,hash:R.hash}},push:y,replace:T,go(S){return l.go(S)}};return x}function Wp(o,e,t="/"){return Dy(o,e,t,!1)}function Dy(o,e,t,n){let i=typeof e=="string"?ni(e):e,a=Jn(i.pathname||"/",t);if(a==null)return null;let l=Yp(o);_y(l);let u=null;for(let f=0;u==null&&f<l.length;++f){let d=Hy(a);u=$y(l[f],d,n)}return u}function Yp(o,e=[],t=[],n=""){let i=(a,l,u)=>{let f={relativePath:u===void 0?a.path||"":u,caseSensitive:a.caseSensitive===!0,childrenIndex:l,route:a};f.relativePath.startsWith("/")&&(Ye(f.relativePath.startsWith(n),`Absolute route path "${f.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),f.relativePath=f.relativePath.slice(n.length));let d=In([n,f.relativePath]),p=t.concat(f);a.children&&a.children.length>0&&(Ye(a.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${d}".`),Yp(a.children,e,p,d)),!(a.path==null&&!a.index)&&e.push({path:d,score:Uy(d,a.index),routesMeta:p})};return o.forEach((a,l)=>{var u;if(a.path===""||!((u=a.path)!=null&&u.includes("?")))i(a,l);else for(let f of qp(a.path))i(a,l,f)}),e}function qp(o){let e=o.split("/");if(e.length===0)return[];let[t,...n]=e,i=t.endsWith("?"),a=t.replace(/\?$/,"");if(n.length===0)return i?[a,""]:[a];let l=qp(n.join("/")),u=[];return u.push(...l.map(f=>f===""?a:[a,f].join("/"))),i&&u.push(...l),u.map(f=>o.startsWith("/")&&f===""?"/":f)}function _y(o){o.sort((e,t)=>e.score!==t.score?t.score-e.score:By(e.routesMeta.map(n=>n.childrenIndex),t.routesMeta.map(n=>n.childrenIndex)))}var Py=/^:[\w-]+$/,by=3,Oy=2,Fy=1,Ny=10,My=-2,Fh=o=>o==="*";function Uy(o,e){let t=o.split("/"),n=t.length;return t.some(Fh)&&(n+=My),e&&(n+=Oy),t.filter(i=>!Fh(i)).reduce((i,a)=>i+(Py.test(a)?by:a===""?Fy:Ny),n)}function By(o,e){return o.length===e.length&&o.slice(0,-1).every((n,i)=>n===e[i])?o[o.length-1]-e[e.length-1]:0}function $y(o,e,t=!1){let{routesMeta:n}=o,i={},a="/",l=[];for(let u=0;u<n.length;++u){let f=n[u],d=u===n.length-1,p=a==="/"?e:e.slice(a.length)||"/",m=Ha({path:f.relativePath,caseSensitive:f.caseSensitive,end:d},p),y=f.route;if(!m&&d&&t&&!n[n.length-1].route.index&&(m=Ha({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},p)),!m)return null;Object.assign(i,m.params),l.push({params:i,pathname:In([a,m.pathname]),pathnameBase:zy(In([a,m.pathnameBase])),route:y}),m.pathnameBase!=="/"&&(a=In([a,m.pathnameBase]))}return l}function Ha(o,e){typeof o=="string"&&(o={path:o,caseSensitive:!1,end:!0});let[t,n]=Gy(o.path,o.caseSensitive,o.end),i=e.match(t);if(!i)return null;let a=i[0],l=a.replace(/(.)\/+$/,"$1"),u=i.slice(1);return{params:n.reduce((d,{paramName:p,isOptional:m},y)=>{if(p==="*"){let v=u[y]||"";l=a.slice(0,a.length-v.length).replace(/(.)\/+$/,"$1")}const T=u[y];return m&&!T?d[p]=void 0:d[p]=(T||"").replace(/%2F/g,"/"),d},{}),pathname:a,pathnameBase:l,pattern:o}}function Gy(o,e=!1,t=!0){dn(o==="*"||!o.endsWith("*")||o.endsWith("/*"),`Route path "${o}" will be treated as if it were "${o.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${o.replace(/\*$/,"/*")}".`);let n=[],i="^"+o.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,u,f)=>(n.push({paramName:u,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)"));return o.endsWith("*")?(n.push({paramName:"*"}),i+=o==="*"||o==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":o!==""&&o!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function Hy(o){try{return o.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return dn(!1,`The URL path "${o}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),o}}function Jn(o,e){if(e==="/")return o;if(!o.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,n=o.charAt(t);return n&&n!=="/"?null:o.slice(t)||"/"}function Vy(o,e="/"){let{pathname:t,search:n="",hash:i=""}=typeof o=="string"?ni(o):o;return{pathname:t?t.startsWith("/")?t:Ky(t,e):e,search:Wy(n),hash:Yy(i)}}function Ky(o,e){let t=e.replace(/\/+$/,"").split("/");return o.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function su(o,e,t,n){return`Cannot include a '${o}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function jy(o){return o.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Xp(o){let e=jy(o);return e.map((t,n)=>n===e.length-1?t.pathname:t.pathnameBase)}function Qp(o,e,t,n=!1){let i;typeof o=="string"?i=ni(o):(i={...o},Ye(!i.pathname||!i.pathname.includes("?"),su("?","pathname","search",i)),Ye(!i.pathname||!i.pathname.includes("#"),su("#","pathname","hash",i)),Ye(!i.search||!i.search.includes("#"),su("#","search","hash",i)));let a=o===""||i.pathname==="",l=a?"/":i.pathname,u;if(l==null)u=t;else{let m=e.length-1;if(!n&&l.startsWith("..")){let y=l.split("/");for(;y[0]==="..";)y.shift(),m-=1;i.pathname=y.join("/")}u=m>=0?e[m]:"/"}let f=Vy(i,u),d=l&&l!=="/"&&l.endsWith("/"),p=(a||l===".")&&t.endsWith("/");return!f.pathname.endsWith("/")&&(d||p)&&(f.pathname+="/"),f}var In=o=>o.join("/").replace(/\/\/+/g,"/"),zy=o=>o.replace(/\/+$/,"").replace(/^\/*/,"/"),Wy=o=>!o||o==="?"?"":o.startsWith("?")?o:"?"+o,Yy=o=>!o||o==="#"?"":o.startsWith("#")?o:"#"+o;function qy(o){return o!=null&&typeof o.status=="number"&&typeof o.statusText=="string"&&typeof o.internal=="boolean"&&"data"in o}var Jp=["POST","PUT","PATCH","DELETE"];new Set(Jp);var Xy=["GET",...Jp];new Set(Xy);var ri=j.createContext(null);ri.displayName="DataRouter";var no=j.createContext(null);no.displayName="DataRouterState";var Zp=j.createContext({isTransitioning:!1});Zp.displayName="ViewTransition";var Qy=j.createContext(new Map);Qy.displayName="Fetchers";var Jy=j.createContext(null);Jy.displayName="Await";var pn=j.createContext(null);pn.displayName="Navigation";var is=j.createContext(null);is.displayName="Location";var kn=j.createContext({outlet:null,matches:[],isDataRoute:!1});kn.displayName="Route";var sc=j.createContext(null);sc.displayName="RouteError";function Zy(o,{relative:e}={}){Ye(ss(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:n}=j.useContext(pn),{hash:i,pathname:a,search:l}=as(o,{relative:e}),u=a;return t!=="/"&&(u=a==="/"?t:In([t,a])),n.createHref({pathname:u,search:l,hash:i})}function ss(){return j.useContext(is)!=null}function Dn(){return Ye(ss(),"useLocation() may be used only in the context of a <Router> component."),j.useContext(is).location}var em="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function tm(o){j.useContext(pn).static||j.useLayoutEffect(o)}function nm(){let{isDataRoute:o}=j.useContext(kn);return o?dE():eE()}function eE(){Ye(ss(),"useNavigate() may be used only in the context of a <Router> component.");let o=j.useContext(ri),{basename:e,navigator:t}=j.useContext(pn),{matches:n}=j.useContext(kn),{pathname:i}=Dn(),a=JSON.stringify(Xp(n)),l=j.useRef(!1);return tm(()=>{l.current=!0}),j.useCallback((f,d={})=>{if(dn(l.current,em),!l.current)return;if(typeof f=="number"){t.go(f);return}let p=Qp(f,JSON.parse(a),i,d.relative==="path");o==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:In([e,p.pathname])),(d.replace?t.replace:t.push)(p,d.state,d)},[e,t,a,i,o])}j.createContext(null);function as(o,{relative:e}={}){let{matches:t}=j.useContext(kn),{pathname:n}=Dn(),i=JSON.stringify(Xp(t));return j.useMemo(()=>Qp(o,JSON.parse(i),n,e==="path"),[o,i,n,e])}function tE(o,e){return rm(o,e)}function rm(o,e,t,n){var I;Ye(ss(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i,static:a}=j.useContext(pn),{matches:l}=j.useContext(kn),u=l[l.length-1],f=u?u.params:{},d=u?u.pathname:"/",p=u?u.pathnameBase:"/",m=u&&u.route;{let w=m&&m.path||"";im(d,!m||w.endsWith("*")||w.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${w}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${w}"> to <Route path="${w==="/"?"*":`${w}/*`}">.`)}let y=Dn(),T;if(e){let w=typeof e=="string"?ni(e):e;Ye(p==="/"||((I=w.pathname)==null?void 0:I.startsWith(p)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${w.pathname}" was given in the \`location\` prop.`),T=w}else T=y;let v=T.pathname||"/",x=v;if(p!=="/"){let w=p.replace(/^\//,"").split("/");x="/"+v.replace(/^\//,"").split("/").slice(w.length).join("/")}let S=!a&&t&&t.matches&&t.matches.length>0?t.matches:Wp(o,{pathname:x});dn(m||S!=null,`No routes matched location "${T.pathname}${T.search}${T.hash}" `),dn(S==null||S[S.length-1].route.element!==void 0||S[S.length-1].route.Component!==void 0||S[S.length-1].route.lazy!==void 0,`Matched leaf route at location "${T.pathname}${T.search}${T.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let R=aE(S&&S.map(w=>Object.assign({},w,{params:Object.assign({},f,w.params),pathname:In([p,i.encodeLocation?i.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?p:In([p,i.encodeLocation?i.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),l,t,n);return e&&R?j.createElement(is.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...T},navigationType:"POP"}},R):R}function nE(){let o=fE(),e=qy(o)?`${o.status} ${o.statusText}`:o instanceof Error?o.message:JSON.stringify(o),t=o instanceof Error?o.stack:null,n="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:n},a={padding:"2px 4px",backgroundColor:n},l=null;return console.error("Error handled by React Router default ErrorBoundary:",o),l=j.createElement(j.Fragment,null,j.createElement("p",null," Hey developer "),j.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",j.createElement("code",{style:a},"ErrorBoundary")," or"," ",j.createElement("code",{style:a},"errorElement")," prop on your route.")),j.createElement(j.Fragment,null,j.createElement("h2",null,"Unexpected Application Error!"),j.createElement("h3",{style:{fontStyle:"italic"}},e),t?j.createElement("pre",{style:i},t):null,l)}var rE=j.createElement(nE,null),iE=class extends j.Component{constructor(o){super(o),this.state={location:o.location,revalidation:o.revalidation,error:o.error}}static getDerivedStateFromError(o){return{error:o}}static getDerivedStateFromProps(o,e){return e.location!==o.location||e.revalidation!=="idle"&&o.revalidation==="idle"?{error:o.error,location:o.location,revalidation:o.revalidation}:{error:o.error!==void 0?o.error:e.error,location:e.location,revalidation:o.revalidation||e.revalidation}}componentDidCatch(o,e){console.error("React Router caught the following error during render",o,e)}render(){return this.state.error!==void 0?j.createElement(kn.Provider,{value:this.props.routeContext},j.createElement(sc.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function sE({routeContext:o,match:e,children:t}){let n=j.useContext(ri);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),j.createElement(kn.Provider,{value:o},t)}function aE(o,e=[],t=null,n=null){if(o==null){if(!t)return null;if(t.errors)o=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)o=t.matches;else return null}let i=o,a=t==null?void 0:t.errors;if(a!=null){let f=i.findIndex(d=>d.route.id&&(a==null?void 0:a[d.route.id])!==void 0);Ye(f>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(a).join(",")}`),i=i.slice(0,Math.min(i.length,f+1))}let l=!1,u=-1;if(t)for(let f=0;f<i.length;f++){let d=i[f];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(u=f),d.route.id){let{loaderData:p,errors:m}=t,y=d.route.loader&&!p.hasOwnProperty(d.route.id)&&(!m||m[d.route.id]===void 0);if(d.route.lazy||y){l=!0,u>=0?i=i.slice(0,u+1):i=[i[0]];break}}}return i.reduceRight((f,d,p)=>{let m,y=!1,T=null,v=null;t&&(m=a&&d.route.id?a[d.route.id]:void 0,T=d.route.errorElement||rE,l&&(u<0&&p===0?(im("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),y=!0,v=null):u===p&&(y=!0,v=d.route.hydrateFallbackElement||null)));let x=e.concat(i.slice(0,p+1)),S=()=>{let R;return m?R=T:y?R=v:d.route.Component?R=j.createElement(d.route.Component,null):d.route.element?R=d.route.element:R=f,j.createElement(sE,{match:d,routeContext:{outlet:f,matches:x,isDataRoute:t!=null},children:R})};return t&&(d.route.ErrorBoundary||d.route.errorElement||p===0)?j.createElement(iE,{location:t.location,revalidation:t.revalidation,component:T,error:m,children:S(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):S()},null)}function ac(o){return`${o} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function oE(o){let e=j.useContext(ri);return Ye(e,ac(o)),e}function lE(o){let e=j.useContext(no);return Ye(e,ac(o)),e}function uE(o){let e=j.useContext(kn);return Ye(e,ac(o)),e}function oc(o){let e=uE(o),t=e.matches[e.matches.length-1];return Ye(t.route.id,`${o} can only be used on routes that contain a unique "id"`),t.route.id}function cE(){return oc("useRouteId")}function fE(){var n;let o=j.useContext(sc),e=lE("useRouteError"),t=oc("useRouteError");return o!==void 0?o:(n=e.errors)==null?void 0:n[t]}function dE(){let{router:o}=oE("useNavigate"),e=oc("useNavigate"),t=j.useRef(!1);return tm(()=>{t.current=!0}),j.useCallback(async(i,a={})=>{dn(t.current,em),t.current&&(typeof i=="number"?o.navigate(i):await o.navigate(i,{fromRouteId:e,...a}))},[o,e])}var Nh={};function im(o,e,t){!e&&!Nh[o]&&(Nh[o]=!0,dn(!1,t))}j.memo(hE);function hE({routes:o,future:e,state:t}){return rm(o,void 0,t,e)}function Uu(o){Ye(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function pE({basename:o="/",children:e=null,location:t,navigationType:n="POP",navigator:i,static:a=!1}){Ye(!ss(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=o.replace(/^\/*/,"/"),u=j.useMemo(()=>({basename:l,navigator:i,static:a,future:{}}),[l,i,a]);typeof t=="string"&&(t=ni(t));let{pathname:f="/",search:d="",hash:p="",state:m=null,key:y="default"}=t,T=j.useMemo(()=>{let v=Jn(f,l);return v==null?null:{location:{pathname:v,search:d,hash:p,state:m,key:y},navigationType:n}},[l,f,d,p,m,y,n]);return dn(T!=null,`<Router basename="${l}"> is not able to match the URL "${f}${d}${p}" because it does not start with the basename, so the <Router> won't render anything.`),T==null?null:j.createElement(pn.Provider,{value:u},j.createElement(is.Provider,{children:e,value:T}))}function mE({children:o,location:e}){return tE(Bu(o),e)}function Bu(o,e=[]){let t=[];return j.Children.forEach(o,(n,i)=>{if(!j.isValidElement(n))return;let a=[...e,i];if(n.type===j.Fragment){t.push.apply(t,Bu(n.props.children,a));return}Ye(n.type===Uu,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ye(!n.props.index||!n.props.children,"An index route cannot have child routes.");let l={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(l.children=Bu(n.props.children,a)),t.push(l)}),t}var Pa="get",ba="application/x-www-form-urlencoded";function ro(o){return o!=null&&typeof o.tagName=="string"}function gE(o){return ro(o)&&o.tagName.toLowerCase()==="button"}function yE(o){return ro(o)&&o.tagName.toLowerCase()==="form"}function EE(o){return ro(o)&&o.tagName.toLowerCase()==="input"}function vE(o){return!!(o.metaKey||o.altKey||o.ctrlKey||o.shiftKey)}function TE(o,e){return o.button===0&&(!e||e==="_self")&&!vE(o)}var Ea=null;function xE(){if(Ea===null)try{new FormData(document.createElement("form"),0),Ea=!1}catch{Ea=!0}return Ea}var SE=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function au(o){return o!=null&&!SE.has(o)?(dn(!1,`"${o}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${ba}"`),null):o}function LE(o,e){let t,n,i,a,l;if(yE(o)){let u=o.getAttribute("action");n=u?Jn(u,e):null,t=o.getAttribute("method")||Pa,i=au(o.getAttribute("enctype"))||ba,a=new FormData(o)}else if(gE(o)||EE(o)&&(o.type==="submit"||o.type==="image")){let u=o.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=o.getAttribute("formaction")||u.getAttribute("action");if(n=f?Jn(f,e):null,t=o.getAttribute("formmethod")||u.getAttribute("method")||Pa,i=au(o.getAttribute("formenctype"))||au(u.getAttribute("enctype"))||ba,a=new FormData(u,o),!xE()){let{name:d,type:p,value:m}=o;if(p==="image"){let y=d?`${d}.`:"";a.append(`${y}x`,"0"),a.append(`${y}y`,"0")}else d&&a.append(d,m)}}else{if(ro(o))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Pa,n=null,i=ba,l=o}return a&&i==="text/plain"&&(l=a,a=void 0),{action:n,method:t.toLowerCase(),encType:i,formData:a,body:l}}function lc(o,e){if(o===!1||o===null||typeof o>"u")throw new Error(e)}async function AE(o,e){if(o.id in e)return e[o.id];try{let t=await import(o.module);return e[o.id]=t,t}catch(t){return console.error(`Error loading route module \`${o.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function RE(o){return o==null?!1:o.href==null?o.rel==="preload"&&typeof o.imageSrcSet=="string"&&typeof o.imageSizes=="string":typeof o.rel=="string"&&typeof o.href=="string"}async function wE(o,e,t){let n=await Promise.all(o.map(async i=>{let a=e.routes[i.route.id];if(a){let l=await AE(a,t);return l.links?l.links():[]}return[]}));return DE(n.flat(1).filter(RE).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function Mh(o,e,t,n,i,a){let l=(f,d)=>t[d]?f.route.id!==t[d].route.id:!0,u=(f,d)=>{var p;return t[d].pathname!==f.pathname||((p=t[d].route.path)==null?void 0:p.endsWith("*"))&&t[d].params["*"]!==f.params["*"]};return a==="assets"?e.filter((f,d)=>l(f,d)||u(f,d)):a==="data"?e.filter((f,d)=>{var m;let p=n.routes[f.route.id];if(!p||!p.hasLoader)return!1;if(l(f,d)||u(f,d))return!0;if(f.route.shouldRevalidate){let y=f.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:((m=t[0])==null?void 0:m.params)||{},nextUrl:new URL(o,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof y=="boolean")return y}return!0}):[]}function CE(o,e){return IE(o.map(t=>{let n=e.routes[t.route.id];if(!n)return[];let i=[n.module];return n.imports&&(i=i.concat(n.imports)),i}).flat(1))}function IE(o){return[...new Set(o)]}function kE(o){let e={},t=Object.keys(o).sort();for(let n of t)e[n]=o[n];return e}function DE(o,e){let t=new Set;return new Set(e),o.reduce((n,i)=>{let a=JSON.stringify(kE(i));return t.has(a)||(t.add(a),n.push({key:a,link:i})),n},[])}function _E(o){let e=typeof o=="string"?new URL(o,typeof window>"u"?"server://singlefetch/":window.location.origin):o;return e.pathname==="/"?e.pathname="_root.data":e.pathname=`${e.pathname.replace(/\/$/,"")}.data`,e}function PE(){let o=j.useContext(ri);return lc(o,"You must render this element inside a <DataRouterContext.Provider> element"),o}function bE(){let o=j.useContext(no);return lc(o,"You must render this element inside a <DataRouterStateContext.Provider> element"),o}var uc=j.createContext(void 0);uc.displayName="FrameworkContext";function sm(){let o=j.useContext(uc);return lc(o,"You must render this element inside a <HydratedRouter> element"),o}function OE(o,e){let t=j.useContext(uc),[n,i]=j.useState(!1),[a,l]=j.useState(!1),{onFocus:u,onBlur:f,onMouseEnter:d,onMouseLeave:p,onTouchStart:m}=e,y=j.useRef(null);j.useEffect(()=>{if(o==="render"&&l(!0),o==="viewport"){let x=R=>{R.forEach(I=>{l(I.isIntersecting)})},S=new IntersectionObserver(x,{threshold:.5});return y.current&&S.observe(y.current),()=>{S.disconnect()}}},[o]),j.useEffect(()=>{if(n){let x=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(x)}}},[n]);let T=()=>{i(!0)},v=()=>{i(!1),l(!1)};return t?o!=="intent"?[a,y,{}]:[a,y,{onFocus:ji(u,T),onBlur:ji(f,v),onMouseEnter:ji(d,T),onMouseLeave:ji(p,v),onTouchStart:ji(m,T)}]:[!1,y,{}]}function ji(o,e){return t=>{o&&o(t),t.defaultPrevented||e(t)}}function FE({page:o,...e}){let{router:t}=PE(),n=j.useMemo(()=>Wp(t.routes,o,t.basename),[t.routes,o,t.basename]);return n?j.createElement(ME,{page:o,matches:n,...e}):null}function NE(o){let{manifest:e,routeModules:t}=sm(),[n,i]=j.useState([]);return j.useEffect(()=>{let a=!1;return wE(o,e,t).then(l=>{a||i(l)}),()=>{a=!0}},[o,e,t]),n}function ME({page:o,matches:e,...t}){let n=Dn(),{manifest:i,routeModules:a}=sm(),{loaderData:l,matches:u}=bE(),f=j.useMemo(()=>Mh(o,e,u,i,n,"data"),[o,e,u,i,n]),d=j.useMemo(()=>Mh(o,e,u,i,n,"assets"),[o,e,u,i,n]),p=j.useMemo(()=>{if(o===n.pathname+n.search+n.hash)return[];let T=new Set,v=!1;if(e.forEach(S=>{var I;let R=i.routes[S.route.id];!R||!R.hasLoader||(!f.some(w=>w.route.id===S.route.id)&&S.route.id in l&&((I=a[S.route.id])!=null&&I.shouldRevalidate)||R.hasClientLoader?v=!0:T.add(S.route.id))}),T.size===0)return[];let x=_E(o);return v&&T.size>0&&x.searchParams.set("_routes",e.filter(S=>T.has(S.route.id)).map(S=>S.route.id).join(",")),[x.pathname+x.search]},[l,n,i,f,e,o,a]),m=j.useMemo(()=>CE(d,i),[d,i]),y=NE(d);return j.createElement(j.Fragment,null,p.map(T=>j.createElement("link",{key:T,rel:"prefetch",as:"fetch",href:T,...t})),m.map(T=>j.createElement("link",{key:T,rel:"modulepreload",href:T,...t})),y.map(({key:T,link:v})=>j.createElement("link",{key:T,...v})))}function UE(...o){return e=>{o.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var am=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{am&&(window.__reactRouterVersion="7.1.5")}catch{}function BE({basename:o,children:e,window:t}){let n=j.useRef();n.current==null&&(n.current=Cy({window:t,v5Compat:!0}));let i=n.current,[a,l]=j.useState({action:i.action,location:i.location}),u=j.useCallback(f=>{j.startTransition(()=>l(f))},[l]);return j.useLayoutEffect(()=>i.listen(u),[i,u]),j.createElement(pE,{basename:o,children:e,location:a.location,navigationType:a.action,navigator:i})}var om=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ge=j.forwardRef(function({onClick:e,discover:t="render",prefetch:n="none",relative:i,reloadDocument:a,replace:l,state:u,target:f,to:d,preventScrollReset:p,viewTransition:m,...y},T){let{basename:v}=j.useContext(pn),x=typeof d=="string"&&om.test(d),S,R=!1;if(typeof d=="string"&&x&&(S=d,am))try{let ee=new URL(window.location.href),V=d.startsWith("//")?new URL(ee.protocol+d):new URL(d),Q=Jn(V.pathname,v);V.origin===ee.origin&&Q!=null?d=Q+V.search+V.hash:R=!0}catch{dn(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let I=Zy(d,{relative:i}),[w,b,_]=OE(n,y),K=VE(d,{replace:l,state:u,target:f,preventScrollReset:p,relative:i,viewTransition:m});function U(ee){e&&e(ee),ee.defaultPrevented||K(ee)}let z=j.createElement("a",{...y,..._,href:S||I,onClick:R||a?e:U,ref:UE(T,b),target:f,"data-discover":!x&&t==="render"?"true":void 0});return w&&!x?j.createElement(j.Fragment,null,z,j.createElement(FE,{page:I})):z});Ge.displayName="Link";var $E=j.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:n="",end:i=!1,style:a,to:l,viewTransition:u,children:f,...d},p){let m=as(l,{relative:d.relative}),y=Dn(),T=j.useContext(no),{navigator:v,basename:x}=j.useContext(pn),S=T!=null&&YE(m)&&u===!0,R=v.encodeLocation?v.encodeLocation(m).pathname:m.pathname,I=y.pathname,w=T&&T.navigation&&T.navigation.location?T.navigation.location.pathname:null;t||(I=I.toLowerCase(),w=w?w.toLowerCase():null,R=R.toLowerCase()),w&&x&&(w=Jn(w,x)||w);const b=R!=="/"&&R.endsWith("/")?R.length-1:R.length;let _=I===R||!i&&I.startsWith(R)&&I.charAt(b)==="/",K=w!=null&&(w===R||!i&&w.startsWith(R)&&w.charAt(R.length)==="/"),U={isActive:_,isPending:K,isTransitioning:S},z=_?e:void 0,ee;typeof n=="function"?ee=n(U):ee=[n,_?"active":null,K?"pending":null,S?"transitioning":null].filter(Boolean).join(" ");let V=typeof a=="function"?a(U):a;return j.createElement(Ge,{...d,"aria-current":z,className:ee,ref:p,style:V,to:l,viewTransition:u},typeof f=="function"?f(U):f)});$E.displayName="NavLink";var GE=j.forwardRef(({discover:o="render",fetcherKey:e,navigate:t,reloadDocument:n,replace:i,state:a,method:l=Pa,action:u,onSubmit:f,relative:d,preventScrollReset:p,viewTransition:m,...y},T)=>{let v=zE(),x=WE(u,{relative:d}),S=l.toLowerCase()==="get"?"get":"post",R=typeof u=="string"&&om.test(u),I=w=>{if(f&&f(w),w.defaultPrevented)return;w.preventDefault();let b=w.nativeEvent.submitter,_=(b==null?void 0:b.getAttribute("formmethod"))||l;v(b||w.currentTarget,{fetcherKey:e,method:_,navigate:t,replace:i,state:a,relative:d,preventScrollReset:p,viewTransition:m})};return j.createElement("form",{ref:T,method:S,action:x,onSubmit:n?f:I,...y,"data-discover":!R&&o==="render"?"true":void 0})});GE.displayName="Form";function HE(o){return`${o} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function lm(o){let e=j.useContext(ri);return Ye(e,HE(o)),e}function VE(o,{target:e,replace:t,state:n,preventScrollReset:i,relative:a,viewTransition:l}={}){let u=nm(),f=Dn(),d=as(o,{relative:a});return j.useCallback(p=>{if(TE(p,e)){p.preventDefault();let m=t!==void 0?t:Qi(f)===Qi(d);u(o,{replace:m,state:n,preventScrollReset:i,relative:a,viewTransition:l})}},[f,u,d,t,n,e,o,i,a,l])}var KE=0,jE=()=>`__${String(++KE)}__`;function zE(){let{router:o}=lm("useSubmit"),{basename:e}=j.useContext(pn),t=cE();return j.useCallback(async(n,i={})=>{let{action:a,method:l,encType:u,formData:f,body:d}=LE(n,e);if(i.navigate===!1){let p=i.fetcherKey||jE();await o.fetch(p,t,i.action||a,{preventScrollReset:i.preventScrollReset,formData:f,body:d,formMethod:i.method||l,formEncType:i.encType||u,flushSync:i.flushSync})}else await o.navigate(i.action||a,{preventScrollReset:i.preventScrollReset,formData:f,body:d,formMethod:i.method||l,formEncType:i.encType||u,replace:i.replace,state:i.state,fromRouteId:t,flushSync:i.flushSync,viewTransition:i.viewTransition})},[o,e,t])}function WE(o,{relative:e}={}){let{basename:t}=j.useContext(pn),n=j.useContext(kn);Ye(n,"useFormAction must be used inside a RouteContext");let[i]=n.matches.slice(-1),a={...as(o||".",{relative:e})},l=Dn();if(o==null){a.search=l.search;let u=new URLSearchParams(a.search),f=u.getAll("index");if(f.some(p=>p==="")){u.delete("index"),f.filter(m=>m).forEach(m=>u.append("index",m));let p=u.toString();a.search=p?`?${p}`:""}}return(!o||o===".")&&i.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(a.pathname=a.pathname==="/"?t:In([t,a.pathname])),Qi(a)}function YE(o,e={}){let t=j.useContext(Zp);Ye(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=lm("useViewTransitionState"),i=as(o,{relative:e.relative});if(!t.isTransitioning)return!1;let a=Jn(t.currentLocation.pathname,n)||t.currentLocation.pathname,l=Jn(t.nextLocation.pathname,n)||t.nextLocation.pathname;return Ha(i.pathname,l)!=null||Ha(i.pathname,a)!=null}new TextEncoder;const qE=()=>{const{pathname:o}=Dn();return j.useEffect(()=>{window.scrollTo(0,0)},[o]),null},XE=()=>{const[o,e]=j.useState(!1);j.useState(null);const[t,n]=j.useState(!1),i=nm(),a=()=>{localStorage.removeItem("token"),i("/login")};return j.useEffect(()=>{const l=()=>{e(window.scrollY>200)};return window.addEventListener("scroll",l),()=>{window.removeEventListener("scroll",l)}},[]),X.jsxs("header",{className:`desktop-header ${o?"scrolled":""}`,children:[X.jsxs("div",{className:"icon-container",onClick:()=>n(!t),children:[X.jsx("img",{src:"profilleFoto.png",alt:"  ",className:"profile-picture"}),t&&X.jsxs("div",{className:"options-container",children:[X.jsxs(Ge,{to:"/myprofile",className:"option-item",children:[X.jsx("i",{className:"bi bi-person"}),"  "]}),X.jsxs(Ge,{to:"/settings",className:"option-item",children:[X.jsx("i",{className:"bi bi-gear"})," "]}),X.jsxs(Ge,{className:"option-item",onClick:a,children:[X.jsx("i",{className:"bi bi-box-arrow-right"}),"  "]})]})]}),X.jsxs("div",{className:"logoNavContainer",children:[X.jsx("nav",{children:X.jsxs("ul",{className:"nav-list",children:[X.jsx("li",{children:X.jsx(Ge,{to:"/",className:"nav-link",children:" "})}),X.jsx("li",{children:X.jsx(Ge,{to:"/all-channels",className:"nav-link",children:" "})}),X.jsx("li",{children:X.jsx(Ge,{to:"/competitions",className:"nav-link",children:""})}),X.jsx("li",{children:X.jsx(Ge,{to:"/contact",className:"nav-link",children:" "})}),X.jsx("li",{children:X.jsx(Ge,{to:"/about-us",className:"nav-link",children:" "})})]})}),X.jsx(Ge,{to:"/",children:X.jsx("div",{className:"logo-container",children:X.jsx("img",{src:"logo.png",alt:"",className:"logo"})})})]})]})},QE=()=>{const[o,e]=j.useState(!1),[t,n]=j.useState(!1);j.useState(null),j.useState(null);const i=()=>{e(a=>(a?document.body.classList.remove("no-scroll"):document.body.classList.add("no-scroll"),!a))};return j.useEffect(()=>{const a=()=>{n(window.innerWidth<=800)};return a(),window.addEventListener("resize",a),()=>{window.removeEventListener("resize",a)}},[]),X.jsxs("header",{className:"burger-menu-header",children:[X.jsxs("div",{className:"burger-icon",onClick:i,children:[X.jsx("div",{className:`burger-line ${o?"open":""}`}),X.jsx("div",{className:`burger-line ${o?"open":""}`}),X.jsx("div",{className:`burger-line ${o?"open":""}`})]}),X.jsx("nav",{className:`burger-nav ${o?"open":""}`,children:X.jsxs("ul",{className:"burger-nav-list",children:[X.jsx("li",{className:"profilePicContainer",children:X.jsx(Ge,{to:"/myprofile",onClick:i,children:X.jsx("img",{src:"profilleFoto.png",alt:"Profielfoto",className:"profile-picture"})})}),X.jsx("li",{children:X.jsx(Ge,{to:"/",className:"nav-link",children:" "})}),X.jsx("li",{children:X.jsx(Ge,{to:"/all-channels",className:"nav-link",children:" "})}),X.jsx("li",{children:X.jsx(Ge,{to:"/competitions",className:"nav-link",children:""})}),X.jsx("li",{children:X.jsx(Ge,{to:"/contact",className:"nav-link",children:" "})}),X.jsx("li",{children:X.jsx(Ge,{to:"/about-us",className:"nav-link",children:" "})}),t&&X.jsx("div",{className:"settingsLogoutBtnBurg",children:X.jsx(Ge,{to:"/settings",onClick:i,children:X.jsx("i",{className:"bi bi-gear-fill"})})})]})}),X.jsx(Ge,{to:"/",children:X.jsx("div",{className:"logoContainerMobile",children:X.jsx("img",{src:"logo.png",alt:"Logo",className:"logo"})})})]})};function JE(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var um={exports:{}};(function(o,e){(function(t){var n=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,i=/^(?=([^\/?#]*))\1([^]*)$/,a=/(?:\/|^)\.(?=\/)/g,l=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,u={buildAbsoluteURL:function(f,d,p){if(p=p||{},f=f.trim(),d=d.trim(),!d){if(!p.alwaysNormalize)return f;var m=u.parseURL(f);if(!m)throw new Error("Error trying to parse base URL.");return m.path=u.normalizePath(m.path),u.buildURLFromParts(m)}var y=u.parseURL(d);if(!y)throw new Error("Error trying to parse relative URL.");if(y.scheme)return p.alwaysNormalize?(y.path=u.normalizePath(y.path),u.buildURLFromParts(y)):d;var T=u.parseURL(f);if(!T)throw new Error("Error trying to parse base URL.");if(!T.netLoc&&T.path&&T.path[0]!=="/"){var v=i.exec(T.path);T.netLoc=v[1],T.path=v[2]}T.netLoc&&!T.path&&(T.path="/");var x={scheme:T.scheme,netLoc:y.netLoc,path:null,params:y.params,query:y.query,fragment:y.fragment};if(!y.netLoc&&(x.netLoc=T.netLoc,y.path[0]!=="/"))if(!y.path)x.path=T.path,y.params||(x.params=T.params,y.query||(x.query=T.query));else{var S=T.path,R=S.substring(0,S.lastIndexOf("/")+1)+y.path;x.path=u.normalizePath(R)}return x.path===null&&(x.path=p.alwaysNormalize?u.normalizePath(y.path):y.path),u.buildURLFromParts(x)},parseURL:function(f){var d=n.exec(f);return d?{scheme:d[1]||"",netLoc:d[2]||"",path:d[3]||"",params:d[4]||"",query:d[5]||"",fragment:d[6]||""}:null},normalizePath:function(f){for(f=f.split("").reverse().join("").replace(a,"");f.length!==(f=f.replace(l,"")).length;);return f.split("").reverse().join("")},buildURLFromParts:function(f){return f.scheme+f.netLoc+f.path+f.params+f.query+f.fragment}};o.exports=u})()})(um);var cc=um.exports;function Uh(o,e){var t=Object.keys(o);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(o);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(o,i).enumerable})),t.push.apply(t,n)}return t}function lt(o){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Uh(Object(t),!0).forEach(function(n){tv(o,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(t)):Uh(Object(t)).forEach(function(n){Object.defineProperty(o,n,Object.getOwnPropertyDescriptor(t,n))})}return o}function ZE(o,e){if(typeof o!="object"||!o)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}function ev(o){var e=ZE(o,"string");return typeof e=="symbol"?e:String(e)}function tv(o,e,t){return e=ev(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function Ze(){return Ze=Object.assign?Object.assign.bind():function(o){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(o[n]=t[n])}return o},Ze.apply(this,arguments)}const oe=Number.isFinite||function(o){return typeof o=="number"&&isFinite(o)},nv=Number.isSafeInteger||function(o){return typeof o=="number"&&Math.abs(o)<=rv},rv=Number.MAX_SAFE_INTEGER||9007199254740991;let L=function(o){return o.MEDIA_ATTACHING="hlsMediaAttaching",o.MEDIA_ATTACHED="hlsMediaAttached",o.MEDIA_DETACHING="hlsMediaDetaching",o.MEDIA_DETACHED="hlsMediaDetached",o.BUFFER_RESET="hlsBufferReset",o.BUFFER_CODECS="hlsBufferCodecs",o.BUFFER_CREATED="hlsBufferCreated",o.BUFFER_APPENDING="hlsBufferAppending",o.BUFFER_APPENDED="hlsBufferAppended",o.BUFFER_EOS="hlsBufferEos",o.BUFFER_FLUSHING="hlsBufferFlushing",o.BUFFER_FLUSHED="hlsBufferFlushed",o.MANIFEST_LOADING="hlsManifestLoading",o.MANIFEST_LOADED="hlsManifestLoaded",o.MANIFEST_PARSED="hlsManifestParsed",o.LEVEL_SWITCHING="hlsLevelSwitching",o.LEVEL_SWITCHED="hlsLevelSwitched",o.LEVEL_LOADING="hlsLevelLoading",o.LEVEL_LOADED="hlsLevelLoaded",o.LEVEL_UPDATED="hlsLevelUpdated",o.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",o.LEVELS_UPDATED="hlsLevelsUpdated",o.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",o.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",o.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",o.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",o.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",o.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",o.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",o.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",o.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",o.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",o.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",o.CUES_PARSED="hlsCuesParsed",o.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",o.INIT_PTS_FOUND="hlsInitPtsFound",o.FRAG_LOADING="hlsFragLoading",o.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",o.FRAG_LOADED="hlsFragLoaded",o.FRAG_DECRYPTED="hlsFragDecrypted",o.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",o.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",o.FRAG_PARSING_METADATA="hlsFragParsingMetadata",o.FRAG_PARSED="hlsFragParsed",o.FRAG_BUFFERED="hlsFragBuffered",o.FRAG_CHANGED="hlsFragChanged",o.FPS_DROP="hlsFpsDrop",o.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",o.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",o.ERROR="hlsError",o.DESTROYING="hlsDestroying",o.KEY_LOADING="hlsKeyLoading",o.KEY_LOADED="hlsKeyLoaded",o.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",o.BACK_BUFFER_REACHED="hlsBackBufferReached",o.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",o}({}),Le=function(o){return o.NETWORK_ERROR="networkError",o.MEDIA_ERROR="mediaError",o.KEY_SYSTEM_ERROR="keySystemError",o.MUX_ERROR="muxError",o.OTHER_ERROR="otherError",o}({}),G=function(o){return o.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",o.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",o.KEY_SYSTEM_NO_SESSION="keySystemNoSession",o.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",o.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",o.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",o.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",o.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",o.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",o.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",o.MANIFEST_LOAD_ERROR="manifestLoadError",o.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",o.MANIFEST_PARSING_ERROR="manifestParsingError",o.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",o.LEVEL_EMPTY_ERROR="levelEmptyError",o.LEVEL_LOAD_ERROR="levelLoadError",o.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",o.LEVEL_PARSING_ERROR="levelParsingError",o.LEVEL_SWITCH_ERROR="levelSwitchError",o.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",o.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",o.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",o.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",o.FRAG_LOAD_ERROR="fragLoadError",o.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",o.FRAG_DECRYPT_ERROR="fragDecryptError",o.FRAG_PARSING_ERROR="fragParsingError",o.FRAG_GAP="fragGap",o.REMUX_ALLOC_ERROR="remuxAllocError",o.KEY_LOAD_ERROR="keyLoadError",o.KEY_LOAD_TIMEOUT="keyLoadTimeOut",o.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",o.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",o.BUFFER_APPEND_ERROR="bufferAppendError",o.BUFFER_APPENDING_ERROR="bufferAppendingError",o.BUFFER_STALLED_ERROR="bufferStalledError",o.BUFFER_FULL_ERROR="bufferFullError",o.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",o.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",o.INTERNAL_EXCEPTION="internalException",o.INTERNAL_ABORTED="aborted",o.UNKNOWN="unknown",o}({});const hr=function(){},$u={trace:hr,debug:hr,log:hr,warn:hr,info:hr,error:hr};let Xi=$u;function iv(o){const e=self.console[o];return e?e.bind(self.console,`[${o}] >`):hr}function sv(o,...e){e.forEach(function(t){Xi[t]=o[t]?o[t].bind(o):iv(t)})}function av(o,e){if(typeof console=="object"&&o===!0||typeof o=="object"){sv(o,"debug","log","info","warn","error");try{Xi.log(`Debug logs enabled for "${e}" in hls.js version 1.5.20`)}catch{Xi=$u}}else Xi=$u}const O=Xi,ov=/^(\d+)x(\d+)$/,Bh=/(.+?)=(".*?"|.*?)(?:,|$)/g;class We{constructor(e){typeof e=="string"&&(e=We.parseAttrList(e)),Ze(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>e.substring(0,2)==="X-")}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(t.length&1?"0":"")+t;const n=new Uint8Array(t.length/2);for(let i=0;i<t.length/2;i++)n[i]=parseInt(t.slice(i*2,i*2+2),16);return n}else return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const n=this[e];return n?parseFloat(n):t}enumeratedString(e){return this[e]}bool(e){return this[e]==="YES"}decimalResolution(e){const t=ov.exec(this[e]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e){let t;const n={},i='"';for(Bh.lastIndex=0;(t=Bh.exec(e))!==null;){let a=t[2];a.indexOf(i)===0&&a.lastIndexOf(i)===a.length-1&&(a=a.slice(1,-1));const l=t[1].trim();n[l]=a}return n}}function lv(o){return o!=="ID"&&o!=="CLASS"&&o!=="START-DATE"&&o!=="DURATION"&&o!=="END-DATE"&&o!=="END-ON-NEXT"}function uv(o){return o==="SCTE35-OUT"||o==="SCTE35-IN"}class cm{constructor(e,t){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,t){const n=t.attr;for(const i in n)if(Object.prototype.hasOwnProperty.call(e,i)&&e[i]!==n[i]){O.warn(`DATERANGE tag attribute: "${i}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=i;break}e=Ze(new We({}),n,e)}if(this.attr=e,this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const n=new Date(this.attr["END-DATE"]);oe(n.getTime())&&(this._endDate=n)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get startDate(){return this._startDate}get endDate(){if(this._endDate)return this._endDate;const e=this.duration;return e!==null?new Date(this._startDate.getTime()+e*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(oe(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isValid(){return!!this.id&&!this._badValueForSameId&&oe(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)}}class io{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var Fe={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class fm{constructor(e){this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams={[Fe.AUDIO]:null,[Fe.VIDEO]:null,[Fe.AUDIOVIDEO]:null},this.baseurl=e}setByteRange(e,t){const n=e.split("@",2);let i;n.length===1?i=(t==null?void 0:t.byteRangeEndOffset)||0:i=parseInt(n[1]),this._byteRange=[i,parseInt(n[0])+i]}get byteRange(){return this._byteRange?this._byteRange:[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=cc.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}}class ou extends fm{constructor(e,t){super(t),this._decryptdata=null,this.rawProgramDateTime=null,this.programDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.stats=new io,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const t=this.levelkeys.identity;if(t)this._decryptdata=t.getDecryptData(this.sn);else{const n=Object.keys(this.levelkeys);if(n.length===1)return this._decryptdata=this.levelkeys[n[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null||!oe(this.programDateTime))return null;const e=oe(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){const t=Object.keys(this.levelkeys),n=t.length;if(n>1||n===1&&this.levelkeys[t[0]].encrypted)return!0}return!1}setKeyFormat(e){if(this.levelkeys){const t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;(e=this.loader)==null||e.abort(),(t=this.keyLoader)==null||t.abort()}setElementaryStreamInfo(e,t,n,i,a,l=!1){const{elementaryStreams:u}=this,f=u[e];if(!f){u[e]={startPTS:t,endPTS:n,startDTS:i,endDTS:a,partial:l};return}f.startPTS=Math.min(f.startPTS,t),f.endPTS=Math.max(f.endPTS,n),f.startDTS=Math.min(f.startDTS,i),f.endDTS=Math.max(f.endDTS,a)}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[Fe.AUDIO]=null,e[Fe.VIDEO]=null,e[Fe.AUDIOVIDEO]=null}}class cv extends fm{constructor(e,t,n,i,a){super(n),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.stats=new io,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=i;const l=e.enumeratedString("BYTERANGE");l&&this.setByteRange(l,a),a&&(this.fragOffset=a.fragOffset+a.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}const fv=10;class dv{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}const t=this.lastPartSn-e.lastPartSn,n=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!n||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||t===0&&n>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1,this.availabilityDelay=e.availabilityDelay}get hasProgramDateTime(){return this.fragments.length?oe(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||fv}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return(e=this.fragments)!=null&&e.length?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}function fc(o){return Uint8Array.from(atob(o),e=>e.charCodeAt(0))}function hv(o){const e=Gu(o).subarray(0,16),t=new Uint8Array(16);return t.set(e,16-e.length),t}function pv(o){const e=function(n,i,a){const l=n[i];n[i]=n[a],n[a]=l};e(o,0,3),e(o,1,2),e(o,4,5),e(o,6,7)}function mv(o){const e=o.split(":");let t=null;if(e[0]==="data"&&e.length===2){const n=e[1].split(";"),i=n[n.length-1].split(",");if(i.length===2){const a=i[0]==="base64",l=i[1];a?(n.splice(-1,1),t=fc(l)):t=hv(l)}}return t}function Gu(o){return Uint8Array.from(unescape(encodeURIComponent(o)),e=>e.charCodeAt(0))}const Zr=typeof self<"u"?self:void 0;var be={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},Ct={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function lu(o){switch(o){case Ct.FAIRPLAY:return be.FAIRPLAY;case Ct.PLAYREADY:return be.PLAYREADY;case Ct.WIDEVINE:return be.WIDEVINE;case Ct.CLEARKEY:return be.CLEARKEY}}var va={CENC:"1077efecc0b24d02ace33c1e52e2fb4b",CLEARKEY:"e2719d58a985b3c9781ab030af78d30e",FAIRPLAY:"94ce86fb07ff4f43adb893d2fa968ca2",PLAYREADY:"9a04f07998404286ab92e65be0885f95",WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed"};function uu(o){if(o===va.WIDEVINE)return be.WIDEVINE;if(o===va.PLAYREADY)return be.PLAYREADY;if(o===va.CENC||o===va.CLEARKEY)return be.CLEARKEY}function cu(o){switch(o){case be.FAIRPLAY:return Ct.FAIRPLAY;case be.PLAYREADY:return Ct.PLAYREADY;case be.WIDEVINE:return Ct.WIDEVINE;case be.CLEARKEY:return Ct.CLEARKEY}}function Ta(o){const{drmSystems:e,widevineLicenseUrl:t}=o,n=e?[be.FAIRPLAY,be.WIDEVINE,be.PLAYREADY,be.CLEARKEY].filter(i=>!!e[i]):[];return!n[be.WIDEVINE]&&t&&n.push(be.WIDEVINE),n}const dm=function(o){return Zr!=null&&(o=Zr.navigator)!=null&&o.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function gv(o,e,t,n){let i;switch(o){case be.FAIRPLAY:i=["cenc","sinf"];break;case be.WIDEVINE:case be.PLAYREADY:i=["cenc"];break;case be.CLEARKEY:i=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${o}`)}return yv(i,e,t,n)}function yv(o,e,t,n){return[{initDataTypes:o,persistentState:n.persistentState||"optional",distinctiveIdentifier:n.distinctiveIdentifier||"optional",sessionTypes:n.sessionTypes||[n.sessionType||"temporary"],audioCapabilities:e.map(a=>({contentType:`audio/mp4; codecs="${a}"`,robustness:n.audioRobustness||"",encryptionScheme:n.audioEncryptionScheme||null})),videoCapabilities:t.map(a=>({contentType:`video/mp4; codecs="${a}"`,robustness:n.videoRobustness||"",encryptionScheme:n.videoEncryptionScheme||null}))}]}function hm(o){const e=new Uint16Array(o.buffer,o.byteOffset,o.byteLength/2),t=String.fromCharCode.apply(null,Array.from(e)),n=t.substring(t.indexOf("<"),t.length),l=new DOMParser().parseFromString(n,"text/xml").getElementsByTagName("KID")[0];if(l){const u=l.childNodes[0]?l.childNodes[0].nodeValue:l.getAttribute("VALUE");if(u){const f=fc(u).subarray(0,16);return pv(f),f}}return null}function gr(o,e,t){return Uint8Array.prototype.slice?o.slice(e,t):new Uint8Array(Array.prototype.slice.call(o,e,t))}const dc=(o,e)=>e+10<=o.length&&o[e]===73&&o[e+1]===68&&o[e+2]===51&&o[e+3]<255&&o[e+4]<255&&o[e+6]<128&&o[e+7]<128&&o[e+8]<128&&o[e+9]<128,pm=(o,e)=>e+10<=o.length&&o[e]===51&&o[e+1]===68&&o[e+2]===73&&o[e+3]<255&&o[e+4]<255&&o[e+6]<128&&o[e+7]<128&&o[e+8]<128&&o[e+9]<128,Ji=(o,e)=>{const t=e;let n=0;for(;dc(o,e);){n+=10;const i=so(o,e+6);n+=i,pm(o,e+10)&&(n+=10),e+=n}if(n>0)return o.subarray(t,t+n)},so=(o,e)=>{let t=0;return t=(o[e]&127)<<21,t|=(o[e+1]&127)<<14,t|=(o[e+2]&127)<<7,t|=o[e+3]&127,t},Ev=(o,e)=>dc(o,e)&&so(o,e+6)+10<=o.length-e,hc=o=>{const e=gm(o);for(let t=0;t<e.length;t++){const n=e[t];if(mm(n))return Av(n)}},mm=o=>o&&o.key==="PRIV"&&o.info==="com.apple.streaming.transportStreamTimestamp",vv=o=>{const e=String.fromCharCode(o[0],o[1],o[2],o[3]),t=so(o,4),n=10;return{type:e,size:t,data:o.subarray(n,n+t)}},gm=o=>{let e=0;const t=[];for(;dc(o,e);){const n=so(o,e+6);e+=10;const i=e+n;for(;e+8<i;){const a=vv(o.subarray(e)),l=Tv(a);l&&t.push(l),e+=a.size+10}pm(o,e)&&(e+=10)}return t},Tv=o=>o.type==="PRIV"?xv(o):o.type[0]==="W"?Lv(o):Sv(o),xv=o=>{if(o.size<2)return;const e=fn(o.data,!0),t=new Uint8Array(o.data.subarray(e.length+1));return{key:o.type,info:e,data:t.buffer}},Sv=o=>{if(o.size<2)return;if(o.type==="TXXX"){let t=1;const n=fn(o.data.subarray(t),!0);t+=n.length+1;const i=fn(o.data.subarray(t));return{key:o.type,info:n,data:i}}const e=fn(o.data.subarray(1));return{key:o.type,data:e}},Lv=o=>{if(o.type==="WXXX"){if(o.size<2)return;let t=1;const n=fn(o.data.subarray(t),!0);t+=n.length+1;const i=fn(o.data.subarray(t));return{key:o.type,info:n,data:i}}const e=fn(o.data);return{key:o.type,data:e}},Av=o=>{if(o.data.byteLength===8){const e=new Uint8Array(o.data),t=e[3]&1;let n=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return n/=45,t&&(n+=4772185884e-2),Math.round(n)}},fn=(o,e=!1)=>{const t=Rv();if(t){const d=t.decode(o);if(e){const p=d.indexOf("\0");return p!==-1?d.substring(0,p):d}return d.replace(/\0/g,"")}const n=o.length;let i,a,l,u="",f=0;for(;f<n;){if(i=o[f++],i===0&&e)return u;if(i===0||i===3)continue;switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:u+=String.fromCharCode(i);break;case 12:case 13:a=o[f++],u+=String.fromCharCode((i&31)<<6|a&63);break;case 14:a=o[f++],l=o[f++],u+=String.fromCharCode((i&15)<<12|(a&63)<<6|(l&63)<<0);break}}return u};let fu;function Rv(){if(!navigator.userAgent.includes("PlayStation 4"))return!fu&&typeof self.TextDecoder<"u"&&(fu=new self.TextDecoder("utf-8")),fu}const an={hexDump:function(o){let e="";for(let t=0;t<o.length;t++){let n=o[t].toString(16);n.length<2&&(n="0"+n),e+=n}return e}},Va=Math.pow(2,32)-1,wv=[].push,ym={video:1,audio:2,id3:3,text:4};function nt(o){return String.fromCharCode.apply(null,o)}function Em(o,e){const t=o[e]<<8|o[e+1];return t<0?65536+t:t}function ve(o,e){const t=vm(o,e);return t<0?4294967296+t:t}function $h(o,e){let t=ve(o,e);return t*=Math.pow(2,32),t+=ve(o,e+4),t}function vm(o,e){return o[e]<<24|o[e+1]<<16|o[e+2]<<8|o[e+3]}function du(o,e,t){o[e]=t>>24,o[e+1]=t>>16&255,o[e+2]=t>>8&255,o[e+3]=t&255}function Cv(o){const e=o.byteLength;for(let t=0;t<e;){const n=ve(o,t);if(n>8&&o[t+4]===109&&o[t+5]===111&&o[t+6]===111&&o[t+7]===102)return!0;t=n>1?t+n:e}return!1}function Re(o,e){const t=[];if(!e.length)return t;const n=o.byteLength;for(let i=0;i<n;){const a=ve(o,i),l=nt(o.subarray(i+4,i+8)),u=a>1?i+a:n;if(l===e[0])if(e.length===1)t.push(o.subarray(i+8,u));else{const f=Re(o.subarray(i+8,u),e.slice(1));f.length&&wv.apply(t,f)}i=u}return t}function Iv(o){const e=[],t=o[0];let n=8;const i=ve(o,n);n+=4;let a=0,l=0;t===0?(a=ve(o,n),l=ve(o,n+4),n+=8):(a=$h(o,n),l=$h(o,n+8),n+=16),n+=2;let u=o.length+l;const f=Em(o,n);n+=2;for(let d=0;d<f;d++){let p=n;const m=ve(o,p);p+=4;const y=m&2147483647;if((m&2147483648)>>>31===1)return O.warn("SIDX has hierarchical references (not supported)"),null;const v=ve(o,p);p+=4,e.push({referenceSize:y,subsegmentDuration:v,info:{duration:v/i,start:u,end:u+y-1}}),u+=y,p+=4,n=p}return{earliestPresentationTime:a,timescale:i,version:t,referencesCount:f,references:e}}function Tm(o){const e=[],t=Re(o,["moov","trak"]);for(let i=0;i<t.length;i++){const a=t[i],l=Re(a,["tkhd"])[0];if(l){let u=l[0];const f=ve(l,u===0?12:20),d=Re(a,["mdia","mdhd"])[0];if(d){u=d[0];const p=ve(d,u===0?12:20),m=Re(a,["mdia","hdlr"])[0];if(m){const y=nt(m.subarray(8,12)),T={soun:Fe.AUDIO,vide:Fe.VIDEO}[y];if(T){const v=Re(a,["mdia","minf","stbl","stsd"])[0],x=kv(v);e[f]={timescale:p,type:T},e[T]=lt({timescale:p,id:f},x)}}}}}return Re(o,["moov","mvex","trex"]).forEach(i=>{const a=ve(i,4),l=e[a];l&&(l.default={duration:ve(i,12),flags:ve(i,20)})}),e}function kv(o){const e=o.subarray(8),t=e.subarray(86),n=nt(e.subarray(4,8));let i=n;const a=n==="enca"||n==="encv";if(a){const u=Re(e,[n])[0].subarray(n==="enca"?28:78);Re(u,["sinf"]).forEach(d=>{const p=Re(d,["schm"])[0];if(p){const m=nt(p.subarray(4,8));if(m==="cbcs"||m==="cenc"){const y=Re(d,["frma"])[0];y&&(i=nt(y))}}})}switch(i){case"avc1":case"avc2":case"avc3":case"avc4":{const l=Re(t,["avcC"])[0];i+="."+xa(l[1])+xa(l[2])+xa(l[3]);break}case"mp4a":{const l=Re(e,[n])[0],u=Re(l.subarray(28),["esds"])[0];if(u&&u.length>12){let f=4;if(u[f++]!==3)break;f=hu(u,f),f+=2;const d=u[f++];if(d&128&&(f+=2),d&64&&(f+=u[f++]),u[f++]!==4)break;f=hu(u,f);const p=u[f++];if(p===64)i+="."+xa(p);else break;if(f+=12,u[f++]!==5)break;f=hu(u,f);const m=u[f++];let y=(m&248)>>3;y===31&&(y+=1+((m&7)<<3)+((u[f]&224)>>5)),i+="."+y}break}case"hvc1":case"hev1":{const l=Re(t,["hvcC"])[0],u=l[1],f=["","A","B","C"][u>>6],d=u&31,p=ve(l,2),m=(u&32)>>5?"H":"L",y=l[12],T=l.subarray(6,12);i+="."+f+d,i+="."+p.toString(16).toUpperCase(),i+="."+m+y;let v="";for(let x=T.length;x--;){const S=T[x];(S||v)&&(v="."+S.toString(16).toUpperCase()+v)}i+=v;break}case"dvh1":case"dvhe":{const l=Re(t,["dvcC"])[0],u=l[2]>>1&127,f=l[2]<<5&32|l[3]>>3&31;i+="."+sn(u)+"."+sn(f);break}case"vp09":{const l=Re(t,["vpcC"])[0],u=l[4],f=l[5],d=l[6]>>4&15;i+="."+sn(u)+"."+sn(f)+"."+sn(d);break}case"av01":{const l=Re(t,["av1C"])[0],u=l[1]>>>5,f=l[1]&31,d=l[2]>>>7?"H":"M",p=(l[2]&64)>>6,m=(l[2]&32)>>5,y=u===2&&p?m?12:10:p?10:8,T=(l[2]&16)>>4,v=(l[2]&8)>>3,x=(l[2]&4)>>2,S=l[2]&3;i+="."+u+"."+sn(f)+d+"."+sn(y)+"."+T+"."+v+x+S+"."+sn(1)+"."+sn(1)+"."+sn(1)+"."+0;break}}return{codec:i,encrypted:a}}function hu(o,e){const t=e+5;for(;o[e++]&128&&e<t;);return e}function xa(o){return("0"+o.toString(16).toUpperCase()).slice(-2)}function sn(o){return(o<10?"0":"")+o}function Dv(o,e){if(!o||!e)return o;const t=e.keyId;return t&&e.isCommonEncryption&&Re(o,["moov","trak"]).forEach(i=>{const l=Re(i,["mdia","minf","stbl","stsd"])[0].subarray(8);let u=Re(l,["enca"]);const f=u.length>0;f||(u=Re(l,["encv"])),u.forEach(d=>{const p=f?d.subarray(28):d.subarray(78);Re(p,["sinf"]).forEach(y=>{const T=xm(y);if(T){const v=T.subarray(8,24);v.some(x=>x!==0)||(O.log(`[eme] Patching keyId in 'enc${f?"a":"v"}>sinf>>tenc' box: ${an.hexDump(v)} -> ${an.hexDump(t)}`),T.set(t,8))}})})}),o}function xm(o){const e=Re(o,["schm"])[0];if(e){const t=nt(e.subarray(4,8));if(t==="cbcs"||t==="cenc")return Re(o,["schi","tenc"])[0]}return null}function _v(o,e){return Re(e,["moof","traf"]).reduce((t,n)=>{const i=Re(n,["tfdt"])[0],a=i[0],l=Re(n,["tfhd"]).reduce((u,f)=>{const d=ve(f,4),p=o[d];if(p){let m=ve(i,4);if(a===1){if(m===Va)return O.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),u;m*=Va+1,m+=ve(i,8)}const y=p.timescale||9e4,T=m/y;if(oe(T)&&(u===null||T<u))return T}return u},null);return l!==null&&oe(l)&&(t===null||l<t)?l:t},null)}function Pv(o,e){let t=0,n=0,i=0;const a=Re(o,["moof","traf"]);for(let l=0;l<a.length;l++){const u=a[l],f=Re(u,["tfhd"])[0],d=ve(f,4),p=e[d];if(!p)continue;const m=p.default,y=ve(f,0)|(m==null?void 0:m.flags);let T=m==null?void 0:m.duration;y&8&&(y&2?T=ve(f,12):T=ve(f,8));const v=p.timescale||9e4,x=Re(u,["trun"]);for(let S=0;S<x.length;S++){if(t=bv(x[S]),!t&&T){const R=ve(x[S],4);t=T*R}p.type===Fe.VIDEO?n+=t/v:p.type===Fe.AUDIO&&(i+=t/v)}}if(n===0&&i===0){let l=1/0,u=0,f=0;const d=Re(o,["sidx"]);for(let p=0;p<d.length;p++){const m=Iv(d[p]);if(m!=null&&m.references){l=Math.min(l,m.earliestPresentationTime/m.timescale);const y=m.references.reduce((T,v)=>T+v.info.duration||0,0);u=Math.max(u,y+m.earliestPresentationTime/m.timescale),f=u-l}}if(f&&oe(f))return f}return n||i}function bv(o){const e=ve(o,0);let t=8;e&1&&(t+=4),e&4&&(t+=4);let n=0;const i=ve(o,4);for(let a=0;a<i;a++){if(e&256){const l=ve(o,t);n+=l,t+=4}e&512&&(t+=4),e&1024&&(t+=4),e&2048&&(t+=4)}return n}function Ov(o,e,t){Re(e,["moof","traf"]).forEach(n=>{Re(n,["tfhd"]).forEach(i=>{const a=ve(i,4),l=o[a];if(!l)return;const u=l.timescale||9e4;Re(n,["tfdt"]).forEach(f=>{const d=f[0],p=t*u;if(p){let m=ve(f,4);if(d===0)m-=p,m=Math.max(m,0),du(f,4,m);else{m*=Math.pow(2,32),m+=ve(f,8),m-=p,m=Math.max(m,0);const y=Math.floor(m/(Va+1)),T=Math.floor(m%(Va+1));du(f,4,y),du(f,8,T)}}})})})}function Fv(o){const e={valid:null,remainder:null},t=Re(o,["moof"]);if(t.length<2)return e.remainder=o,e;const n=t[t.length-1];return e.valid=gr(o,0,n.byteOffset-8),e.remainder=gr(o,n.byteOffset-8),e}function Gt(o,e){const t=new Uint8Array(o.length+e.length);return t.set(o),t.set(e,o.length),t}function Gh(o,e){const t=[],n=e.samples,i=e.timescale,a=e.id;let l=!1;return Re(n,["moof"]).map(f=>{const d=f.byteOffset-8;Re(f,["traf"]).map(m=>{const y=Re(m,["tfdt"]).map(T=>{const v=T[0];let x=ve(T,4);return v===1&&(x*=Math.pow(2,32),x+=ve(T,8)),x/i})[0];return y!==void 0&&(o=y),Re(m,["tfhd"]).map(T=>{const v=ve(T,4),x=ve(T,0)&16777215,S=(x&1)!==0,R=(x&2)!==0,I=(x&8)!==0;let w=0;const b=(x&16)!==0;let _=0;const K=(x&32)!==0;let U=8;v===a&&(S&&(U+=8),R&&(U+=4),I&&(w=ve(T,U),U+=4),b&&(_=ve(T,U),U+=4),K&&(U+=4),e.type==="video"&&(l=Nv(e.codec)),Re(m,["trun"]).map(z=>{const ee=z[0],V=ve(z,0)&16777215,Q=(V&1)!==0;let ge=0;const re=(V&4)!==0,he=(V&256)!==0;let pe=0;const le=(V&512)!==0;let me=0;const J=(V&1024)!==0,W=(V&2048)!==0;let H=0;const D=ve(z,4);let $=8;Q&&(ge=ve(z,$),$+=4),re&&($+=4);let se=ge+d;for(let de=0;de<D;de++){if(he?(pe=ve(z,$),$+=4):pe=w,le?(me=ve(z,$),$+=4):me=_,J&&($+=4),W&&(ee===0?H=ve(z,$):H=vm(z,$),$+=4),e.type===Fe.VIDEO){let xe=0;for(;xe<me;){const Se=ve(n,se);if(se+=4,Mv(l,n[se])){const Ce=n.subarray(se,se+Se);Sm(Ce,l?2:1,o+H/i,t)}se+=Se,xe+=Se+4}}o+=pe/i}}))})})}),t}function Nv(o){if(!o)return!1;const e=o.indexOf("."),t=e<0?o:o.substring(0,e);return t==="hvc1"||t==="hev1"||t==="dvh1"||t==="dvhe"}function Mv(o,e){if(o){const t=e>>1&63;return t===39||t===40}else return(e&31)===6}function Sm(o,e,t,n){const i=Lm(o);let a=0;a+=e;let l=0,u=0,f=0;for(;a<i.length;){l=0;do{if(a>=i.length)break;f=i[a++],l+=f}while(f===255);u=0;do{if(a>=i.length)break;f=i[a++],u+=f}while(f===255);const d=i.length-a;let p=a;if(u<d)a+=u;else if(u>d){O.error(`Malformed SEI payload. ${u} is too small, only ${d} bytes left to parse.`);break}if(l===4){if(i[p++]===181){const y=Em(i,p);if(p+=2,y===49){const T=ve(i,p);if(p+=4,T===1195456820){const v=i[p++];if(v===3){const x=i[p++],S=31&x,R=64&x,I=R?2+S*3:0,w=new Uint8Array(I);if(R){w[0]=x;for(let b=1;b<I;b++)w[b]=i[p++]}n.push({type:v,payloadType:l,pts:t,bytes:w})}}}}}else if(l===5&&u>16){const m=[];for(let v=0;v<16;v++){const x=i[p++].toString(16);m.push(x.length==1?"0"+x:x),(v===3||v===5||v===7||v===9)&&m.push("-")}const y=u-16,T=new Uint8Array(y);for(let v=0;v<y;v++)T[v]=i[p++];n.push({payloadType:l,pts:t,uuid:m.join(""),userData:fn(T),userDataBytes:T})}}}function Lm(o){const e=o.byteLength,t=[];let n=1;for(;n<e-2;)o[n]===0&&o[n+1]===0&&o[n+2]===3?(t.push(n+2),n+=2):n++;if(t.length===0)return o;const i=e-t.length,a=new Uint8Array(i);let l=0;for(n=0;n<i;l++,n++)l===t[0]&&(l++,t.shift()),a[n]=o[l];return a}function Uv(o){const e=o[0];let t="",n="",i=0,a=0,l=0,u=0,f=0,d=0;if(e===0){for(;nt(o.subarray(d,d+1))!=="\0";)t+=nt(o.subarray(d,d+1)),d+=1;for(t+=nt(o.subarray(d,d+1)),d+=1;nt(o.subarray(d,d+1))!=="\0";)n+=nt(o.subarray(d,d+1)),d+=1;n+=nt(o.subarray(d,d+1)),d+=1,i=ve(o,12),a=ve(o,16),u=ve(o,20),f=ve(o,24),d=28}else if(e===1){d+=4,i=ve(o,d),d+=4;const m=ve(o,d);d+=4;const y=ve(o,d);for(d+=4,l=2**32*m+y,nv(l)||(l=Number.MAX_SAFE_INTEGER,O.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),u=ve(o,d),d+=4,f=ve(o,d),d+=4;nt(o.subarray(d,d+1))!=="\0";)t+=nt(o.subarray(d,d+1)),d+=1;for(t+=nt(o.subarray(d,d+1)),d+=1;nt(o.subarray(d,d+1))!=="\0";)n+=nt(o.subarray(d,d+1)),d+=1;n+=nt(o.subarray(d,d+1)),d+=1}const p=o.subarray(d,o.byteLength);return{schemeIdUri:t,value:n,timeScale:i,presentationTime:l,presentationTimeDelta:a,eventDuration:u,id:f,payload:p}}function Bv(o,...e){const t=e.length;let n=8,i=t;for(;i--;)n+=e[i].byteLength;const a=new Uint8Array(n);for(a[0]=n>>24&255,a[1]=n>>16&255,a[2]=n>>8&255,a[3]=n&255,a.set(o,4),i=0,n=8;i<t;i++)a.set(e[i],n),n+=e[i].byteLength;return a}function $v(o,e,t){if(o.byteLength!==16)throw new RangeError("Invalid system id");let n,i;n=0,i=new Uint8Array;let a;n>0?(a=new Uint8Array(4),e.length>0&&new DataView(a.buffer).setUint32(0,e.length,!1)):a=new Uint8Array;const l=new Uint8Array(4);return t&&t.byteLength>0&&new DataView(l.buffer).setUint32(0,t.byteLength,!1),Bv([112,115,115,104],new Uint8Array([n,0,0,0]),o,a,i,l,t||new Uint8Array)}function Gv(o){const e=[];if(o instanceof ArrayBuffer){const t=o.byteLength;let n=0;for(;n+32<t;){const i=new DataView(o,n),a=Hv(i);e.push(a),n+=a.size}}return e}function Hv(o){const e=o.getUint32(0),t=o.byteOffset,n=o.byteLength;if(n<e)return{offset:t,size:n};if(o.getUint32(4)!==1886614376)return{offset:t,size:e};const a=o.getUint32(8)>>>24;if(a!==0&&a!==1)return{offset:t,size:e};const l=o.buffer,u=an.hexDump(new Uint8Array(l,t+12,16)),f=o.getUint32(28);let d=null,p=null;if(a===0){if(e-32<f||f<22)return{offset:t,size:e};p=new Uint8Array(l,t+32,f)}else if(a===1){if(!f||n<t+32+f*16+16)return{offset:t,size:e};d=[];for(let m=0;m<f;m++)d.push(new Uint8Array(l,t+32+m*16,16))}return{version:a,systemId:u,kids:d,data:p,offset:t,size:e}}let Sa={};class Zi{static clearKeyUriToKeyIdMap(){Sa={}}constructor(e,t,n,i=[1],a=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=n,this.keyFormatVersions=i,this.iv=a,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&e!=="AES-128"}isSupported(){if(this.method){if(this.method==="AES-128"||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case Ct.FAIRPLAY:case Ct.WIDEVINE:case Ct.PLAYREADY:case Ct.CLEARKEY:return["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if(this.method==="AES-128"&&this.uri&&!this.iv){typeof e!="number"&&(this.method==="AES-128"&&!this.iv&&O.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);const n=Vv(e);return new Zi(this.method,this.uri,"identity",this.keyFormatVersions,n)}const t=mv(this.uri);if(t)switch(this.keyFormat){case Ct.WIDEVINE:this.pssh=t,t.length>=22&&(this.keyId=t.subarray(t.length-22,t.length-6));break;case Ct.PLAYREADY:{const n=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=$v(n,null,t),this.keyId=hm(t);break}default:{let n=t.subarray(0,16);if(n.length!==16){const i=new Uint8Array(16);i.set(n,16-n.length),n=i}this.keyId=n;break}}if(!this.keyId||this.keyId.byteLength!==16){let n=Sa[this.uri];if(!n){const i=Object.keys(Sa).length%Number.MAX_SAFE_INTEGER;n=new Uint8Array(16),new DataView(n.buffer,12,4).setUint32(0,i),Sa[this.uri]=n}this.keyId=n}return this}}function Vv(o){const e=new Uint8Array(16);for(let t=12;t<16;t++)e[t]=o>>8*(15-t)&255;return e}const Am=/\{\$([a-zA-Z0-9-_]+)\}/g;function Hh(o){return Am.test(o)}function Rt(o,e,t){if(o.variableList!==null||o.hasVariableRefs)for(let n=t.length;n--;){const i=t[n],a=e[i];a&&(e[i]=Hu(o,a))}}function Hu(o,e){if(o.variableList!==null||o.hasVariableRefs){const t=o.variableList;return e.replace(Am,n=>{const i=n.substring(2,n.length-1),a=t==null?void 0:t[i];return a===void 0?(o.playlistParsingError||(o.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${i}"`)),n):a})}return e}function Vh(o,e,t){let n=o.variableList;n||(o.variableList=n={});let i,a;if("QUERYPARAM"in e){i=e.QUERYPARAM;try{const l=new self.URL(t).searchParams;if(l.has(i))a=l.get(i);else throw new Error(`"${i}" does not match any query parameter in URI: "${t}"`)}catch(l){o.playlistParsingError||(o.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${l.message}`))}}else i=e.NAME,a=e.VALUE;i in n?o.playlistParsingError||(o.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${i}"`)):n[i]=a||""}function Kv(o,e,t){const n=e.IMPORT;if(t&&n in t){let i=o.variableList;i||(o.variableList=i={}),i[n]=t[n]}else o.playlistParsingError||(o.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${n}"`))}function vr(o=!0){return typeof self>"u"?void 0:(o||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function jv(o){return typeof self<"u"&&o===self.ManagedMediaSource}const Ka={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function zv(o,e){const t=Ka[e];return!!t&&!!t[o.slice(0,4)]}function pu(o,e,t=!0){return!o.split(",").some(n=>!Rm(n,e,t))}function Rm(o,e,t=!0){var n;const i=vr(t);return(n=i==null?void 0:i.isTypeSupported(es(o,e)))!=null?n:!1}function es(o,e){return`${e}/mp4;codecs="${o}"`}function Kh(o){if(o){const e=o.substring(0,4);return Ka.video[e]}return 2}function ja(o){return o.split(",").reduce((e,t)=>{const n=Ka.video[t];return n?(n*2+e)/(e?3:2):(Ka.audio[t]+e)/(e?2:1)},0)}const mu={};function Wv(o,e=!0){if(mu[o])return mu[o];const t={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"]}[o];for(let n=0;n<t.length;n++)if(Rm(t[n],"audio",e))return mu[o]=t[n],t[n];return o}const Yv=/flac|opus/i;function za(o,e=!0){return o.replace(Yv,t=>Wv(t.toLowerCase(),e))}function jh(o,e){return o&&o!=="mp4a"?o:e&&e.split(",")[0]}function qv(o){const e=o.split(",");for(let t=0;t<e.length;t++){const n=e[t].split(".");if(n.length>2){let i=n.shift()+".";i+=parseInt(n.shift()).toString(16),i+=("000"+parseInt(n.shift()).toString(16)).slice(-4),e[t]=i}}return e.join(",")}const zh=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,Wh=/#EXT-X-MEDIA:(.*)/g,Xv=/^#EXT(?:INF|-X-TARGETDURATION):/m,Yh=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),Qv=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class ln{static findGroup(e,t){for(let n=0;n<e.length;n++){const i=e[n];if(i.id===t)return i}}static resolve(e,t){return cc.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return Xv.test(e)}static parseMasterPlaylist(e,t){const n=Hh(e),i={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:n},a=[];zh.lastIndex=0;let l;for(;(l=zh.exec(e))!=null;)if(l[1]){var u;const d=new We(l[1]);Rt(i,d,["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]);const p=Hu(i,l[2]),m={attrs:d,bitrate:d.decimalInteger("BANDWIDTH")||d.decimalInteger("AVERAGE-BANDWIDTH"),name:d.NAME,url:ln.resolve(p,t)},y=d.decimalResolution("RESOLUTION");y&&(m.width=y.width,m.height=y.height),Jv(d.CODECS,m),(u=m.unknownCodecs)!=null&&u.length||a.push(m),i.levels.push(m)}else if(l[3]){const d=l[3],p=l[4];switch(d){case"SESSION-DATA":{const m=new We(p);Rt(i,m,["DATA-ID","LANGUAGE","VALUE","URI"]);const y=m["DATA-ID"];y&&(i.sessionData===null&&(i.sessionData={}),i.sessionData[y]=m);break}case"SESSION-KEY":{const m=qh(p,t,i);m.encrypted&&m.isSupported()?(i.sessionKeys===null&&(i.sessionKeys=[]),i.sessionKeys.push(m)):O.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${p}"`);break}case"DEFINE":{{const m=new We(p);Rt(i,m,["NAME","VALUE","QUERYPARAM"]),Vh(i,m,t)}break}case"CONTENT-STEERING":{const m=new We(p);Rt(i,m,["SERVER-URI","PATHWAY-ID"]),i.contentSteering={uri:ln.resolve(m["SERVER-URI"],t),pathwayId:m["PATHWAY-ID"]||"."};break}case"START":{i.startTimeOffset=Xh(p);break}}}const f=a.length>0&&a.length<i.levels.length;return i.levels=f?a:i.levels,i.levels.length===0&&(i.playlistParsingError=new Error("no levels found in manifest")),i}static parseMasterPlaylistMedia(e,t,n){let i;const a={},l=n.levels,u={AUDIO:l.map(d=>({id:d.attrs.AUDIO,audioCodec:d.audioCodec})),SUBTITLES:l.map(d=>({id:d.attrs.SUBTITLES,textCodec:d.textCodec})),"CLOSED-CAPTIONS":[]};let f=0;for(Wh.lastIndex=0;(i=Wh.exec(e))!==null;){const d=new We(i[1]),p=d.TYPE;if(p){const m=u[p],y=a[p]||[];a[p]=y,Rt(n,d,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]);const T=d.LANGUAGE,v=d["ASSOC-LANGUAGE"],x=d.CHANNELS,S=d.CHARACTERISTICS,R=d["INSTREAM-ID"],I={attrs:d,bitrate:0,id:f++,groupId:d["GROUP-ID"]||"",name:d.NAME||T||"",type:p,default:d.bool("DEFAULT"),autoselect:d.bool("AUTOSELECT"),forced:d.bool("FORCED"),lang:T,url:d.URI?ln.resolve(d.URI,t):""};if(v&&(I.assocLang=v),x&&(I.channels=x),S&&(I.characteristics=S),R&&(I.instreamId=R),m!=null&&m.length){const w=ln.findGroup(m,I.groupId)||m[0];Qh(I,w,"audioCodec"),Qh(I,w,"textCodec")}y.push(I)}}return a}static parseLevelPlaylist(e,t,n,i,a,l){const u=new dv(t),f=u.fragments;let d=null,p=0,m=0,y=0,T=0,v=null,x=new ou(i,t),S,R,I,w=-1,b=!1,_=null;for(Yh.lastIndex=0,u.m3u8=e,u.hasVariableRefs=Hh(e);(S=Yh.exec(e))!==null;){b&&(b=!1,x=new ou(i,t),x.start=y,x.sn=p,x.cc=T,x.level=n,d&&(x.initSegment=d,x.rawProgramDateTime=d.rawProgramDateTime,d.rawProgramDateTime=null,_&&(x.setByteRange(_),_=null)));const ee=S[1];if(ee){x.duration=parseFloat(ee);const V=(" "+S[2]).slice(1);x.title=V||null,x.tagList.push(V?["INF",ee,V]:["INF",ee])}else if(S[3]){if(oe(x.duration)){x.start=y,I&&ep(x,I,u),x.sn=p,x.level=n,x.cc=T,f.push(x);const V=(" "+S[3]).slice(1);x.relurl=Hu(u,V),Jh(x,v),v=x,y+=x.duration,p++,m=0,b=!0}}else if(S[4]){const V=(" "+S[4]).slice(1);v?x.setByteRange(V,v):x.setByteRange(V)}else if(S[5])x.rawProgramDateTime=(" "+S[5]).slice(1),x.tagList.push(["PROGRAM-DATE-TIME",x.rawProgramDateTime]),w===-1&&(w=f.length);else{if(S=S[0].match(Qv),!S){O.warn("No matches on slow regex match for level playlist!");continue}for(R=1;R<S.length&&!(typeof S[R]<"u");R++);const V=(" "+S[R]).slice(1),Q=(" "+S[R+1]).slice(1),ge=S[R+2]?(" "+S[R+2]).slice(1):"";switch(V){case"PLAYLIST-TYPE":u.type=Q.toUpperCase();break;case"MEDIA-SEQUENCE":p=u.startSN=parseInt(Q);break;case"SKIP":{const re=new We(Q);Rt(u,re,["RECENTLY-REMOVED-DATERANGES"]);const he=re.decimalInteger("SKIPPED-SEGMENTS");if(oe(he)){u.skippedSegments=he;for(let le=he;le--;)f.unshift(null);p+=he}const pe=re.enumeratedString("RECENTLY-REMOVED-DATERANGES");pe&&(u.recentlyRemovedDateranges=pe.split("	"));break}case"TARGETDURATION":u.targetduration=Math.max(parseInt(Q),1);break;case"VERSION":u.version=parseInt(Q);break;case"INDEPENDENT-SEGMENTS":case"EXTM3U":break;case"ENDLIST":u.live=!1;break;case"#":(Q||ge)&&x.tagList.push(ge?[Q,ge]:[Q]);break;case"DISCONTINUITY":T++,x.tagList.push(["DIS"]);break;case"GAP":x.gap=!0,x.tagList.push([V]);break;case"BITRATE":x.tagList.push([V,Q]);break;case"DATERANGE":{const re=new We(Q);Rt(u,re,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),Rt(u,re,re.clientAttrs);const he=new cm(re,u.dateRanges[re.ID]);he.isValid||u.skippedSegments?u.dateRanges[he.id]=he:O.warn(`Ignoring invalid DATERANGE tag: "${Q}"`),x.tagList.push(["EXT-X-DATERANGE",Q]);break}case"DEFINE":{{const re=new We(Q);Rt(u,re,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in re?Kv(u,re,l):Vh(u,re,t)}break}case"DISCONTINUITY-SEQUENCE":T=parseInt(Q);break;case"KEY":{const re=qh(Q,t,u);if(re.isSupported()){if(re.method==="NONE"){I=void 0;break}I||(I={}),I[re.keyFormat]&&(I=Ze({},I)),I[re.keyFormat]=re}else O.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${Q}"`);break}case"START":u.startTimeOffset=Xh(Q);break;case"MAP":{const re=new We(Q);if(Rt(u,re,["BYTERANGE","URI"]),x.duration){const he=new ou(i,t);Zh(he,re,n,I),d=he,x.initSegment=d,d.rawProgramDateTime&&!x.rawProgramDateTime&&(x.rawProgramDateTime=d.rawProgramDateTime)}else{const he=x.byteRangeEndOffset;if(he){const pe=x.byteRangeStartOffset;_=`${he-pe}@${pe}`}else _=null;Zh(x,re,n,I),d=x,b=!0}break}case"SERVER-CONTROL":{const re=new We(Q);u.canBlockReload=re.bool("CAN-BLOCK-RELOAD"),u.canSkipUntil=re.optionalFloat("CAN-SKIP-UNTIL",0),u.canSkipDateRanges=u.canSkipUntil>0&&re.bool("CAN-SKIP-DATERANGES"),u.partHoldBack=re.optionalFloat("PART-HOLD-BACK",0),u.holdBack=re.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{const re=new We(Q);u.partTarget=re.decimalFloatingPoint("PART-TARGET");break}case"PART":{let re=u.partList;re||(re=u.partList=[]);const he=m>0?re[re.length-1]:void 0,pe=m++,le=new We(Q);Rt(u,le,["BYTERANGE","URI"]);const me=new cv(le,x,t,pe,he);re.push(me),x.duration+=me.duration;break}case"PRELOAD-HINT":{const re=new We(Q);Rt(u,re,["URI"]),u.preloadHint=re;break}case"RENDITION-REPORT":{const re=new We(Q);Rt(u,re,["URI"]),u.renditionReports=u.renditionReports||[],u.renditionReports.push(re);break}default:O.warn(`line parsed but not handled: ${S}`);break}}}v&&!v.relurl?(f.pop(),y-=v.duration,u.partList&&(u.fragmentHint=v)):u.partList&&(Jh(x,v),x.cc=T,u.fragmentHint=x,I&&ep(x,I,u));const K=f.length,U=f[0],z=f[K-1];if(y+=u.skippedSegments*u.targetduration,y>0&&K&&z){u.averagetargetduration=y/K;const ee=z.sn;u.endSN=ee!=="initSegment"?ee:0,u.live||(z.endList=!0),U&&(u.startCC=U.cc)}else u.endSN=0,u.startCC=0;return u.fragmentHint&&(y+=u.fragmentHint.duration),u.totalduration=y,u.endCC=T,w>0&&Zv(f,w),u}}function qh(o,e,t){var n,i;const a=new We(o);Rt(t,a,["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]);const l=(n=a.METHOD)!=null?n:"",u=a.URI,f=a.hexadecimalInteger("IV"),d=a.KEYFORMATVERSIONS,p=(i=a.KEYFORMAT)!=null?i:"identity";u&&a.IV&&!f&&O.error(`Invalid IV: ${a.IV}`);const m=u?ln.resolve(u,e):"",y=(d||"1").split("/").map(Number).filter(Number.isFinite);return new Zi(l,m,p,y,f)}function Xh(o){const t=new We(o).decimalFloatingPoint("TIME-OFFSET");return oe(t)?t:null}function Jv(o,e){let t=(o||"").split(/[ ,]+/).filter(n=>n);["video","audio","text"].forEach(n=>{const i=t.filter(a=>zv(a,n));i.length&&(e[`${n}Codec`]=i.join(","),t=t.filter(a=>i.indexOf(a)===-1))}),e.unknownCodecs=t}function Qh(o,e,t){const n=e[t];n&&(o[t]=n)}function Zv(o,e){let t=o[e];for(let n=e;n--;){const i=o[n];if(!i)return;i.programDateTime=t.programDateTime-i.duration*1e3,t=i}}function Jh(o,e){o.rawProgramDateTime?o.programDateTime=Date.parse(o.rawProgramDateTime):e!=null&&e.programDateTime&&(o.programDateTime=e.endProgramDateTime),oe(o.programDateTime)||(o.programDateTime=null,o.rawProgramDateTime=null)}function Zh(o,e,t,n){o.relurl=e.URI,e.BYTERANGE&&o.setByteRange(e.BYTERANGE),o.level=t,o.sn="initSegment",n&&(o.levelkeys=n),o.initSegment=null}function ep(o,e,t){o.levelkeys=e;const{encryptedFragments:n}=t;(!n.length||n[n.length-1].levelkeys!==e)&&Object.keys(e).some(i=>e[i].isCommonEncryption)&&n.push(o)}var De={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},Te={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};function tp(o){const{type:e}=o;switch(e){case De.AUDIO_TRACK:return Te.AUDIO;case De.SUBTITLE_TRACK:return Te.SUBTITLE;default:return Te.MAIN}}function gu(o,e){let t=o.url;return(t===void 0||t.indexOf("data:")===0)&&(t=e.url),t}class eT{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.LEVEL_LOADING,this.onLevelLoading,this),e.on(L.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(L.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}unregisterListeners(){const{hls:e}=this;e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.LEVEL_LOADING,this.onLevelLoading,this),e.off(L.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(L.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}createInternalLoader(e){const t=this.hls.config,n=t.pLoader,i=t.loader,a=n||i,l=new a(t);return this.loaders[e.type]=l,l}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:n}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:De.MANIFEST,url:n,deliveryDirectives:null})}onLevelLoading(e,t){const{id:n,level:i,pathwayId:a,url:l,deliveryDirectives:u}=t;this.load({id:n,level:i,pathwayId:a,responseType:"text",type:De.LEVEL,url:l,deliveryDirectives:u})}onAudioTrackLoading(e,t){const{id:n,groupId:i,url:a,deliveryDirectives:l}=t;this.load({id:n,groupId:i,level:null,responseType:"text",type:De.AUDIO_TRACK,url:a,deliveryDirectives:l})}onSubtitleTrackLoading(e,t){const{id:n,groupId:i,url:a,deliveryDirectives:l}=t;this.load({id:n,groupId:i,level:null,responseType:"text",type:De.SUBTITLE_TRACK,url:a,deliveryDirectives:l})}load(e){var t;const n=this.hls.config;let i=this.getInternalLoader(e);if(i){const d=i.context;if(d&&d.url===e.url&&d.level===e.level){O.trace("[playlist-loader]: playlist request ongoing");return}O.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),i.abort()}let a;if(e.type===De.MANIFEST?a=n.manifestLoadPolicy.default:a=Ze({},n.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),i=this.createInternalLoader(e),oe((t=e.deliveryDirectives)==null?void 0:t.part)){let d;if(e.type===De.LEVEL&&e.level!==null?d=this.hls.levels[e.level].details:e.type===De.AUDIO_TRACK&&e.id!==null?d=this.hls.audioTracks[e.id].details:e.type===De.SUBTITLE_TRACK&&e.id!==null&&(d=this.hls.subtitleTracks[e.id].details),d){const p=d.partTarget,m=d.targetduration;if(p&&m){const y=Math.max(p*3,m*.8)*1e3;a=Ze({},a,{maxTimeToFirstByteMs:Math.min(y,a.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(y,a.maxTimeToFirstByteMs)})}}}const l=a.errorRetry||a.timeoutRetry||{},u={loadPolicy:a,timeout:a.maxLoadTimeMs,maxRetry:l.maxNumRetry||0,retryDelay:l.retryDelayMs||0,maxRetryDelay:l.maxRetryDelayMs||0},f={onSuccess:(d,p,m,y)=>{const T=this.getInternalLoader(m);this.resetInternalLoader(m.type);const v=d.data;if(v.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(d,m,new Error("no EXTM3U delimiter"),y||null,p);return}p.parsing.start=performance.now(),ln.isMediaPlaylist(v)?this.handleTrackOrLevelPlaylist(d,p,m,y||null,T):this.handleMasterPlaylist(d,p,m,y)},onError:(d,p,m,y)=>{this.handleNetworkError(p,m,!1,d,y)},onTimeout:(d,p,m)=>{this.handleNetworkError(p,m,!0,void 0,d)}};i.load(e,u,f)}handleMasterPlaylist(e,t,n,i){const a=this.hls,l=e.data,u=gu(e,n),f=ln.parseMasterPlaylist(l,u);if(f.playlistParsingError){this.handleManifestParsingError(e,n,f.playlistParsingError,i,t);return}const{contentSteering:d,levels:p,sessionData:m,sessionKeys:y,startTimeOffset:T,variableList:v}=f;this.variableList=v;const{AUDIO:x=[],SUBTITLES:S,"CLOSED-CAPTIONS":R}=ln.parseMasterPlaylistMedia(l,u,f);x.length&&!x.some(w=>!w.url)&&p[0].audioCodec&&!p[0].attrs.AUDIO&&(O.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),x.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new We({}),bitrate:0,url:""})),a.trigger(L.MANIFEST_LOADED,{levels:p,audioTracks:x,subtitles:S,captions:R,contentSteering:d,url:u,stats:t,networkDetails:i,sessionData:m,sessionKeys:y,startTimeOffset:T,variableList:v})}handleTrackOrLevelPlaylist(e,t,n,i,a){const l=this.hls,{id:u,level:f,type:d}=n,p=gu(e,n),m=0,y=oe(f)?f:oe(u)?u:0,T=tp(n),v=ln.parseLevelPlaylist(e.data,p,y,T,m,this.variableList);if(d===De.MANIFEST){const x={attrs:new We({}),bitrate:0,details:v,name:"",url:p};l.trigger(L.MANIFEST_LOADED,{levels:[x],audioTracks:[],url:p,stats:t,networkDetails:i,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),n.levelDetails=v,this.handlePlaylistLoaded(v,e,t,n,i,a)}handleManifestParsingError(e,t,n,i,a){this.hls.trigger(L.ERROR,{type:Le.NETWORK_ERROR,details:G.MANIFEST_PARSING_ERROR,fatal:t.type===De.MANIFEST,url:e.url,err:n,error:n,reason:n.message,response:e,context:t,networkDetails:i,stats:a})}handleNetworkError(e,t,n=!1,i,a){let l=`A network ${n?"timeout":"error"+(i?" (status "+i.code+")":"")} occurred while loading ${e.type}`;e.type===De.LEVEL?l+=`: ${e.level} id: ${e.id}`:(e.type===De.AUDIO_TRACK||e.type===De.SUBTITLE_TRACK)&&(l+=` id: ${e.id} group-id: "${e.groupId}"`);const u=new Error(l);O.warn(`[playlist-loader]: ${l}`);let f=G.UNKNOWN,d=!1;const p=this.getInternalLoader(e);switch(e.type){case De.MANIFEST:f=n?G.MANIFEST_LOAD_TIMEOUT:G.MANIFEST_LOAD_ERROR,d=!0;break;case De.LEVEL:f=n?G.LEVEL_LOAD_TIMEOUT:G.LEVEL_LOAD_ERROR,d=!1;break;case De.AUDIO_TRACK:f=n?G.AUDIO_TRACK_LOAD_TIMEOUT:G.AUDIO_TRACK_LOAD_ERROR,d=!1;break;case De.SUBTITLE_TRACK:f=n?G.SUBTITLE_TRACK_LOAD_TIMEOUT:G.SUBTITLE_LOAD_ERROR,d=!1;break}p&&this.resetInternalLoader(e.type);const m={type:Le.NETWORK_ERROR,details:f,fatal:d,url:e.url,loader:p,context:e,error:u,networkDetails:t,stats:a};if(i){const y=(t==null?void 0:t.url)||e.url;m.response=lt({url:y,data:void 0},i)}this.hls.trigger(L.ERROR,m)}handlePlaylistLoaded(e,t,n,i,a,l){const u=this.hls,{type:f,level:d,id:p,groupId:m,deliveryDirectives:y}=i,T=gu(t,i),v=tp(i),x=typeof i.level=="number"&&v===Te.MAIN?d:void 0;if(!e.fragments.length){const R=new Error("No Segments found in Playlist");u.trigger(L.ERROR,{type:Le.NETWORK_ERROR,details:G.LEVEL_EMPTY_ERROR,fatal:!1,url:T,error:R,reason:R.message,response:t,context:i,level:x,parent:v,networkDetails:a,stats:n});return}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));const S=e.playlistParsingError;if(S){u.trigger(L.ERROR,{type:Le.NETWORK_ERROR,details:G.LEVEL_PARSING_ERROR,fatal:!1,url:T,error:S,reason:S.message,response:t,context:i,level:x,parent:v,networkDetails:a,stats:n});return}switch(e.live&&l&&(l.getCacheAge&&(e.ageHeader=l.getCacheAge()||0),(!l.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),f){case De.MANIFEST:case De.LEVEL:u.trigger(L.LEVEL_LOADED,{details:e,level:x||0,id:p||0,stats:n,networkDetails:a,deliveryDirectives:y});break;case De.AUDIO_TRACK:u.trigger(L.AUDIO_TRACK_LOADED,{details:e,id:p||0,groupId:m||"",stats:n,networkDetails:a,deliveryDirectives:y});break;case De.SUBTITLE_TRACK:u.trigger(L.SUBTITLE_TRACK_LOADED,{details:e,id:p||0,groupId:m||"",stats:n,networkDetails:a,deliveryDirectives:y});break}}}function wm(o,e){let t;try{t=new Event("addtrack")}catch{t=document.createEvent("Event"),t.initEvent("addtrack",!1,!1)}t.track=o,e.dispatchEvent(t)}function Cm(o,e){const t=o.mode;if(t==="disabled"&&(o.mode="hidden"),o.cues&&!o.cues.getCueById(e.id))try{if(o.addCue(e),!o.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(n){O.debug(`[texttrack-utils]: ${n}`);try{const i=new self.TextTrackCue(e.startTime,e.endTime,e.text);i.id=e.id,o.addCue(i)}catch(i){O.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${i}`)}}t==="disabled"&&(o.mode=t)}function Xr(o){const e=o.mode;if(e==="disabled"&&(o.mode="hidden"),o.cues)for(let t=o.cues.length;t--;)o.removeCue(o.cues[t]);e==="disabled"&&(o.mode=e)}function Vu(o,e,t,n){const i=o.mode;if(i==="disabled"&&(o.mode="hidden"),o.cues&&o.cues.length>0){const a=nT(o.cues,e,t);for(let l=0;l<a.length;l++)(!n||n(a[l]))&&o.removeCue(a[l])}i==="disabled"&&(o.mode=i)}function tT(o,e){if(e<o[0].startTime)return 0;const t=o.length-1;if(e>o[t].endTime)return-1;let n=0,i=t;for(;n<=i;){const a=Math.floor((i+n)/2);if(e<o[a].startTime)i=a-1;else if(e>o[a].startTime&&n<t)n=a+1;else return a}return o[n].startTime-e<e-o[i].startTime?n:i}function nT(o,e,t){const n=[],i=tT(o,e);if(i>-1)for(let a=i,l=o.length;a<l;a++){const u=o[a];if(u.startTime>=e&&u.endTime<=t)n.push(u);else if(u.startTime>t)return n}return n}function Oa(o){const e=[];for(let t=0;t<o.length;t++){const n=o[t];(n.kind==="subtitles"||n.kind==="captions")&&n.label&&e.push(o[t])}return e}var Qt={audioId3:"org.id3",dateRange:"com.apple.quicktime.HLS",emsg:"https://aomedia.org/emsg/ID3"};const rT=.25;function Ku(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function np(o,e,t,n,i){let a=new o(e,t,"");try{a.value=n,i&&(a.type=i)}catch{a=new o(e,t,JSON.stringify(i?lt({type:i},n):n))}return a}const La=(()=>{const o=Ku();try{o&&new o(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function yu(o,e){return o.getTime()/1e3-e}function iT(o){return Uint8Array.from(o.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}class sT{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null}_registerListeners(){const{hls:e}=this;e.on(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(L.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(L.LEVEL_UPDATED,this.onLevelUpdated,this)}_unregisterListeners(){const{hls:e}=this;e.off(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(L.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(L.LEVEL_UPDATED,this.onLevelUpdated,this)}onMediaAttached(e,t){this.media=t.media}onMediaDetaching(){this.id3Track&&(Xr(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const n=e[t];if(n.kind==="metadata"&&n.label==="id3")return wm(n,this.media),n}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:n,enableID3MetadataCues:i}}}=this;if(!n&&!i)return;const{samples:a}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const l=Ku();if(l)for(let u=0;u<a.length;u++){const f=a[u].type;if(f===Qt.emsg&&!n||!i)continue;const d=gm(a[u].data);if(d){const p=a[u].pts;let m=p+a[u].duration;m>La&&(m=La),m-p<=0&&(m=p+rT);for(let T=0;T<d.length;T++){const v=d[T];if(!mm(v)){this.updateId3CueEnds(p,f);const x=np(l,p,m,v,f);x&&this.id3Track.addCue(x)}}}}}updateId3CueEnds(e,t){var n;const i=(n=this.id3Track)==null?void 0:n.cues;if(i)for(let a=i.length;a--;){const l=i[a];l.type===t&&l.startTime<e&&l.endTime===La&&(l.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:n,type:i}){const{id3Track:a,hls:l}=this;if(!l)return;const{config:{enableEmsgMetadataCues:u,enableID3MetadataCues:f}}=l;if(a&&(u||f)){let d;i==="audio"?d=p=>p.type===Qt.audioId3&&f:i==="video"?d=p=>p.type===Qt.emsg&&u:d=p=>p.type===Qt.audioId3&&f||p.type===Qt.emsg&&u,Vu(a,t,n,d)}}onLevelUpdated(e,{details:t}){if(!this.media||!t.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{dateRangeCuesAppended:n,id3Track:i}=this,{dateRanges:a}=t,l=Object.keys(a);if(i){const p=Object.keys(n).filter(m=>!l.includes(m));for(let m=p.length;m--;){const y=p[m];Object.keys(n[y].cues).forEach(T=>{i.removeCue(n[y].cues[T])}),delete n[y]}}const u=t.fragments[t.fragments.length-1];if(l.length===0||!oe(u==null?void 0:u.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const f=u.programDateTime/1e3-u.start,d=Ku();for(let p=0;p<l.length;p++){const m=l[p],y=a[m],T=yu(y.startDate,f),v=n[m],x=(v==null?void 0:v.cues)||{};let S=(v==null?void 0:v.durationKnown)||!1,R=La;const I=y.endDate;if(I)R=yu(I,f),S=!0;else if(y.endOnNext&&!S){const b=l.reduce((_,K)=>{if(K!==y.id){const U=a[K];if(U.class===y.class&&U.startDate>y.startDate&&(!_||y.startDate<_.startDate))return U}return _},null);b&&(R=yu(b.startDate,f),S=!0)}const w=Object.keys(y.attr);for(let b=0;b<w.length;b++){const _=w[b];if(!lv(_))continue;const K=x[_];if(K)S&&!v.durationKnown&&(K.endTime=R);else if(d){let U=y.attr[_];uv(_)&&(U=iT(U));const z=np(d,T,R,{key:_,data:U},Qt.dateRange);z&&(z.id=m,this.id3Track.addCue(z),x[_]=z)}}n[m]={cues:x,dateRange:y,durationKnown:S}}}}class aT{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=()=>this.timeupdate(),this.hls=e,this.config=e.config,this.registerListeners()}get latency(){return this._latency||0}get maxLatency(){const{config:e,levelDetails:t}=this;return e.liveMaxLatencyDuration!==void 0?e.liveMaxLatencyDuration:t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const{levelDetails:e}=this;if(e===null)return null;const{holdBack:t,partHoldBack:n,targetduration:i}=e,{liveSyncDuration:a,liveSyncDurationCount:l,lowLatencyMode:u}=this.config,f=this.hls.userConfig;let d=u&&n||t;(f.liveSyncDuration||f.liveSyncDurationCount||d===0)&&(d=a!==void 0?a:l*i);const p=i;return d+Math.min(this.stallCount*1,p)}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency,n=this.levelDetails;if(e===null||t===null||n===null)return null;const i=n.edge,a=e-t-this.edgeStalled,l=i-n.totalduration,u=i-(this.config.lowLatencyMode&&n.partTarget||n.targetduration);return Math.min(Math.max(l,a),u)}get drift(){const{levelDetails:e}=this;return e===null?1:e.drift}get edgeStalled(){const{levelDetails:e}=this;if(e===null)return 0;const t=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e,levelDetails:t}=this;if(!e||!t)return 0;const n=e.buffered.length;return(n?e.buffered.end(n-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}registerListeners(){this.hls.on(L.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(L.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(L.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(L.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(L.ERROR,this.onError,this)}unregisterListeners(){this.hls.off(L.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(L.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(L.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(L.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(L.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){this.levelDetails=t,t.advanced&&this.timeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}onError(e,t){var n;t.details===G.BUFFER_STALLED_ERROR&&(this.stallCount++,(n=this.levelDetails)!=null&&n.live&&O.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))}timeupdate(){const{media:e,levelDetails:t}=this;if(!e||!t)return;this.currentTime=e.currentTime;const n=this.computeLatency();if(n===null)return;this._latency=n;const{lowLatencyMode:i,maxLiveSyncPlaybackRate:a}=this.config;if(!i||a===1||!t.live)return;const l=this.targetLatency;if(l===null)return;const u=n-l,f=Math.min(this.maxLatency,l+t.targetduration);if(u<f&&u>.05&&this.forwardBufferLength>1){const p=Math.min(2,Math.max(1,a)),m=Math.round(2/(1+Math.exp(-.75*u-this.edgeStalled))*20)/20;e.playbackRate=Math.min(p,Math.max(1,m))}else e.playbackRate!==1&&e.playbackRate!==0&&(e.playbackRate=1)}estimateLiveEdge(){const{levelDetails:e}=this;return e===null?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}const ju=["NONE","TYPE-0","TYPE-1",null];function oT(o){return ju.indexOf(o)>-1}const Wa=["SDR","PQ","HLG"];function lT(o){return!!o&&Wa.indexOf(o)>-1}var Fa={No:"",Yes:"YES",v2:"v2"};function rp(o){const{canSkipUntil:e,canSkipDateRanges:t,age:n}=o,i=n<e/2;return e&&i?t?Fa.v2:Fa.Yes:Fa.No}class ip{constructor(e,t,n){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=n}addDirectives(e){const t=new self.URL(e);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class ei{constructor(e){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(t=>!!t).map(t=>t.substring(0,4)).join(","),this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return sp(this._audioGroups,e)}hasSubtitleGroup(e){return sp(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t){if(e==="audio"){let n=this._audioGroups;n||(n=this._audioGroups=[]),n.indexOf(t)===-1&&n.push(t)}else if(e==="text"){let n=this._subtitleGroups;n||(n=this._subtitleGroups=[]),n.indexOf(t)===-1&&n.push(t)}}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return(e=this.audioGroups)==null?void 0:e[0]}get textGroupId(){var e;return(e=this.subtitleGroups)==null?void 0:e[0]}addFallback(){}}function sp(o,e){return!e||!o?!1:o.indexOf(e)!==-1}function Eu(o,e){const t=e.startPTS;if(oe(t)){let n=0,i;e.sn>o.sn?(n=t-o.start,i=o):(n=o.start-t,i=e),i.duration!==n&&(i.duration=n)}else e.sn>o.sn?o.cc===e.cc&&o.minEndPTS?e.start=o.start+(o.minEndPTS-o.start):e.start=o.start+o.duration:e.start=Math.max(o.start-e.duration,0)}function Im(o,e,t,n,i,a){n-t<=0&&(O.warn("Fragment should have a positive duration",e),n=t+e.duration,a=i+e.duration);let u=t,f=n;const d=e.startPTS,p=e.endPTS;if(oe(d)){const S=Math.abs(d-t);oe(e.deltaPTS)?e.deltaPTS=Math.max(S,e.deltaPTS):e.deltaPTS=S,u=Math.max(t,d),t=Math.min(t,d),i=Math.min(i,e.startDTS),f=Math.min(n,p),n=Math.max(n,p),a=Math.max(a,e.endDTS)}const m=t-e.start;e.start!==0&&(e.start=t),e.duration=n-e.start,e.startPTS=t,e.maxStartPTS=u,e.startDTS=i,e.endPTS=n,e.minEndPTS=f,e.endDTS=a;const y=e.sn;if(!o||y<o.startSN||y>o.endSN)return 0;let T;const v=y-o.startSN,x=o.fragments;for(x[v]=e,T=v;T>0;T--)Eu(x[T],x[T-1]);for(T=v;T<x.length-1;T++)Eu(x[T],x[T+1]);return o.fragmentHint&&Eu(x[x.length-1],o.fragmentHint),o.PTSKnown=o.alignedSliding=!0,m}function uT(o,e){let t=null;const n=o.fragments;for(let u=n.length-1;u>=0;u--){const f=n[u].initSegment;if(f){t=f;break}}o.fragmentHint&&delete o.fragmentHint.endPTS;let i;dT(o,e,(u,f,d,p)=>{if(e.skippedSegments&&f.cc!==u.cc){const m=u.cc-f.cc;for(let y=d;y<p.length;y++)p[y].cc+=m}oe(u.startPTS)&&oe(u.endPTS)&&(f.start=f.startPTS=u.startPTS,f.startDTS=u.startDTS,f.maxStartPTS=u.maxStartPTS,f.endPTS=u.endPTS,f.endDTS=u.endDTS,f.minEndPTS=u.minEndPTS,f.duration=u.endPTS-u.startPTS,f.duration&&(i=f),e.PTSKnown=e.alignedSliding=!0),f.elementaryStreams=u.elementaryStreams,f.loader=u.loader,f.stats=u.stats,u.initSegment&&(f.initSegment=u.initSegment,t=u.initSegment)});const a=e.fragments;if(t&&(e.fragmentHint?a.concat(e.fragmentHint):a).forEach(f=>{var d;f&&(!f.initSegment||f.initSegment.relurl===((d=t)==null?void 0:d.relurl))&&(f.initSegment=t)}),e.skippedSegments){if(e.deltaUpdateFailed=a.some(u=>!u),e.deltaUpdateFailed){O.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let u=e.skippedSegments;u--;)a.shift();e.startSN=a[0].sn}else e.canSkipDateRanges&&(e.dateRanges=cT(o.dateRanges,e.dateRanges,e.recentlyRemovedDateranges));e.startCC=e.fragments[0].cc,e.endCC=a[a.length-1].cc}fT(o.partList,e.partList,(u,f)=>{f.elementaryStreams=u.elementaryStreams,f.stats=u.stats}),i?Im(e,i,i.startPTS,i.endPTS,i.startDTS,i.endDTS):km(o,e),a.length&&(e.totalduration=e.edge-a[0].start),e.driftStartTime=o.driftStartTime,e.driftStart=o.driftStart;const l=e.advancedDateTime;if(e.advanced&&l){const u=e.edge;e.driftStart||(e.driftStartTime=l,e.driftStart=u),e.driftEndTime=l,e.driftEnd=u}else e.driftEndTime=o.driftEndTime,e.driftEnd=o.driftEnd,e.advancedDateTime=o.advancedDateTime}function cT(o,e,t){const n=Ze({},o);return t&&t.forEach(i=>{delete n[i]}),Object.keys(e).forEach(i=>{const a=new cm(e[i].attr,n[i]);a.isValid?n[i]=a:O.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${JSON.stringify(e[i].attr)}"`)}),n}function fT(o,e,t){if(o&&e){let n=0;for(let i=0,a=o.length;i<=a;i++){const l=o[i],u=e[i+n];l&&u&&l.index===u.index&&l.fragment.sn===u.fragment.sn?t(l,u):n--}}}function dT(o,e,t){const n=e.skippedSegments,i=Math.max(o.startSN,e.startSN)-e.startSN,a=(o.fragmentHint?1:0)+(n?e.endSN:Math.min(o.endSN,e.endSN))-e.startSN,l=e.startSN-o.startSN,u=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,f=o.fragmentHint?o.fragments.concat(o.fragmentHint):o.fragments;for(let d=i;d<=a;d++){const p=f[l+d];let m=u[d];n&&!m&&d<n&&(m=e.fragments[d]=p),p&&m&&t(p,m,d,u)}}function km(o,e){const t=e.startSN+e.skippedSegments-o.startSN,n=o.fragments;t<0||t>=n.length||zu(e,n[t].start)}function zu(o,e){if(e){const t=o.fragments;for(let n=o.skippedSegments;n<t.length;n++)t[n].start+=e;o.fragmentHint&&(o.fragmentHint.start+=e)}}function hT(o,e=1/0){let t=1e3*o.targetduration;if(o.updated){const n=o.fragments;if(n.length&&t*4>e){const a=n[n.length-1].duration*1e3;a<t&&(t=a)}}else t/=2;return Math.round(t)}function pT(o,e,t){if(!(o!=null&&o.details))return null;const n=o.details;let i=n.fragments[e-n.startSN];return i||(i=n.fragmentHint,i&&i.sn===e)?i:e<n.startSN&&t&&t.sn===e?t:null}function ap(o,e,t){var n;return o!=null&&o.details?Dm((n=o.details)==null?void 0:n.partList,e,t):null}function Dm(o,e,t){if(o)for(let n=o.length;n--;){const i=o[n];if(i.index===t&&i.fragment.sn===e)return i}return null}function _m(o){o.forEach((e,t)=>{const{details:n}=e;n!=null&&n.fragments&&n.fragments.forEach(i=>{i.level=t})})}function Ya(o){switch(o.details){case G.FRAG_LOAD_TIMEOUT:case G.KEY_LOAD_TIMEOUT:case G.LEVEL_LOAD_TIMEOUT:case G.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function op(o,e){const t=Ya(e);return o.default[`${t?"timeout":"error"}Retry`]}function pc(o,e){const t=o.backoff==="linear"?1:Math.pow(2,e);return Math.min(t*o.retryDelayMs,o.maxRetryDelayMs)}function lp(o){return lt(lt({},o),{errorRetry:null,timeoutRetry:null})}function qa(o,e,t,n){if(!o)return!1;const i=n==null?void 0:n.code,a=e<o.maxNumRetry&&(mT(i)||!!t);return o.shouldRetry?o.shouldRetry(o,e,t,n,a):a}function mT(o){return o===0&&navigator.onLine===!1||!!o&&(o<400||o>499)}const Pm={search:function(o,e){let t=0,n=o.length-1,i=null,a=null;for(;t<=n;){i=(t+n)/2|0,a=o[i];const l=e(a);if(l>0)t=i+1;else if(l<0)n=i-1;else return a}return null}};function gT(o,e,t){if(e===null||!Array.isArray(o)||!o.length||!oe(e))return null;const n=o[0].programDateTime;if(e<(n||0))return null;const i=o[o.length-1].endProgramDateTime;if(e>=(i||0))return null;t=t||0;for(let a=0;a<o.length;++a){const l=o[a];if(ET(e,t,l))return l}return null}function Xa(o,e,t=0,n=0,i=.005){let a=null;if(o){a=e[o.sn-e[0].sn+1]||null;const u=o.endDTS-t;u>0&&u<15e-7&&(t+=15e-7)}else t===0&&e[0].start===0&&(a=e[0]);if(a&&((!o||o.level===a.level)&&Wu(t,n,a)===0||yT(a,o,Math.min(i,n))))return a;const l=Pm.search(e,Wu.bind(null,t,n));return l&&(l!==o||!a)?l:a}function yT(o,e,t){if(e&&e.start===0&&e.level<o.level&&(e.endPTS||0)>0){const n=e.tagList.reduce((i,a)=>(a[0]==="INF"&&(i+=parseFloat(a[1])),i),t);return o.start<=n}return!1}function Wu(o=0,e=0,t){if(t.start<=o&&t.start+t.duration>o)return 0;const n=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-n<=o?1:t.start-n>o&&t.start?-1:0}function ET(o,e,t){const n=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0))*1e3;return(t.endProgramDateTime||0)-n>o}function vT(o,e){return Pm.search(o,t=>t.cc<e?1:t.cc>e?-1:0)}var ft={DoNothing:0,SendEndCallback:1,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,InsertDiscontinuity:4,RetryRequest:5},qt={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,SwitchToSDR:4};class TT{constructor(e){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=e,this.log=O.log.bind(O,"[info]:"),this.warn=O.warn.bind(O,"[warning]:"),this.error=O.error.bind(O,"[error]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(L.ERROR,this.onError,this),e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(L.ERROR,this.onError,this),e.off(L.ERROR,this.onErrorOut,this),e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return(e==null?void 0:e.type)===Te.MAIN?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(e,t){var n,i;if(t.fatal)return;const a=this.hls,l=t.context;switch(t.details){case G.FRAG_LOAD_ERROR:case G.FRAG_LOAD_TIMEOUT:case G.KEY_LOAD_ERROR:case G.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case G.FRAG_PARSING_ERROR:if((n=t.frag)!=null&&n.gap){t.errorAction={action:ft.DoNothing,flags:qt.None};return}case G.FRAG_GAP:case G.FRAG_DECRYPT_ERROR:{t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=ft.SendAlternateToPenaltyBox;return}case G.LEVEL_EMPTY_ERROR:case G.LEVEL_PARSING_ERROR:{var u,f;const d=t.parent===Te.MAIN?t.level:a.loadLevel;t.details===G.LEVEL_EMPTY_ERROR&&((u=t.context)!=null&&(f=u.levelDetails)!=null&&f.live)?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,d):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,d))}return;case G.LEVEL_LOAD_ERROR:case G.LEVEL_LOAD_TIMEOUT:typeof(l==null?void 0:l.level)=="number"&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,l.level));return;case G.AUDIO_TRACK_LOAD_ERROR:case G.AUDIO_TRACK_LOAD_TIMEOUT:case G.SUBTITLE_LOAD_ERROR:case G.SUBTITLE_TRACK_LOAD_TIMEOUT:if(l){const d=a.levels[a.loadLevel];if(d&&(l.type===De.AUDIO_TRACK&&d.hasAudioGroup(l.groupId)||l.type===De.SUBTITLE_TRACK&&d.hasSubtitleGroup(l.groupId))){t.errorAction=this.getPlaylistRetryOrSwitchAction(t,a.loadLevel),t.errorAction.action=ft.SendAlternateToPenaltyBox,t.errorAction.flags=qt.MoveAllAlternatesMatchingHost;return}}return;case G.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const d=a.levels[a.loadLevel],p=d==null?void 0:d.attrs["HDCP-LEVEL"];p?t.errorAction={action:ft.SendAlternateToPenaltyBox,flags:qt.MoveAllAlternatesMatchingHDCP,hdcpLevel:p}:this.keySystemError(t)}return;case G.BUFFER_ADD_CODEC_ERROR:case G.REMUX_ALLOC_ERROR:case G.BUFFER_APPEND_ERROR:t.errorAction=this.getLevelSwitchAction(t,(i=t.level)!=null?i:a.loadLevel);return;case G.INTERNAL_EXCEPTION:case G.BUFFER_APPENDING_ERROR:case G.BUFFER_FULL_ERROR:case G.LEVEL_SWITCH_ERROR:case G.BUFFER_STALLED_ERROR:case G.BUFFER_SEEK_OVER_HOLE:case G.BUFFER_NUDGE_ON_STALL:t.errorAction={action:ft.DoNothing,flags:qt.None};return}t.type===Le.KEY_SYSTEM_ERROR&&this.keySystemError(t)}keySystemError(e){const t=this.getVariantLevelIndex(e.frag);e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,t)}getPlaylistRetryOrSwitchAction(e,t){const n=this.hls,i=op(n.config.playlistLoadPolicy,e),a=this.playlistError++;if(qa(i,a,Ya(e),e.response))return{action:ft.RetryRequest,flags:qt.None,retryConfig:i,retryCount:a};const u=this.getLevelSwitchAction(e,t);return i&&(u.retryConfig=i,u.retryCount=a),u}getFragRetryOrSwitchAction(e){const t=this.hls,n=this.getVariantLevelIndex(e.frag),i=t.levels[n],{fragLoadPolicy:a,keyLoadPolicy:l}=t.config,u=op(e.details.startsWith("key")?l:a,e),f=t.levels.reduce((p,m)=>p+m.fragmentError,0);if(i&&(e.details!==G.FRAG_GAP&&i.fragmentError++,qa(u,f,Ya(e),e.response)))return{action:ft.RetryRequest,flags:qt.None,retryConfig:u,retryCount:f};const d=this.getLevelSwitchAction(e,n);return u&&(d.retryConfig=u,d.retryCount=f),d}getLevelSwitchAction(e,t){const n=this.hls;t==null&&(t=n.loadLevel);const i=this.hls.levels[t];if(i){var a,l;const d=e.details;i.loadError++,d===G.BUFFER_APPEND_ERROR&&i.fragmentError++;let p=-1;const{levels:m,loadLevel:y,minAutoLevel:T,maxAutoLevel:v}=n;n.autoLevelEnabled||(n.loadLevel=-1);const x=(a=e.frag)==null?void 0:a.type,R=(x===Te.AUDIO&&d===G.FRAG_PARSING_ERROR||e.sourceBufferName==="audio"&&(d===G.BUFFER_ADD_CODEC_ERROR||d===G.BUFFER_APPEND_ERROR))&&m.some(({audioCodec:K})=>i.audioCodec!==K),w=e.sourceBufferName==="video"&&(d===G.BUFFER_ADD_CODEC_ERROR||d===G.BUFFER_APPEND_ERROR)&&m.some(({codecSet:K,audioCodec:U})=>i.codecSet!==K&&i.audioCodec===U),{type:b,groupId:_}=(l=e.context)!=null?l:{};for(let K=m.length;K--;){const U=(K+y)%m.length;if(U!==y&&U>=T&&U<=v&&m[U].loadError===0){var u,f;const z=m[U];if(d===G.FRAG_GAP&&x===Te.MAIN&&e.frag){const ee=m[U].details;if(ee){const V=Xa(e.frag,ee.fragments,e.frag.start);if(V!=null&&V.gap)continue}}else{if(b===De.AUDIO_TRACK&&z.hasAudioGroup(_)||b===De.SUBTITLE_TRACK&&z.hasSubtitleGroup(_))continue;if(x===Te.AUDIO&&(u=i.audioGroups)!=null&&u.some(ee=>z.hasAudioGroup(ee))||x===Te.SUBTITLE&&(f=i.subtitleGroups)!=null&&f.some(ee=>z.hasSubtitleGroup(ee))||R&&i.audioCodec===z.audioCodec||!R&&i.audioCodec!==z.audioCodec||w&&i.codecSet===z.codecSet)continue}p=U;break}}if(p>-1&&n.loadLevel!==p)return e.levelRetry=!0,this.playlistError=0,{action:ft.SendAlternateToPenaltyBox,flags:qt.None,nextAutoLevel:p}}return{action:ft.SendAlternateToPenaltyBox,flags:qt.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var n;switch((n=t.errorAction)==null?void 0:n.action){case ft.DoNothing:break;case ft.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==G.FRAG_GAP?t.fatal=!0:/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const t=this.hls,n=e.errorAction;if(!n)return;const{flags:i,hdcpLevel:a,nextAutoLevel:l}=n;switch(i){case qt.None:this.switchLevel(e,l);break;case qt.MoveAllAlternatesMatchingHDCP:a&&(t.maxHdcpLevel=ju[ju.indexOf(a)-1],n.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}n.resolved||this.switchLevel(e,l)}switchLevel(e,t){t!==void 0&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}}class mc{constructor(e,t){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=O.log.bind(O,`${t}:`),this.warn=O.warn.bind(O,`${t}:`),this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t,n){const i=t==null?void 0:t.renditionReports;if(i){let a=-1;for(let l=0;l<i.length;l++){const u=i[l];let f;try{f=new self.URL(u.URI,t.url).href}catch(d){O.warn(`Could not construct new URL for Rendition Report: ${d}`),f=u.URI||""}if(f===e){a=l;break}else f===e.substring(0,f.length)&&(a=l)}if(a!==-1){const l=i[a],u=parseInt(l["LAST-MSN"])||(t==null?void 0:t.lastPartSn);let f=parseInt(l["LAST-PART"])||(t==null?void 0:t.lastPartIndex);if(this.hls.config.lowLatencyMode){const p=Math.min(t.age-t.partTarget,t.targetduration);f>=0&&p>t.partTarget&&(f+=1)}const d=n&&rp(n);return new ip(u,f>=0?f:void 0,d)}}}loadPlaylist(e){this.requestScheduled===-1&&(this.requestScheduled=self.performance.now())}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}shouldReloadPlaylist(e){return this.timer===-1&&this.requestScheduled===-1&&this.shouldLoadPlaylist(e)}playlistLoaded(e,t,n){const{details:i,stats:a}=t,l=self.performance.now(),u=a.loading.first?Math.max(0,l-a.loading.first):0;if(i.advancedDateTime=Date.now()-u,i.live||n!=null&&n.live){if(i.reloaded(n),n&&this.log(`live playlist ${e} ${i.advanced?"REFRESHED "+i.lastPartSn+"-"+i.lastPartIndex:i.updated?"UPDATED":"MISSED"}`),n&&i.fragments.length>0&&uT(n,i),!this.canLoad||!i.live)return;let f,d,p;if(i.canBlockReload&&i.endSN&&i.advanced){const S=this.hls.config.lowLatencyMode,R=i.lastPartSn,I=i.endSN,w=i.lastPartIndex,b=w!==-1,_=R===I,K=S?0:w;b?(d=_?I+1:R,p=_?K:w+1):d=I+1;const U=i.age,z=U+i.ageHeader;let ee=Math.min(z-i.partTarget,i.targetduration*1.5);if(ee>0){if(n&&ee>n.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${n.tuneInGoal} to: ${ee} with playlist age: ${i.age}`),ee=0;else{const V=Math.floor(ee/i.targetduration);if(d+=V,p!==void 0){const Q=Math.round(ee%i.targetduration/i.partTarget);p+=Q}this.log(`CDN Tune-in age: ${i.ageHeader}s last advanced ${U.toFixed(2)}s goal: ${ee} skip sn ${V} to part ${p}`)}i.tuneInGoal=ee}if(f=this.getDeliveryDirectives(i,t.deliveryDirectives,d,p),S||!_){this.loadPlaylist(f);return}}else(i.canBlockReload||i.canSkipUntil)&&(f=this.getDeliveryDirectives(i,t.deliveryDirectives,d,p));const m=this.hls.mainForwardBufferInfo,y=m?m.end-m.len:0,T=(i.edge-y)*1e3,v=hT(i,T);i.updated&&l>this.requestScheduled+v&&(this.requestScheduled=a.loading.start),d!==void 0&&i.canBlockReload?this.requestScheduled=a.loading.first+v-(i.partTarget*1e3||1e3):this.requestScheduled===-1||this.requestScheduled+v<l?this.requestScheduled=l:this.requestScheduled-l<=0&&(this.requestScheduled+=v);let x=this.requestScheduled-l;x=Math.max(0,x),this.log(`reload live playlist ${e} in ${Math.round(x)} ms`),this.timer=self.setTimeout(()=>this.loadPlaylist(f),x)}else this.clearTimer()}getDeliveryDirectives(e,t,n,i){let a=rp(e);return t!=null&&t.skip&&e.deltaUpdateFailed&&(n=t.msn,i=t.part,a=Fa.No),new ip(n,i,a)}checkRetry(e){const t=e.details,n=Ya(e),i=e.errorAction,{action:a,retryCount:l=0,retryConfig:u}=i||{},f=!!i&&!!u&&(a===ft.RetryRequest||!i.resolved&&a===ft.SendAlternateToPenaltyBox);if(f){var d;if(this.requestScheduled=-1,l>=u.maxNumRetry)return!1;if(n&&(d=e.context)!=null&&d.deliveryDirectives)this.warn(`Retrying playlist loading ${l+1}/${u.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const p=pc(u,l);this.timer=self.setTimeout(()=>this.loadPlaylist(),p),this.warn(`Retrying playlist loading ${l+1}/${u.maxNumRetry} after "${t}" in ${p}ms`)}e.levelRetry=!0,i.resolved=!0}return f}}class jr{constructor(e,t=0,n=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=n}sample(e,t){const n=Math.pow(this.alpha_,e);this.estimate_=t*(1-n)+n*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class xT{constructor(e,t,n,i=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new jr(e),this.fast_=new jr(t),this.defaultTTFB_=i,this.ttfb_=new jr(e)}update(e,t){const{slow_:n,fast_:i,ttfb_:a}=this;n.halfLife!==e&&(this.slow_=new jr(e,n.getEstimate(),n.getTotalWeight())),i.halfLife!==t&&(this.fast_=new jr(t,i.getEstimate(),i.getTotalWeight())),a.halfLife!==e&&(this.ttfb_=new jr(e,a.getEstimate(),a.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);const n=8*t,i=e/1e3,a=n/i;this.fast_.sample(i,a),this.slow_.sample(i,a)}sampleTTFB(e){const t=e/1e3,n=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(n,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}destroy(){}}const bm={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]},up={};function ST(o,e,t,n,i,a){const l=o.audioCodec?o.audioGroups:null,u=a==null?void 0:a.audioCodec,f=a==null?void 0:a.channels,d=f?parseInt(f):u?1/0:2;let p=null;if(l!=null&&l.length)try{l.length===1&&l[0]?p=e.groups[l[0]].channels:p=l.reduce((m,y)=>{if(y){const T=e.groups[y];if(!T)throw new Error(`Audio track group ${y} not found`);Object.keys(T.channels).forEach(v=>{m[v]=(m[v]||0)+T.channels[v]})}return m},{2:0})}catch{return!0}return o.videoCodec!==void 0&&(o.width>1920&&o.height>1088||o.height>1920&&o.width>1088||o.frameRate>Math.max(n,30)||o.videoRange!=="SDR"&&o.videoRange!==t||o.bitrate>Math.max(i,8e6))||!!p&&oe(d)&&Object.keys(p).some(m=>parseInt(m)>d)}function LT(o,e,t){const n=o.videoCodec,i=o.audioCodec;if(!n||!i||!t)return Promise.resolve(bm);const a={width:o.width,height:o.height,bitrate:Math.ceil(Math.max(o.bitrate*.9,o.averageBitrate)),framerate:o.frameRate||30},l=o.videoRange;l!=="SDR"&&(a.transferFunction=l.toLowerCase());const u=n.split(",").map(f=>({type:"media-source",video:lt(lt({},a),{},{contentType:es(f,"video")})}));return i&&o.audioGroups&&o.audioGroups.forEach(f=>{var d;f&&((d=e.groups[f])==null||d.tracks.forEach(p=>{if(p.groupId===f){const m=p.channels||"",y=parseFloat(m);oe(y)&&y>2&&u.push.apply(u,i.split(",").map(T=>({type:"media-source",audio:{contentType:es(T,"audio"),channels:""+y}})))}}))}),Promise.all(u.map(f=>{const d=AT(f);return up[d]||(up[d]=t.decodingInfo(f))})).then(f=>({supported:!f.some(d=>!d.supported),configurations:u,decodingInfoResults:f})).catch(f=>({supported:!1,configurations:u,decodingInfoResults:[],error:f}))}function AT(o){const{audio:e,video:t}=o,n=t||e;if(n){const i=n.contentType.split('"')[1];if(t)return`r${t.height}x${t.width}f${Math.ceil(t.framerate)}${t.transferFunction||"sd"}_${i}_${Math.ceil(t.bitrate/1e5)}`;if(e)return`c${e.channels}${e.spatialRendering?"s":"n"}_${i}`}return""}function RT(){if(typeof matchMedia=="function"){const o=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(o.media!==e.media)return o.matches===!0}return!1}function wT(o,e){let t=!1,n=[];return o&&(t=o!=="SDR",n=[o]),e&&(n=e.allowedVideoRanges||Wa.slice(0),t=e.preferHDR!==void 0?e.preferHDR:RT(),t?n=n.filter(i=>i!=="SDR"):n=["SDR"]),{preferHDR:t,allowedVideoRanges:n}}function CT(o,e,t,n,i){const a=Object.keys(o),l=n==null?void 0:n.channels,u=n==null?void 0:n.audioCodec,f=l&&parseInt(l)===2;let d=!0,p=!1,m=1/0,y=1/0,T=1/0,v=0,x=[];const{preferHDR:S,allowedVideoRanges:R}=wT(e,i);for(let _=a.length;_--;){const K=o[a[_]];d=K.channels[2]>0,m=Math.min(m,K.minHeight),y=Math.min(y,K.minFramerate),T=Math.min(T,K.minBitrate);const U=R.filter(z=>K.videoRanges[z]>0);U.length>0&&(p=!0,x=U)}m=oe(m)?m:0,y=oe(y)?y:0;const I=Math.max(1080,m),w=Math.max(30,y);return T=oe(T)?T:t,t=Math.max(T,t),p||(e=void 0,x=[]),{codecSet:a.reduce((_,K)=>{const U=o[K];if(K===_)return _;if(U.minBitrate>t)return Ln(K,`min bitrate of ${U.minBitrate} > current estimate of ${t}`),_;if(!U.hasDefaultAudio)return Ln(K,"no renditions with default or auto-select sound found"),_;if(u&&K.indexOf(u.substring(0,4))%5!==0)return Ln(K,`audio codec preference "${u}" not found`),_;if(l&&!f){if(!U.channels[l])return Ln(K,`no renditions with ${l} channel sound found (channels options: ${Object.keys(U.channels)})`),_}else if((!u||f)&&d&&U.channels[2]===0)return Ln(K,"no renditions with stereo sound found"),_;return U.minHeight>I?(Ln(K,`min resolution of ${U.minHeight} > maximum of ${I}`),_):U.minFramerate>w?(Ln(K,`min framerate of ${U.minFramerate} > maximum of ${w}`),_):x.some(z=>U.videoRanges[z]>0)?U.maxScore<v?(Ln(K,`max score of ${U.maxScore} < selected max of ${v}`),_):_&&(ja(K)>=ja(_)||U.fragmentError>o[_].fragmentError)?_:(v=U.maxScore,K):(Ln(K,`no variants with VIDEO-RANGE of ${JSON.stringify(x)} found`),_)},void 0),videoRanges:x,preferHDR:S,minFramerate:y,minBitrate:T}}function Ln(o,e){O.log(`[abr] start candidates with "${o}" ignored because ${e}`)}function IT(o){return o.reduce((e,t)=>{let n=e.groups[t.groupId];n||(n=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),n.tracks.push(t);const i=t.channels||"2";return n.channels[i]=(n.channels[i]||0)+1,n.hasDefault=n.hasDefault||t.default,n.hasAutoSelect=n.hasAutoSelect||t.autoselect,n.hasDefault&&(e.hasDefaultAudio=!0),n.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function kT(o,e,t,n){return o.slice(t,n+1).reduce((i,a)=>{if(!a.codecSet)return i;const l=a.audioGroups;let u=i[a.codecSet];u||(i[a.codecSet]=u={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!l,fragmentError:0}),u.minBitrate=Math.min(u.minBitrate,a.bitrate);const f=Math.min(a.height,a.width);return u.minHeight=Math.min(u.minHeight,f),u.minFramerate=Math.min(u.minFramerate,a.frameRate),u.maxScore=Math.max(u.maxScore,a.score),u.fragmentError+=a.fragmentError,u.videoRanges[a.videoRange]=(u.videoRanges[a.videoRange]||0)+1,l&&l.forEach(d=>{if(!d)return;const p=e.groups[d];p&&(u.hasDefaultAudio=u.hasDefaultAudio||e.hasDefaultAudio?p.hasDefault:p.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys(p.channels).forEach(m=>{u.channels[m]=(u.channels[m]||0)+p.channels[m]}))}),i},{})}function un(o,e,t){if("attrs"in o){const n=e.indexOf(o);if(n!==-1)return n}for(let n=0;n<e.length;n++){const i=e[n];if(yr(o,i,t))return n}return-1}function yr(o,e,t){const{groupId:n,name:i,lang:a,assocLang:l,default:u}=o,f=o.forced;return(n===void 0||e.groupId===n)&&(i===void 0||e.name===i)&&(a===void 0||e.lang===a)&&(a===void 0||e.assocLang===l)&&(u===void 0||e.default===u)&&(f===void 0||e.forced===f)&&(!("characteristics"in o)||DT(o.characteristics||"",e.characteristics))&&(t===void 0||t(o,e))}function DT(o,e=""){const t=o.split(","),n=e.split(",");return t.length===n.length&&!t.some(i=>n.indexOf(i)===-1)}function pr(o,e){const{audioCodec:t,channels:n}=o;return(t===void 0||(e.audioCodec||"").substring(0,4)===t.substring(0,4))&&(n===void 0||n===(e.channels||"2"))}function _T(o,e,t,n,i){const a=e[n],u=e.reduce((y,T,v)=>{const x=T.uri;return(y[x]||(y[x]=[])).push(v),y},{})[a.uri];u.length>1&&(n=Math.max.apply(Math,u));const f=a.videoRange,d=a.frameRate,p=a.codecSet.substring(0,4),m=cp(e,n,y=>{if(y.videoRange!==f||y.frameRate!==d||y.codecSet.substring(0,4)!==p)return!1;const T=y.audioGroups,v=t.filter(x=>!T||T.indexOf(x.groupId)!==-1);return un(o,v,i)>-1});return m>-1?m:cp(e,n,y=>{const T=y.audioGroups,v=t.filter(x=>!T||T.indexOf(x.groupId)!==-1);return un(o,v,i)>-1})}function cp(o,e,t){for(let n=e;n>-1;n--)if(t(o[n]))return n;for(let n=e+1;n<o.length;n++)if(t(o[n]))return n;return-1}class PT{constructor(e){this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this._abandonRulesCheck=()=>{const{fragCurrent:t,partCurrent:n,hls:i}=this,{autoLevelEnabled:a,media:l}=i;if(!t||!l)return;const u=performance.now(),f=n?n.stats:t.stats,d=n?n.duration:t.duration,p=u-f.loading.start,m=i.minAutoLevel;if(f.aborted||f.loaded&&f.loaded===f.total||t.level<=m){this.clearTimer(),this._nextAutoLevel=-1;return}if(!a||l.paused||!l.playbackRate||!l.readyState)return;const y=i.mainForwardBufferInfo;if(y===null)return;const T=this.bwEstimator.getEstimateTTFB(),v=Math.abs(l.playbackRate);if(p<=Math.max(T,1e3*(d/(v*2))))return;const x=y.len/v,S=f.loading.first?f.loading.first-f.loading.start:-1,R=f.loaded&&S>-1,I=this.getBwEstimate(),w=i.levels,b=w[t.level],_=f.total||Math.max(f.loaded,Math.round(d*b.averageBitrate/8));let K=R?p-S:p;K<1&&R&&(K=Math.min(p,f.loaded*8/I));const U=R?f.loaded*1e3/K:0,z=U?(_-f.loaded)/U:_*8/I+T/1e3;if(z<=x)return;const ee=U?U*8:I;let V=Number.POSITIVE_INFINITY,Q;for(Q=t.level-1;Q>m;Q--){const re=w[Q].maxBitrate;if(V=this.getTimeToLoadFrag(T/1e3,ee,d*re,!w[Q].details),V<x)break}if(V>=z||V>d*10)return;i.nextLoadLevel=i.nextAutoLevel=Q,R?this.bwEstimator.sample(p-Math.min(T,S),f.loaded):this.bwEstimator.sampleTTFB(p);const ge=w[Q].maxBitrate;this.getBwEstimate()*this.hls.config.abrBandWidthUpFactor>ge&&this.resetEstimator(ge),this.clearTimer(),O.warn(`[abr] Fragment ${t.sn}${n?" part "+n.index:""} of level ${t.level} is loading too slowly;
      Time to underbuffer: ${x.toFixed(3)} s
      Estimated load time for current fragment: ${z.toFixed(3)} s
      Estimated load time for down switch fragment: ${V.toFixed(3)} s
      TTFB estimate: ${S|0} ms
      Current BW estimate: ${oe(I)?I|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${Q} @ ${ge|0} bps`),i.trigger(L.FRAG_LOAD_EMERGENCY_ABORTED,{frag:t,part:n,stats:f})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(O.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new xT(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.FRAG_LOADING,this.onFragLoading,this),e.on(L.FRAG_LOADED,this.onFragLoaded,this),e.on(L.FRAG_BUFFERED,this.onFragBuffered,this),e.on(L.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(L.LEVEL_LOADED,this.onLevelLoaded,this),e.on(L.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(L.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(L.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.FRAG_LOADING,this.onFragLoading,this),e.off(L.FRAG_LOADED,this.onFragLoaded,this),e.off(L.FRAG_BUFFERED,this.onFragBuffered,this),e.off(L.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(L.LEVEL_LOADED,this.onLevelLoaded,this),e.off(L.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(L.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(L.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){const n=t.frag;if(!this.ignoreFragment(n)){if(!n.bitrateTest){var i;this.fragCurrent=n,this.partCurrent=(i=t.part)!=null?i:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case G.BUFFER_ADD_CODEC_ERROR:case G.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case G.FRAG_LOAD_TIMEOUT:{const n=t.frag,{fragCurrent:i,partCurrent:a}=this;if(n&&i&&n.sn===i.sn&&n.level===i.level){const l=performance.now(),u=a?a.stats:n.stats,f=l-u.loading.start,d=u.loading.first?u.loading.first-u.loading.start:-1;if(u.loaded&&d>-1){const m=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(f-Math.min(m,d),u.loaded)}else this.bwEstimator.sampleTTFB(f)}break}}}getTimeToLoadFrag(e,t,n,i){const a=e+n/t,l=i?this.lastLevelLoadSec:0;return a+l}onLevelLoaded(e,t){const n=this.hls.config,{loading:i}=t.stats,a=i.end-i.start;oe(a)&&(this.lastLevelLoadSec=a/1e3),t.details.live?this.bwEstimator.update(n.abrEwmaSlowLive,n.abrEwmaFastLive):this.bwEstimator.update(n.abrEwmaSlowVoD,n.abrEwmaFastVoD)}onFragLoaded(e,{frag:t,part:n}){const i=n?n.stats:t.stats;if(t.type===Te.MAIN&&this.bwEstimator.sampleTTFB(i.loading.first-i.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),t.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const a=n?n.duration:t.duration,l=this.hls.levels[t.level],u=(l.loaded?l.loaded.bytes:0)+i.loaded,f=(l.loaded?l.loaded.duration:0)+a;l.loaded={bytes:u,duration:f},l.realBitrate=Math.round(8*u/f)}if(t.bitrateTest){const a={stats:i,frag:t,part:n,id:t.type};this.onFragBuffered(L.FRAG_BUFFERED,a),t.bitrateTest=!1}else this.lastLoadedFragLevel=t.level}}onFragBuffered(e,t){const{frag:n,part:i}=t,a=i!=null&&i.stats.loaded?i.stats:n.stats;if(a.aborted||this.ignoreFragment(n))return;const l=a.parsing.end-a.loading.start-Math.min(a.loading.first-a.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(l,a.loaded),a.bwEstimate=this.getBwEstimate(),n.bitrateTest?this.bitrateTestDelay=l/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==Te.MAIN||e.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:t}=this.hls,n=this.getBwEstimate(),i=this.hls.config.maxStarvationDelay,a=this.findBestLevel(n,t,e,0,i,1,1);if(a>-1)return a;const l=this.hls.firstLevel,u=Math.min(Math.max(l,t),e);return O.warn(`[abr] Could not find best starting auto level. Defaulting to first in playlist ${l} clamped to ${u}`),u}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,n=this.bwEstimator.canEstimate(),i=this.lastLoadedFragLevel>-1;if(e!==-1&&(!n||!i||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const a=n&&i?this.getNextABRAutoLevel():this.firstAutoLevel;if(e!==-1){const l=this.hls.levels;if(l.length>Math.max(e,a)&&l[e].loadError<=l[a].loadError)return e}return this._nextAutoLevel=a,this.nextAutoLevelKey=this.getAutoLevelKey(),a}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:n}=this,{maxAutoLevel:i,config:a,minAutoLevel:l}=n,u=t?t.duration:e?e.duration:0,f=this.getBwEstimate(),d=this.getStarvationDelay();let p=a.abrBandWidthFactor,m=a.abrBandWidthUpFactor;if(d){const S=this.findBestLevel(f,l,i,d,0,p,m);if(S>=0)return S}let y=u?Math.min(u,a.maxStarvationDelay):a.maxStarvationDelay;if(!d){const S=this.bitrateTestDelay;S&&(y=(u?Math.min(u,a.maxLoadingDelay):a.maxLoadingDelay)-S,O.info(`[abr] bitrate test took ${Math.round(1e3*S)}ms, set first fragment max fetchDuration to ${Math.round(1e3*y)} ms`),p=m=1)}const T=this.findBestLevel(f,l,i,d,y,p,m);if(O.info(`[abr] ${d?"rebuffering expected":"buffer is empty"}, optimal quality level ${T}`),T>-1)return T;const v=n.levels[l],x=n.levels[n.loadLevel];return(v==null?void 0:v.bitrate)<(x==null?void 0:x.bitrate)?l:n.loadLevel}getStarvationDelay(){const e=this.hls,t=e.media;if(!t)return 1/0;const n=t&&t.playbackRate!==0?Math.abs(t.playbackRate):1,i=e.mainForwardBufferInfo;return(i?i.len:0)/n}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,n,i,a,l,u){var f;const d=i+a,p=this.lastLoadedFragLevel,m=p===-1?this.hls.firstLevel:p,{fragCurrent:y,partCurrent:T}=this,{levels:v,allAudioTracks:x,loadLevel:S,config:R}=this.hls;if(v.length===1)return 0;const I=v[m],w=!!(I!=null&&(f=I.details)!=null&&f.live),b=S===-1||p===-1;let _,K="SDR",U=(I==null?void 0:I.frameRate)||0;const{audioPreference:z,videoPreference:ee}=R,V=this.audioTracksByGroup||(this.audioTracksByGroup=IT(x));if(b){if(this.firstSelection!==-1)return this.firstSelection;const pe=this.codecTiers||(this.codecTiers=kT(v,V,t,n)),le=CT(pe,K,e,z,ee),{codecSet:me,videoRanges:J,minFramerate:W,minBitrate:H,preferHDR:D}=le;_=me,K=D?J[J.length-1]:J[0],U=W,e=Math.max(e,H),O.log(`[abr] picked start tier ${JSON.stringify(le)}`)}else _=I==null?void 0:I.codecSet,K=I==null?void 0:I.videoRange;const Q=T?T.duration:y?y.duration:0,ge=this.bwEstimator.getEstimateTTFB()/1e3,re=[];for(let pe=n;pe>=t;pe--){var he;const le=v[pe],me=pe>m;if(!le)continue;if(R.useMediaCapabilities&&!le.supportedResult&&!le.supportedPromise){const de=navigator.mediaCapabilities;typeof(de==null?void 0:de.decodingInfo)=="function"&&ST(le,V,K,U,e,z)?(le.supportedPromise=LT(le,V,de),le.supportedPromise.then(xe=>{if(!this.hls)return;le.supportedResult=xe;const Se=this.hls.levels,Ce=Se.indexOf(le);xe.error?O.warn(`[abr] MediaCapabilities decodingInfo error: "${xe.error}" for level ${Ce} ${JSON.stringify(xe)}`):xe.supported||(O.warn(`[abr] Unsupported MediaCapabilities decodingInfo result for level ${Ce} ${JSON.stringify(xe)}`),Ce>-1&&Se.length>1&&(O.log(`[abr] Removing unsupported level ${Ce}`),this.hls.removeLevel(Ce)))})):le.supportedResult=bm}if(_&&le.codecSet!==_||K&&le.videoRange!==K||me&&U>le.frameRate||!me&&U>0&&U<le.frameRate||le.supportedResult&&!((he=le.supportedResult.decodingInfoResults)!=null&&he[0].smooth)){re.push(pe);continue}const J=le.details,W=(T?J==null?void 0:J.partTarget:J==null?void 0:J.averagetargetduration)||Q;let H;me?H=u*e:H=l*e;const D=Q&&i>=Q*2&&a===0?v[pe].averageBitrate:v[pe].maxBitrate,$=this.getTimeToLoadFrag(ge,H,D*W,J===void 0);if(H>=D&&(pe===p||le.loadError===0&&le.fragmentError===0)&&($<=ge||!oe($)||w&&!this.bitrateTestDelay||$<d)){const de=this.forcedAutoLevel;return pe!==S&&(de===-1||de!==S)&&(re.length&&O.trace(`[abr] Skipped level(s) ${re.join(",")} of ${n} max with CODECS and VIDEO-RANGE:"${v[re[0]].codecs}" ${v[re[0]].videoRange}; not compatible with "${I.codecs}" ${K}`),O.info(`[abr] switch candidate:${m}->${pe} adjustedbw(${Math.round(H)})-bitrate=${Math.round(H-D)} ttfb:${ge.toFixed(1)} avgDuration:${W.toFixed(1)} maxFetchDuration:${d.toFixed(1)} fetchDuration:${$.toFixed(1)} firstSelection:${b} codecSet:${_} videoRange:${K} hls.loadLevel:${S}`)),b&&(this.firstSelection=pe),pe}}return-1}set nextAutoLevel(e){const{maxAutoLevel:t,minAutoLevel:n}=this.hls,i=Math.min(Math.max(e,n),t);this._nextAutoLevel!==i&&(this.nextAutoLevelKey="",this._nextAutoLevel=i)}}class bT{constructor(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}var ot={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class OT{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(L.BUFFER_APPENDED,this.onBufferAppended,this),e.on(L.FRAG_BUFFERED,this.onFragBuffered,this),e.on(L.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:e}=this;e.off(L.BUFFER_APPENDED,this.onBufferAppended,this),e.off(L.FRAG_BUFFERED,this.onFragBuffered,this),e.off(L.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const n=this.activePartLists[t];if(n)for(let i=n.length;i--;){const a=n[i];if(!a)break;const l=a.end;if(a.start<=e&&l!==null&&e<=l)return a}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){const{fragments:n}=this,i=Object.keys(n);for(let a=i.length;a--;){const l=n[i[a]];if((l==null?void 0:l.body.type)===t&&l.buffered){const u=l.body;if(u.start<=e&&e<=u.end)return u}}return null}detectEvictedFragments(e,t,n,i){this.timeRanges&&(this.timeRanges[e]=t);const a=(i==null?void 0:i.fragment.sn)||-1;Object.keys(this.fragments).forEach(l=>{const u=this.fragments[l];if(!u||a>=u.body.sn)return;if(!u.buffered&&!u.loaded){u.body.type===n&&this.removeFragment(u.body);return}const f=u.range[e];f&&f.time.some(d=>{const p=!this.isTimeBuffered(d.startPTS,d.endPTS,t);return p&&this.removeFragment(u.body),p})})}detectPartialFragments(e){const t=this.timeRanges,{frag:n,part:i}=e;if(!t||n.sn==="initSegment")return;const a=zr(n),l=this.fragments[a];if(!l||l.buffered&&n.gap)return;const u=!n.relurl;Object.keys(t).forEach(f=>{const d=n.elementaryStreams[f];if(!d)return;const p=t[f],m=u||d.partial===!0;l.range[f]=this.getBufferedTimes(n,i,m,p)}),l.loaded=null,Object.keys(l.range).length?(l.buffered=!0,(l.body.endList=n.endList||l.body.endList)&&(this.endListFragments[l.body.type]=l),Aa(l)||this.removeParts(n.sn-1,n.type)):this.removeFragment(l.body)}removeParts(e,t){const n=this.activePartLists[t];n&&(this.activePartLists[t]=n.filter(i=>i.fragment.sn>=e))}fragBuffered(e,t){const n=zr(e);let i=this.fragments[n];!i&&t&&(i=this.fragments[n]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),i&&(i.loaded=null,i.buffered=!0)}getBufferedTimes(e,t,n,i){const a={time:[],partial:n},l=e.start,u=e.end,f=e.minEndPTS||u,d=e.maxStartPTS||l;for(let p=0;p<i.length;p++){const m=i.start(p)-this.bufferPadding,y=i.end(p)+this.bufferPadding;if(d>=m&&f<=y){a.time.push({startPTS:Math.max(l,i.start(p)),endPTS:Math.min(u,i.end(p))});break}else if(l<y&&u>m){const T=Math.max(l,i.start(p)),v=Math.min(u,i.end(p));v>T&&(a.partial=!0,a.time.push({startPTS:T,endPTS:v}))}else if(u<=m)break}return a}getPartialFragment(e){let t=null,n,i,a,l=0;const{bufferPadding:u,fragments:f}=this;return Object.keys(f).forEach(d=>{const p=f[d];p&&Aa(p)&&(i=p.body.start-u,a=p.body.end+u,e>=i&&e<=a&&(n=Math.min(e-i,a-e),l<=n&&(t=p.body,l=n)))}),t}isEndListAppended(e){const t=this.endListFragments[e];return t!==void 0&&(t.buffered||Aa(t))}getState(e){const t=zr(e),n=this.fragments[t];return n?n.buffered?Aa(n)?ot.PARTIAL:ot.OK:ot.APPENDING:ot.NOT_LOADED}isTimeBuffered(e,t,n){let i,a;for(let l=0;l<n.length;l++){if(i=n.start(l)-this.bufferPadding,a=n.end(l)+this.bufferPadding,e>=i&&t<=a)return!0;if(t<=i)return!1}return!1}onFragLoaded(e,t){const{frag:n,part:i}=t;if(n.sn==="initSegment"||n.bitrateTest)return;const a=i?null:t,l=zr(n);this.fragments[l]={body:n,appendedPTS:null,loaded:a,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:n,part:i,timeRanges:a}=t;if(n.sn==="initSegment")return;const l=n.type;if(i){let u=this.activePartLists[l];u||(this.activePartLists[l]=u=[]),u.push(i)}this.timeRanges=a,Object.keys(a).forEach(u=>{const f=a[u];this.detectEvictedFragments(u,f,l,i)})}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=zr(e);return!!this.fragments[t]}hasParts(e){var t;return!!((t=this.activePartLists[e])!=null&&t.length)}removeFragmentsInRange(e,t,n,i,a){i&&!this.hasGaps||Object.keys(this.fragments).forEach(l=>{const u=this.fragments[l];if(!u)return;const f=u.body;f.type!==n||i&&!f.gap||f.start<t&&f.end>e&&(u.buffered||a)&&this.removeFragment(f)})}removeFragment(e){const t=zr(e);e.stats.loaded=0,e.clearElementaryStreamInfo();const n=this.activePartLists[e.type];if(n){const i=e.sn;this.activePartLists[e.type]=n.filter(a=>a.fragment.sn!==i)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1}}function Aa(o){var e,t,n;return o.buffered&&(o.body.gap||((e=o.range.video)==null?void 0:e.partial)||((t=o.range.audio)==null?void 0:t.partial)||((n=o.range.audiovideo)==null?void 0:n.partial))}function zr(o){return`${o.type}_${o.level}_${o.sn}`}const FT={length:0,start:()=>0,end:()=>0};class Ue{static isBuffered(e,t){try{if(e){const n=Ue.getBuffered(e);for(let i=0;i<n.length;i++)if(t>=n.start(i)&&t<=n.end(i))return!0}}catch{}return!1}static bufferInfo(e,t,n){try{if(e){const i=Ue.getBuffered(e),a=[];let l;for(l=0;l<i.length;l++)a.push({start:i.start(l),end:i.end(l)});return this.bufferedInfo(a,t,n)}}catch{}return{len:0,start:t,end:t,nextStart:void 0}}static bufferedInfo(e,t,n){t=Math.max(0,t),e.sort(function(d,p){const m=d.start-p.start;return m||p.end-d.end});let i=[];if(n)for(let d=0;d<e.length;d++){const p=i.length;if(p){const m=i[p-1].end;e[d].start-m<n?e[d].end>m&&(i[p-1].end=e[d].end):i.push(e[d])}else i.push(e[d])}else i=e;let a=0,l,u=t,f=t;for(let d=0;d<i.length;d++){const p=i[d].start,m=i[d].end;if(t+n>=p&&t<m)u=p,f=m,a=f-t;else if(t+n<p){l=p;break}}return{len:a,start:u||0,end:f||0,nextStart:l}}static getBuffered(e){try{return e.buffered}catch(t){return O.log("failed to get media.buffered",t),FT}}}class gc{constructor(e,t,n,i=0,a=-1,l=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=Ra(),this.buffering={audio:Ra(),video:Ra(),audiovideo:Ra()},this.level=e,this.sn=t,this.id=n,this.size=i,this.part=a,this.partial=l}}function Ra(){return{start:0,executeStart:0,executeEnd:0,end:0}}function Na(o,e){for(let n=0,i=o.length;n<i;n++){var t;if(((t=o[n])==null?void 0:t.cc)===e)return o[n]}return null}function NT(o,e,t){return!!(e&&(t.endCC>t.startCC||o&&o.cc<t.startCC))}function MT(o,e){const t=o.fragments,n=e.fragments;if(!n.length||!t.length){O.log("No fragments to align");return}const i=Na(t,n[0].cc);if(!i||i&&!i.startPTS){O.log("No frag in previous level to align on");return}return i}function fp(o,e){if(o){const t=o.start+e;o.start=o.startPTS=t,o.endPTS=t+o.duration}}function Om(o,e){const t=e.fragments;for(let n=0,i=t.length;n<i;n++)fp(t[n],o);e.fragmentHint&&fp(e.fragmentHint,o),e.alignedSliding=!0}function UT(o,e,t){e&&(BT(o,t,e),!t.alignedSliding&&e&&Qa(t,e),!t.alignedSliding&&e&&!t.skippedSegments&&km(e,t))}function BT(o,e,t){if(NT(o,t,e)){const n=MT(t,e);n&&oe(n.start)&&(O.log(`Adjusting PTS using last level due to CC increase within current level ${e.url}`),Om(n.start,e))}}function Qa(o,e){if(!o.hasProgramDateTime||!e.hasProgramDateTime)return;const t=o.fragments,n=e.fragments;if(!t.length||!n.length)return;let i,a;const l=Math.min(e.endCC,o.endCC);e.startCC<l&&o.startCC<l&&(i=Na(n,l),a=Na(t,l)),(!i||!a)&&(i=n[Math.floor(n.length/2)],a=Na(t,i.cc)||t[Math.floor(t.length/2)]);const u=i.programDateTime,f=a.programDateTime;if(!u||!f)return;const d=(f-u)/1e3-(a.start-i.start);Om(d,o)}const dp=Math.pow(2,17);class $T{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const n=e.url;if(!n)return Promise.reject(new wn({type:Le.NETWORK_ERROR,details:G.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${n?"part list":"url"}`),networkDetails:null}));this.abort();const i=this.config,a=i.fLoader,l=i.loader;return new Promise((u,f)=>{if(this.loader&&this.loader.destroy(),e.gap)if(e.tagList.some(T=>T[0]==="GAP")){f(pp(e));return}else e.gap=!1;const d=this.loader=e.loader=a?new a(i):new l(i),p=hp(e),m=lp(i.fragLoadPolicy.default),y={loadPolicy:m,timeout:m.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:dp};e.stats=d.stats,d.load(p,y,{onSuccess:(T,v,x,S)=>{this.resetLoader(e,d);let R=T.data;x.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(R.slice(0,16)),R=R.slice(16)),u({frag:e,part:null,payload:R,networkDetails:S})},onError:(T,v,x,S)=>{this.resetLoader(e,d),f(new wn({type:Le.NETWORK_ERROR,details:G.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:lt({url:n,data:void 0},T),error:new Error(`HTTP Error ${T.code} ${T.text}`),networkDetails:x,stats:S}))},onAbort:(T,v,x)=>{this.resetLoader(e,d),f(new wn({type:Le.NETWORK_ERROR,details:G.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:x,stats:T}))},onTimeout:(T,v,x)=>{this.resetLoader(e,d),f(new wn({type:Le.NETWORK_ERROR,details:G.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${y.timeout}ms`),networkDetails:x,stats:T}))},onProgress:(T,v,x,S)=>{t&&t({frag:e,part:null,payload:x,networkDetails:S})}})})}loadPart(e,t,n){this.abort();const i=this.config,a=i.fLoader,l=i.loader;return new Promise((u,f)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){f(pp(e,t));return}const d=this.loader=e.loader=a?new a(i):new l(i),p=hp(e,t),m=lp(i.fragLoadPolicy.default),y={loadPolicy:m,timeout:m.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:dp};t.stats=d.stats,d.load(p,y,{onSuccess:(T,v,x,S)=>{this.resetLoader(e,d),this.updateStatsFromPart(e,t);const R={frag:e,part:t,payload:T.data,networkDetails:S};n(R),u(R)},onError:(T,v,x,S)=>{this.resetLoader(e,d),f(new wn({type:Le.NETWORK_ERROR,details:G.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:lt({url:p.url,data:void 0},T),error:new Error(`HTTP Error ${T.code} ${T.text}`),networkDetails:x,stats:S}))},onAbort:(T,v,x)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,d),f(new wn({type:Le.NETWORK_ERROR,details:G.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:x,stats:T}))},onTimeout:(T,v,x)=>{this.resetLoader(e,d),f(new wn({type:Le.NETWORK_ERROR,details:G.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${y.timeout}ms`),networkDetails:x,stats:T}))}})})}updateStatsFromPart(e,t){const n=e.stats,i=t.stats,a=i.total;if(n.loaded+=i.loaded,a){const f=Math.round(e.duration/t.duration),d=Math.min(Math.round(n.loaded/a),f),m=(f-d)*Math.round(n.loaded/d);n.total=n.loaded+m}else n.total=Math.max(n.loaded,n.total);const l=n.loading,u=i.loading;l.start?l.first+=u.first-u.start:(l.start=u.start,l.first=u.first),l.end=u.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function hp(o,e=null){const t=e||o,n={frag:o,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},i=t.byteRangeStartOffset,a=t.byteRangeEndOffset;if(oe(i)&&oe(a)){var l;let u=i,f=a;if(o.sn==="initSegment"&&((l=o.decryptdata)==null?void 0:l.method)==="AES-128"){const d=a-i;d%16&&(f=a+(16-d%16)),i!==0&&(n.resetIV=!0,u=i-16)}n.rangeStart=u,n.rangeEnd=f}return n}function pp(o,e){const t=new Error(`GAP ${o.gap?"tag":"attribute"} found`),n={type:Le.MEDIA_ERROR,details:G.FRAG_GAP,fatal:!1,frag:o,error:t,networkDetails:null};return e&&(n.part=e),(e||o).stats.aborted=!0,new wn(n)}class wn extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class GT{constructor(e,t){this.subtle=void 0,this.aesIV=void 0,this.subtle=e,this.aesIV=t}decrypt(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)}}class HT{constructor(e,t){this.subtle=void 0,this.key=void 0,this.subtle=e,this.key=t}expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}function VT(o){const e=o.byteLength,t=e&&new DataView(o.buffer).getUint8(e-1);return t?gr(o,0,e-t):o}class KT{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),n=new Uint32Array(4);for(let i=0;i<4;i++)n[i]=t.getUint32(i*4);return n}initTable(){const e=this.sBox,t=this.invSBox,n=this.subMix,i=n[0],a=n[1],l=n[2],u=n[3],f=this.invSubMix,d=f[0],p=f[1],m=f[2],y=f[3],T=new Uint32Array(256);let v=0,x=0,S=0;for(S=0;S<256;S++)S<128?T[S]=S<<1:T[S]=S<<1^283;for(S=0;S<256;S++){let R=x^x<<1^x<<2^x<<3^x<<4;R=R>>>8^R&255^99,e[v]=R,t[R]=v;const I=T[v],w=T[I],b=T[w];let _=T[R]*257^R*16843008;i[v]=_<<24|_>>>8,a[v]=_<<16|_>>>16,l[v]=_<<8|_>>>24,u[v]=_,_=b*16843009^w*65537^I*257^v*16843008,d[R]=_<<24|_>>>8,p[R]=_<<16|_>>>16,m[R]=_<<8|_>>>24,y[R]=_,v?(v=I^T[T[T[b^I]]],x^=T[T[x]]):v=x=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let n=!0,i=0;for(;i<t.length&&n;)n=t[i]===this.key[i],i++;if(n)return;this.key=t;const a=this.keySize=t.length;if(a!==4&&a!==6&&a!==8)throw new Error("Invalid aes key size="+a);const l=this.ksRows=(a+6+1)*4;let u,f;const d=this.keySchedule=new Uint32Array(l),p=this.invKeySchedule=new Uint32Array(l),m=this.sBox,y=this.rcon,T=this.invSubMix,v=T[0],x=T[1],S=T[2],R=T[3];let I,w;for(u=0;u<l;u++){if(u<a){I=d[u]=t[u];continue}w=I,u%a===0?(w=w<<8|w>>>24,w=m[w>>>24]<<24|m[w>>>16&255]<<16|m[w>>>8&255]<<8|m[w&255],w^=y[u/a|0]<<24):a>6&&u%a===4&&(w=m[w>>>24]<<24|m[w>>>16&255]<<16|m[w>>>8&255]<<8|m[w&255]),d[u]=I=(d[u-a]^w)>>>0}for(f=0;f<l;f++)u=l-f,f&3?w=d[u]:w=d[u-4],f<4||u<=4?p[f]=w:p[f]=v[m[w>>>24]]^x[m[w>>>16&255]]^S[m[w>>>8&255]]^R[m[w&255]],p[f]=p[f]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,t,n){const i=this.keySize+6,a=this.invKeySchedule,l=this.invSBox,u=this.invSubMix,f=u[0],d=u[1],p=u[2],m=u[3],y=this.uint8ArrayToUint32Array_(n);let T=y[0],v=y[1],x=y[2],S=y[3];const R=new Int32Array(e),I=new Int32Array(R.length);let w,b,_,K,U,z,ee,V,Q,ge,re,he,pe,le;const me=this.networkToHostOrderSwap;for(;t<R.length;){for(Q=me(R[t]),ge=me(R[t+1]),re=me(R[t+2]),he=me(R[t+3]),U=Q^a[0],z=he^a[1],ee=re^a[2],V=ge^a[3],pe=4,le=1;le<i;le++)w=f[U>>>24]^d[z>>16&255]^p[ee>>8&255]^m[V&255]^a[pe],b=f[z>>>24]^d[ee>>16&255]^p[V>>8&255]^m[U&255]^a[pe+1],_=f[ee>>>24]^d[V>>16&255]^p[U>>8&255]^m[z&255]^a[pe+2],K=f[V>>>24]^d[U>>16&255]^p[z>>8&255]^m[ee&255]^a[pe+3],U=w,z=b,ee=_,V=K,pe=pe+4;w=l[U>>>24]<<24^l[z>>16&255]<<16^l[ee>>8&255]<<8^l[V&255]^a[pe],b=l[z>>>24]<<24^l[ee>>16&255]<<16^l[V>>8&255]<<8^l[U&255]^a[pe+1],_=l[ee>>>24]<<24^l[V>>16&255]<<16^l[U>>8&255]<<8^l[z&255]^a[pe+2],K=l[V>>>24]<<24^l[U>>16&255]<<16^l[z>>8&255]<<8^l[ee&255]^a[pe+3],I[t]=me(w^T),I[t+1]=me(K^v),I[t+2]=me(_^x),I[t+3]=me(b^S),T=Q,v=ge,x=re,S=he,t=t+4}return I.buffer}}const jT=16;class yc{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const n=self.crypto;n&&(this.subtle=n.subtle||n.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const n=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?VT(n):n}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,n){return this.useSoftware?new Promise((i,a)=>{this.softwareDecrypt(new Uint8Array(e),t,n);const l=this.flush();l?i(l.buffer):a(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,n)}softwareDecrypt(e,t,n){const{currentIV:i,currentResult:a,remainderData:l}=this;this.logOnce("JS AES decrypt"),l&&(e=Gt(l,e),this.remainderData=null);const u=this.getValidChunk(e);if(!u.length)return null;i&&(n=i);let f=this.softwareDecrypter;f||(f=this.softwareDecrypter=new KT),f.expandKey(t);const d=a;return this.currentResult=f.decrypt(u.buffer,0,n),this.currentIV=gr(u,-16).buffer,d||null}webCryptoDecrypt(e,t,n){if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,n));this.key=t,this.fastAesKey=new HT(this.subtle,t)}return this.fastAesKey.expandKey().then(i=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new GT(this.subtle,new Uint8Array(n)).decrypt(e.buffer,i)):Promise.reject(new Error("web crypto not initialized"))).catch(i=>(O.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${i.name}: ${i.message}`),this.onWebCryptoError(e,t,n)))}onWebCryptoError(e,t,n){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,n);const i=this.flush();if(i)return i.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")}getValidChunk(e){let t=e;const n=e.length-e.length%jT;return n!==e.length&&(t=gr(e,0,n),this.remainderData=gr(e,n)),t}logOnce(e){this.logEnabled&&(O.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const zT={toString:function(o){let e="";const t=o.length;for(let n=0;n<t;n++)e+=`[${o.start(n).toFixed(3)}-${o.end(n).toFixed(3)}]`;return e}},Y={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class Ec extends bT{constructor(e,t,n,i,a){super(),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=Y.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.loadedmetadata=!1,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.onvseeking=null,this.onvended=null,this.logPrefix="",this.log=void 0,this.warn=void 0,this.playlistType=a,this.logPrefix=i,this.log=O.log.bind(O,`${i}:`),this.warn=O.warn.bind(O,`${i}:`),this.hls=e,this.fragmentLoader=new $T(e.config),this.keyLoader=n,this.fragmentTracker=t,this.config=e.config,this.decrypter=new yc(e.config),e.on(L.MANIFEST_LOADED,this.onManifestLoaded,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=Y.STOPPED}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}_streamEnded(e,t){if(t.live||e.nextStart||!e.end||!this.media)return!1;const n=t.partList;if(n!=null&&n.length){const a=n[n.length-1];return Ue.isBuffered(this.media,a.start+a.duration/2)}const i=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(i)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null){var e;return(e=this.levelLastLoaded)==null?void 0:e.details}}onMediaAttached(e,t){const n=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),n.addEventListener("seeking",this.onvseeking),n.addEventListener("ended",this.onvended);const i=this.config;this.levels&&i.autoStartLoad&&this.state===Y.STOPPED&&this.startLoad(i.startPosition)}onMediaDetaching(){const e=this.media;e!=null&&e.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&this.onvseeking&&this.onvended&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}onMediaSeeking(){const{config:e,fragCurrent:t,media:n,mediaBuffer:i,state:a}=this,l=n?n.currentTime:0,u=Ue.bufferInfo(i||n,l,e.maxBufferHole);if(this.log(`media seeking to ${oe(l)?l.toFixed(3):l}, state: ${a}`),this.state===Y.ENDED)this.resetLoadingState();else if(t){const f=e.maxFragLookUpTolerance,d=t.start-f,p=t.start+t.duration+f;if(!u.len||p<u.start||d>u.end){const m=l>p;(l<d||m)&&(m&&t.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),t.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}n&&(this.fragmentTracker.removeFragmentsInRange(l,1/0,this.playlistType,!0),this.lastCurrentTime=l),!this.loadedmetadata&&!u.len&&(this.nextLoadPosition=this.startPosition=l),this.tickImmediate()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset,this.initPTS=[]}onHandlerDestroying(){this.hls.off(L.MANIFEST_LOADED,this.onManifestLoaded,this),this.stopLoad(),super.onHandlerDestroying(),this.hls=null}onHandlerDestroyed(){this.state=Y.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,n){this._loadFragForPlayback(e,t,n)}_loadFragForPlayback(e,t,n){const i=a=>{if(this.fragContextChanged(e)){this.warn(`Fragment ${e.sn}${a.part?" p: "+a.part.index:""} of level ${e.level} was dropped during download.`),this.fragmentTracker.removeFragment(e);return}e.stats.chunkCount++,this._handleFragmentLoadProgress(a)};this._doFragLoad(e,t,n,i).then(a=>{if(!a)return;const l=this.state;if(this.fragContextChanged(e)){(l===Y.FRAG_LOADING||!this.fragCurrent&&l===Y.PARSING)&&(this.fragmentTracker.removeFragment(e),this.state=Y.IDLE);return}"payload"in a&&(this.log(`Loaded fragment ${e.sn} of level ${e.level}`),this.hls.trigger(L.FRAG_LOADED,a)),this._handleFragmentLoadComplete(a)}).catch(a=>{this.state===Y.STOPPED||this.state===Y.ERROR||(this.warn(`Frag error: ${(a==null?void 0:a.message)||a}`),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:n}=this;if(n.getState(e)===ot.APPENDING){const a=e.type,l=this.getFwdBufferInfo(this.mediaBuffer,a),u=Math.max(e.duration,l?l.len:this.config.maxBufferLength),f=this.backtrackFragment;((f?e.sn-f.sn:0)===1||this.reduceMaxBufferLength(u,e.duration))&&n.removeFragment(e)}else((t=this.mediaBuffer)==null?void 0:t.buffered.length)===0?n.removeAllFragments():n.hasParts(e.type)&&(n.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),n.getState(e)===ot.PARTIAL&&n.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}flushMainBuffer(e,t,n=null){if(!(e-t))return;const i={startOffset:e,endOffset:t,type:n};this.hls.trigger(L.BUFFER_FLUSHING,i)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(n=>{if(!n||this.fragContextChanged(e)||!this.levels)throw new Error("init load aborted");return n}).then(n=>{const{hls:i}=this,{payload:a}=n,l=e.decryptdata;if(a&&a.byteLength>0&&l!=null&&l.key&&l.iv&&l.method==="AES-128"){const u=self.performance.now();return this.decrypter.decrypt(new Uint8Array(a),l.key.buffer,l.iv.buffer).catch(f=>{throw i.trigger(L.ERROR,{type:Le.MEDIA_ERROR,details:G.FRAG_DECRYPT_ERROR,fatal:!1,error:f,reason:f.message,frag:e}),f}).then(f=>{const d=self.performance.now();return i.trigger(L.FRAG_DECRYPTED,{frag:e,payload:f,stats:{tstart:u,tdecrypt:d}}),n.payload=f,this.completeInitSegmentLoad(n)})}return this.completeInitSegmentLoad(n)}).catch(n=>{this.state===Y.STOPPED||this.state===Y.ERROR||(this.warn(n),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");const n=e.frag.stats;this.state=Y.IDLE,e.frag.data=new Uint8Array(e.payload),n.parsing.start=n.buffering.start=self.performance.now(),n.parsing.end=n.buffering.end=self.performance.now(),this.tick()}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){var n,i,a,l;const u=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.playlistType===Te.MAIN?"level":"track"} ${e.level} (frag:[${((n=e.startPTS)!=null?n:NaN).toFixed(3)}-${((i=e.endPTS)!=null?i:NaN).toFixed(3)}] > buffer:${u?zT.toString(Ue.getBuffered(u)):"(detached)"})`),e.sn!=="initSegment"){var f;if(e.type!==Te.SUBTITLE){const p=e.elementaryStreams;if(!Object.keys(p).some(m=>!!p[m])){this.state=Y.IDLE;return}}const d=(f=this.levels)==null?void 0:f[e.level];d!=null&&d.fragmentError&&(this.log(`Resetting level fragment error count of ${d.fragmentError} on frag buffered`),d.fragmentError=0)}this.state=Y.IDLE,u&&(!this.loadedmetadata&&e.type==Te.MAIN&&u.buffered.length&&((a=this.fragCurrent)==null?void 0:a.sn)===((l=this.fragPrevious)==null?void 0:l.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())}seekToStartPos(){}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:n,part:i,partsLoaded:a}=e,l=!a||a.length===0||a.some(f=>!f),u=new gc(n.level,n.sn,n.stats.chunkCount+1,0,i?i.index:-1,!l);t.flush(u)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,n=null,i){var a;const l=t==null?void 0:t.details;if(!this.levels||!l)throw new Error(`frag load aborted, missing level${l?"":" detail"}s`);let u=null;if(e.encrypted&&!((a=e.decryptdata)!=null&&a.key)?(this.log(`Loading key for ${e.sn} of [${l.startSN}-${l.endSN}], ${this.logPrefix==="[stream-controller]"?"level":"track"} ${e.level}`),this.state=Y.KEY_LOADING,this.fragCurrent=e,u=this.keyLoader.load(e).then(p=>{if(!this.fragContextChanged(p.frag))return this.hls.trigger(L.KEY_LOADED,p),this.state===Y.KEY_LOADING&&(this.state=Y.IDLE),p}),this.hls.trigger(L.KEY_LOADING,{frag:e}),this.fragCurrent===null&&(u=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))):!e.encrypted&&l.encryptedFragments.length&&this.keyLoader.loadClear(e,l.encryptedFragments),n=Math.max(e.start,n||0),this.config.lowLatencyMode&&e.sn!=="initSegment"){const p=l.partList;if(p&&i){n>e.end&&l.fragmentHint&&(e=l.fragmentHint);const m=this.getNextPart(p,e,n);if(m>-1){const y=p[m];this.log(`Loading part sn: ${e.sn} p: ${y.index} cc: ${e.cc} of playlist [${l.startSN}-${l.endSN}] parts [0-${m}-${p.length-1}] ${this.logPrefix==="[stream-controller]"?"level":"track"}: ${e.level}, target: ${parseFloat(n.toFixed(3))}`),this.nextLoadPosition=y.start+y.duration,this.state=Y.FRAG_LOADING;let T;return u?T=u.then(v=>!v||this.fragContextChanged(v.frag)?null:this.doFragPartsLoad(e,y,t,i)).catch(v=>this.handleFragLoadError(v)):T=this.doFragPartsLoad(e,y,t,i).catch(v=>this.handleFragLoadError(v)),this.hls.trigger(L.FRAG_LOADING,{frag:e,part:y,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):T}else if(!e.url||this.loadedEndOfParts(p,n))return Promise.resolve(null)}}this.log(`Loading fragment ${e.sn} cc: ${e.cc} ${l?"of ["+l.startSN+"-"+l.endSN+"] ":""}${this.logPrefix==="[stream-controller]"?"level":"track"}: ${e.level}, target: ${parseFloat(n.toFixed(3))}`),oe(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=Y.FRAG_LOADING;const f=this.config.progressive;let d;return f&&u?d=u.then(p=>!p||this.fragContextChanged(p==null?void 0:p.frag)?null:this.fragmentLoader.load(e,i)).catch(p=>this.handleFragLoadError(p)):d=Promise.all([this.fragmentLoader.load(e,f?i:void 0),u]).then(([p])=>(!f&&p&&i&&i(p),p)).catch(p=>this.handleFragLoadError(p)),this.hls.trigger(L.FRAG_LOADING,{frag:e,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):d}doFragPartsLoad(e,t,n,i){return new Promise((a,l)=>{var u;const f=[],d=(u=n.details)==null?void 0:u.partList,p=m=>{this.fragmentLoader.loadPart(e,m,i).then(y=>{f[m.index]=y;const T=y.part;this.hls.trigger(L.FRAG_LOADED,y);const v=ap(n,e.sn,m.index+1)||Dm(d,e.sn,m.index+1);if(v)p(v);else return a({frag:e,part:T,partsLoaded:f})}).catch(l)};p(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;e.data&&t.details===G.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(L.ERROR,t)}else this.hls.trigger(L.ERROR,{type:Le.OTHER_ERROR,details:G.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==Y.PARSING){!this.fragCurrent&&this.state!==Y.STOPPED&&this.state!==Y.ERROR&&(this.state=Y.IDLE);return}const{frag:n,part:i,level:a}=t,l=self.performance.now();n.stats.parsing.end=l,i&&(i.stats.parsing.end=l),this.updateLevelTiming(n,i,a,e.partial)}getCurrentContext(e){const{levels:t,fragCurrent:n}=this,{level:i,sn:a,part:l}=e;if(!(t!=null&&t[i]))return this.warn(`Levels object was unset while buffering fragment ${a} of level ${i}. The current chunk will not be buffered.`),null;const u=t[i],f=l>-1?ap(u,a,l):null,d=f?f.fragment:pT(u,a,n);return d?(n&&n!==d&&(d.stats=n.stats),{frag:d,part:f,level:u}):null}bufferFragmentData(e,t,n,i,a){var l;if(!e||this.state!==Y.PARSING)return;const{data1:u,data2:f}=e;let d=u;if(u&&f&&(d=Gt(u,f)),!((l=d)!=null&&l.length))return;const p={type:e.type,frag:t,part:n,chunkMeta:i,parent:t.type,data:d};if(this.hls.trigger(L.BUFFER_APPENDING,p),e.dropped&&e.independent&&!n){if(a)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!Ue.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}const n=t.currentTime,i=Ue.bufferInfo(t,n,0),a=e.duration,l=Math.min(this.config.maxFragLookUpTolerance*2,a*.25),u=Math.max(Math.min(e.start-l,i.end-l),n+l);e.start-u>l&&this.flushMainBuffer(u,e.start)}getFwdBufferInfo(e,t){const n=this.getLoadPosition();return oe(n)?this.getFwdBufferInfoAtPos(e,n,t):null}getFwdBufferInfoAtPos(e,t,n){const{config:{maxBufferHole:i}}=this,a=Ue.bufferInfo(e,t,i);if(a.len===0&&a.nextStart!==void 0){const l=this.fragmentTracker.getBufferedFrag(t,n);if(l&&a.nextStart<l.end)return Ue.bufferInfo(e,t,Math.max(a.nextStart,i))}return a}getMaxBufferLength(e){const{config:t}=this;let n;return e?n=Math.max(8*t.maxBufferSize/e,t.maxBufferLength):n=t.maxBufferLength,Math.min(n,t.maxMaxBufferLength)}reduceMaxBufferLength(e,t){const n=this.config,i=Math.max(Math.min(e-t,n.maxBufferLength),t),a=Math.max(e-t*3,n.maxMaxBufferLength/2,i);return a>=i?(n.maxMaxBufferLength=a,this.warn(`Reduce max buffer length to ${a}s`),!0):!1}getAppendedFrag(e,t=Te.MAIN){const n=this.fragmentTracker.getAppendedFrag(e,Te.MAIN);return n&&"fragment"in n?n.fragment:n}getNextFragment(e,t){const n=t.fragments,i=n.length;if(!i)return null;const{config:a}=this,l=n[0].start;let u;if(t.live){const f=a.initialLiveManifestSize;if(i<f)return this.warn(`Not enough fragments to start playback (have: ${i}, need: ${f})`),null;(!t.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||e<l)&&(u=this.getInitialLiveFragment(t,n),this.startPosition=this.nextLoadPosition=u?this.hls.liveSyncPosition||u.start:e)}else e<=l&&(u=n[0]);if(!u){const f=a.lowLatencyMode?t.partEnd:t.fragmentEnd;u=this.getFragmentAtPosition(e,f,t)}return this.mapToInitFragWhenRequired(u)}isLoopLoading(e,t){const n=this.fragmentTracker.getState(e);return(n===ot.OK||n===ot.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,n,i,a){const l=e.gap,u=this.getNextFragment(this.nextLoadPosition,t);if(u===null)return u;if(e=u,l&&e&&!e.gap&&n.nextStart){const f=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,n.nextStart,i);if(f!==null&&n.len+f.len>=a)return this.log(`buffer full after gaps in "${i}" playlist starting at sn: ${e.sn}`),null}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!(e!=null&&e.initSegment.data)&&!this.bitrateTest?e.initSegment:e}getNextPart(e,t,n){let i=-1,a=!1,l=!0;for(let u=0,f=e.length;u<f;u++){const d=e[u];if(l=l&&!d.independent,i>-1&&n<d.start)break;const p=d.loaded;p?i=-1:(a||d.independent||l)&&d.fragment===t&&(i=u),a=p}return i}loadedEndOfParts(e,t){const n=e[e.length-1];return n&&t>n.start&&n.loaded}getInitialLiveFragment(e,t){const n=this.fragPrevious;let i=null;if(n){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${n.programDateTime}`),i=gT(t,n.endProgramDateTime,this.config.maxFragLookUpTolerance)),!i){const a=n.sn+1;if(a>=e.startSN&&a<=e.endSN){const l=t[a-e.startSN];n.cc===l.cc&&(i=l,this.log(`Live playlist, switching playlist, load frag with next SN: ${i.sn}`))}i||(i=vT(t,n.cc),i&&this.log(`Live playlist, switching playlist, load frag with same CC: ${i.sn}`))}}else{const a=this.hls.liveSyncPosition;a!==null&&(i=this.getFragmentAtPosition(a,this.bitrateTest?e.fragmentEnd:e.edge,e))}return i}getFragmentAtPosition(e,t,n){const{config:i}=this;let{fragPrevious:a}=this,{fragments:l,endSN:u}=n;const{fragmentHint:f}=n,{maxFragLookUpTolerance:d}=i,p=n.partList,m=!!(i.lowLatencyMode&&p!=null&&p.length&&f);m&&f&&!this.bitrateTest&&(l=l.concat(f),u=f.sn);let y;if(e<t){const T=e>t-d?0:d;y=Xa(a,l,e,T)}else y=l[l.length-1];if(y){const T=y.sn-n.startSN,v=this.fragmentTracker.getState(y);if((v===ot.OK||v===ot.PARTIAL&&y.gap)&&(a=y),a&&y.sn===a.sn&&(!m||p[0].fragment.sn>y.sn)&&a&&y.level===a.level){const S=l[T+1];y.sn<u&&this.fragmentTracker.getState(S)!==ot.OK?y=S:y=null}}return y}synchronizeToLiveEdge(e){const{config:t,media:n}=this;if(!n)return;const i=this.hls.liveSyncPosition,a=n.currentTime,l=e.fragments[0].start,u=e.edge,f=a>=l-t.maxFragLookUpTolerance&&a<=u;if(i!==null&&n.duration>i&&(a<i||!f)){const d=t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;(!f&&n.readyState<4||a<u-d)&&(this.loadedmetadata||(this.nextLoadPosition=i),n.readyState&&(this.warn(`Playback: ${a.toFixed(3)} is located too far from the end of live sliding playlist: ${u}, reset currentTime to : ${i.toFixed(3)}`),n.currentTime=i))}}alignPlaylists(e,t,n){const i=e.fragments.length;if(!i)return this.warn("No fragments in live playlist"),0;const a=e.fragments[0].start,l=!t,u=e.alignedSliding&&oe(a);if(l||!u&&!a){const{fragPrevious:f}=this;UT(f,n,e);const d=e.fragments[0].start;return this.log(`Live playlist sliding: ${d.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} prev-sn: ${f?f.sn:"na"} fragments: ${i}`),d}return a}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,t){let n=this.startPosition;if(n<t&&(n=-1),n===-1||this.lastCurrentTime===-1){const i=this.startTimeOffset!==null,a=i?this.startTimeOffset:e.startTimeOffset;a!==null&&oe(a)?(n=t+a,a<0&&(n+=e.totalduration),n=Math.min(Math.max(t,n),t+e.totalduration),this.log(`Start time offset ${a} found in ${i?"multivariant":"media"} playlist, adjust startPosition to ${n}`),this.startPosition=n):e.live?n=this.hls.liveSyncPosition||t:this.startPosition=n=0,this.lastCurrentTime=n}this.nextLoadPosition=n}getLoadPosition(){const{media:e}=this;let t=0;return this.loadedmetadata&&e?t=e.currentTime:this.nextLoadPosition&&(t=this.nextLoadPosition),t}handleFragLoadAborted(e,t){this.transmuxer&&e.sn!=="initSegment"&&e.stats.aborted&&(this.warn(`Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==Y.FRAG_LOADING_WAITING_RETRY)&&(this.state=Y.IDLE)}onFragmentOrKeyLoadError(e,t){if(t.chunkMeta&&!t.frag){const p=this.getCurrentContext(t.chunkMeta);p&&(t.frag=p.frag)}const n=t.frag;if(!n||n.type!==e||!this.levels)return;if(this.fragContextChanged(n)){var i;this.warn(`Frag load error must match current frag to retry ${n.url} > ${(i=this.fragCurrent)==null?void 0:i.url}`);return}const a=t.details===G.FRAG_GAP;a&&this.fragmentTracker.fragBuffered(n,!0);const l=t.errorAction,{action:u,retryCount:f=0,retryConfig:d}=l||{};if(l&&u===ft.RetryRequest&&d){this.resetStartWhenNotLoaded(this.levelLastLoaded);const p=pc(d,f);this.warn(`Fragment ${n.sn} of ${e} ${n.level} errored with ${t.details}, retrying loading ${f+1}/${d.maxNumRetry} in ${p}ms`),l.resolved=!0,this.retryDate=self.performance.now()+p,this.state=Y.FRAG_LOADING_WAITING_RETRY}else if(d&&l)if(this.resetFragmentErrors(e),f<d.maxNumRetry)!a&&u!==ft.RemoveAlternatePermanently&&(l.resolved=!0);else{O.warn(`${t.details} reached or exceeded max retry (${f})`);return}else(l==null?void 0:l.action)===ft.SendAlternateToPenaltyBox?this.state=Y.WAITING_LEVEL:this.state=Y.ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(e){if(this.state===Y.PARSING||this.state===Y.PARSED){const t=e.frag,n=e.parent,i=this.getFwdBufferInfo(this.mediaBuffer,n),a=i&&i.len>.5;a&&this.reduceMaxBufferLength(i.len,(t==null?void 0:t.duration)||10);const l=!a;return l&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${n} buffer`),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),l}return!1}resetFragmentErrors(e){e===Te.AUDIO&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==Y.STOPPED&&(this.state=Y.IDLE)}afterBufferFlushed(e,t,n){if(!e)return;const i=Ue.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,i,n),this.state===Y.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=Y.IDLE}resetStartWhenNotLoaded(e){if(!this.loadedmetadata){this.startFragRequested=!1;const t=e?e.details:null;t!=null&&t.live?(this.startPosition=-1,this.setStartPosition(t,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.warn(`The loading context changed while buffering fragment ${e.sn} of level ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,n,i){var a;const l=n.details;if(!l){this.warn("level.details undefined");return}if(!Object.keys(e.elementaryStreams).reduce((f,d)=>{const p=e.elementaryStreams[d];if(p){const m=p.endPTS-p.startPTS;if(m<=0)return this.warn(`Could not parse fragment ${e.sn} ${d} duration reliably (${m})`),f||!1;const y=i?0:Im(l,e,p.startPTS,p.endPTS,p.startDTS,p.endDTS);return this.hls.trigger(L.LEVEL_PTS_UPDATED,{details:l,level:n,drift:y,type:d,frag:e,start:p.startPTS,end:p.endPTS}),!0}return f},!1)&&((a=this.transmuxer)==null?void 0:a.error)===null){const f=new Error(`Found no media in fragment ${e.sn} of level ${e.level} resetting transmuxer to fallback to playlist timing`);if(n.fragmentError===0&&(n.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)),this.warn(f.message),this.hls.trigger(L.ERROR,{type:Le.MEDIA_ERROR,details:G.FRAG_PARSING_ERROR,fatal:!1,error:f,frag:e,reason:`Found no media in msn ${e.sn} of level "${n.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=Y.PARSED,this.hls.trigger(L.FRAG_PARSED,{frag:e,part:t})}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.resetTransmuxer(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}class Fm{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let n;if(e.length)e.length===1?n=e[0]:n=WT(e,t);else return new Uint8Array(0);return this.reset(),n}reset(){this.chunks.length=0,this.dataLength=0}}function WT(o,e){const t=new Uint8Array(e);let n=0;for(let i=0;i<o.length;i++){const a=o[i];t.set(a,n),n+=a.length}return t}function YT(){return typeof __HLS_WORKER_BUNDLE__=="function"}function qT(){const o=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),e=self.URL.createObjectURL(o);return{worker:new self.Worker(e),objectURL:e}}function XT(o){const e=new self.URL(o,self.location.href).href;return{worker:new self.Worker(e),scriptURL:e}}function on(o="",e=9e4){return{type:o,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class vc{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,n,i){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,n){}demux(e,t){this.cachedData&&(e=Gt(this.cachedData,e),this.cachedData=null);let n=Ji(e,0),i=n?n.length:0,a;const l=this._audioTrack,u=this._id3Track,f=n?hc(n):void 0,d=e.length;for((this.basePTS===null||this.frameIndex===0&&oe(f))&&(this.basePTS=QT(f,t,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),n&&n.length>0&&u.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:Qt.audioId3,duration:Number.POSITIVE_INFINITY});i<d;){if(this.canParse(e,i)){const p=this.appendFrame(l,e,i);p?(this.frameIndex++,this.lastPTS=p.sample.pts,i+=p.length,a=i):i=d}else Ev(e,i)?(n=Ji(e,i),u.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:Qt.audioId3,duration:Number.POSITIVE_INFINITY}),i+=n.length,a=i):i++;if(i===d&&a!==d){const p=gr(e,a);this.cachedData?this.cachedData=Gt(this.cachedData,p):this.cachedData=p}}return{audioTrack:l,videoTrack:on(),id3Track:u,textTrack:on()}}demuxSampleAes(e,t,n){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:on(),id3Track:this._id3Track,textTrack:on()}}destroy(){}}const QT=(o,e,t)=>{if(oe(o))return o*90;const n=t?t.baseTime*9e4/t.timescale:0;return e*9e4+n};function JT(o,e,t,n){let i,a,l,u;const f=navigator.userAgent.toLowerCase(),d=n,p=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];i=((e[t+2]&192)>>>6)+1;const m=(e[t+2]&60)>>>2;if(m>p.length-1){const y=new Error(`invalid ADTS sampling index:${m}`);o.emit(L.ERROR,L.ERROR,{type:Le.MEDIA_ERROR,details:G.FRAG_PARSING_ERROR,fatal:!0,error:y,reason:y.message});return}return l=(e[t+2]&1)<<2,l|=(e[t+3]&192)>>>6,O.log(`manifest codec:${n}, ADTS type:${i}, samplingIndex:${m}`),/firefox/i.test(f)?m>=6?(i=5,u=new Array(4),a=m-3):(i=2,u=new Array(2),a=m):f.indexOf("android")!==-1?(i=2,u=new Array(2),a=m):(i=5,u=new Array(4),n&&(n.indexOf("mp4a.40.29")!==-1||n.indexOf("mp4a.40.5")!==-1)||!n&&m>=6?a=m-3:((n&&n.indexOf("mp4a.40.2")!==-1&&(m>=6&&l===1||/vivaldi/i.test(f))||!n&&l===1)&&(i=2,u=new Array(2)),a=m)),u[0]=i<<3,u[0]|=(m&14)>>1,u[1]|=(m&1)<<7,u[1]|=l<<3,i===5&&(u[1]|=(a&14)>>1,u[2]=(a&1)<<7,u[2]|=8,u[3]=0),{config:u,samplerate:p[m],channelCount:l,codec:"mp4a.40."+i,manifestCodec:d}}function Nm(o,e){return o[e]===255&&(o[e+1]&246)===240}function Mm(o,e){return o[e+1]&1?7:9}function Tc(o,e){return(o[e+3]&3)<<11|o[e+4]<<3|(o[e+5]&224)>>>5}function ZT(o,e){return e+5<o.length}function Ja(o,e){return e+1<o.length&&Nm(o,e)}function ex(o,e){return ZT(o,e)&&Nm(o,e)&&Tc(o,e)<=o.length-e}function tx(o,e){if(Ja(o,e)){const t=Mm(o,e);if(e+t>=o.length)return!1;const n=Tc(o,e);if(n<=t)return!1;const i=e+n;return i===o.length||Ja(o,i)}return!1}function Um(o,e,t,n,i){if(!o.samplerate){const a=JT(e,t,n,i);if(!a)return;o.config=a.config,o.samplerate=a.samplerate,o.channelCount=a.channelCount,o.codec=a.codec,o.manifestCodec=a.manifestCodec,O.log(`parsed codec:${o.codec}, rate:${a.samplerate}, channels:${a.channelCount}`)}}function Bm(o){return 1024*9e4/o}function nx(o,e){const t=Mm(o,e);if(e+t<=o.length){const n=Tc(o,e)-t;if(n>0)return{headerLength:t,frameLength:n}}}function $m(o,e,t,n,i){const a=Bm(o.samplerate),l=n+i*a,u=nx(e,t);let f;if(u){const{frameLength:m,headerLength:y}=u,T=y+m,v=Math.max(0,t+T-e.length);v?(f=new Uint8Array(T-y),f.set(e.subarray(t+y,e.length),0)):f=e.subarray(t+y,t+T);const x={unit:f,pts:l};return v||o.samples.push(x),{sample:x,length:T,missing:v}}const d=e.length-t;return f=new Uint8Array(d),f.set(e.subarray(t,e.length),0),{sample:{unit:f,pts:l},length:d,missing:-1}}let wa=null;const rx=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],ix=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],sx=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],ax=[0,1,1,4];function Gm(o,e,t,n,i){if(t+24>e.length)return;const a=Hm(e,t);if(a&&t+a.frameLength<=e.length){const l=a.samplesPerFrame*9e4/a.sampleRate,u=n+i*l,f={unit:e.subarray(t,t+a.frameLength),pts:u,dts:u};return o.config=[],o.channelCount=a.channelCount,o.samplerate=a.sampleRate,o.samples.push(f),{sample:f,length:a.frameLength,missing:0}}}function Hm(o,e){const t=o[e+1]>>3&3,n=o[e+1]>>1&3,i=o[e+2]>>4&15,a=o[e+2]>>2&3;if(t!==1&&i!==0&&i!==15&&a!==3){const l=o[e+2]>>1&1,u=o[e+3]>>6,f=t===3?3-n:n===3?3:4,d=rx[f*14+i-1]*1e3,m=ix[(t===3?0:t===2?1:2)*3+a],y=u===3?1:2,T=sx[t][n],v=ax[n],x=T*8*v,S=Math.floor(T*d/m+l)*v;if(wa===null){const w=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);wa=w?parseInt(w[1]):0}return!!wa&&wa<=87&&n===2&&d>=224e3&&u===0&&(o[e+3]=o[e+3]|128),{sampleRate:m,channelCount:y,frameLength:S,samplesPerFrame:x}}}function xc(o,e){return o[e]===255&&(o[e+1]&224)===224&&(o[e+1]&6)!==0}function Vm(o,e){return e+1<o.length&&xc(o,e)}function ox(o,e){return xc(o,e)&&4<=o.length-e}function Km(o,e){if(e+1<o.length&&xc(o,e)){const n=Hm(o,e);let i=4;n!=null&&n.frameLength&&(i=n.frameLength);const a=e+i;return a===o.length||Vm(o,a)}return!1}class lx extends vc{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=Ji(e,0);let n=(t==null?void 0:t.length)||0;if(Km(e,n))return!1;for(let i=e.length;n<i;n++)if(tx(e,n))return O.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return ex(e,t)}appendFrame(e,t,n){Um(e,this.observer,t,n,e.manifestCodec);const i=$m(e,t,n,this.basePTS,this.frameIndex);if(i&&i.missing===0)return i}}const ux=/\/emsg[-/]ID3/i;class cx{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,n,i){const a=this.videoTrack=on("video",1),l=this.audioTrack=on("audio",1),u=this.txtTrack=on("text",1);if(this.id3Track=on("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const f=Tm(e);if(f.video){const{id:d,timescale:p,codec:m}=f.video;a.id=d,a.timescale=u.timescale=p,a.codec=m}if(f.audio){const{id:d,timescale:p,codec:m}=f.audio;l.id=d,l.timescale=p,l.codec=m}u.id=ym.text,a.sampleDuration=0,a.duration=l.duration=i}resetContiguity(){this.remainderData=null}static probe(e){return Cv(e)}demux(e,t){this.timeOffset=t;let n=e;const i=this.videoTrack,a=this.txtTrack;if(this.config.progressive){this.remainderData&&(n=Gt(this.remainderData,e));const u=Fv(n);this.remainderData=u.remainder,i.samples=u.valid||new Uint8Array}else i.samples=n;const l=this.extractID3Track(i,t);return a.samples=Gh(t,i),{videoTrack:i,audioTrack:this.audioTrack,id3Track:l,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,n=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const i=this.extractID3Track(t,this.timeOffset);return n.samples=Gh(e,t),{videoTrack:t,audioTrack:on(),id3Track:i,textTrack:on()}}extractID3Track(e,t){const n=this.id3Track;if(e.samples.length){const i=Re(e.samples,["emsg"]);i&&i.forEach(a=>{const l=Uv(a);if(ux.test(l.schemeIdUri)){const u=oe(l.presentationTime)?l.presentationTime/l.timeScale:t+l.presentationTimeDelta/l.timeScale;let f=l.eventDuration===4294967295?Number.POSITIVE_INFINITY:l.eventDuration/l.timeScale;f<=.001&&(f=Number.POSITIVE_INFINITY);const d=l.payload;n.samples.push({data:d,len:d.byteLength,dts:u,pts:u,type:Qt.emsg,duration:f})}})}return n}demuxSampleAes(e,t,n){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){}}const jm=(o,e)=>{let t=0,n=5;e+=n;const i=new Uint32Array(1),a=new Uint32Array(1),l=new Uint8Array(1);for(;n>0;){l[0]=o[e];const u=Math.min(n,8),f=8-u;a[0]=4278190080>>>24+f<<f,i[0]=(l[0]&a[0])>>f,t=t?t<<u|i[0]:i[0],e+=1,n-=u}return t};class fx extends vc{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,n){const i=zm(e,t,n,this.basePTS,this.frameIndex);if(i!==-1)return{sample:e.samples[e.samples.length-1],length:i,missing:0}}static probe(e){if(!e)return!1;const t=Ji(e,0);if(!t)return!1;const n=t.length;return e[n]===11&&e[n+1]===119&&hc(t)!==void 0&&jm(e,n)<16}}function zm(o,e,t,n,i){if(t+8>e.length||e[t]!==11||e[t+1]!==119)return-1;const a=e[t+4]>>6;if(a>=3)return-1;const u=[48e3,44100,32e3][a],f=e[t+4]&63,p=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][f*3+a]*2;if(t+p>e.length)return-1;const m=e[t+6]>>5;let y=0;m===2?y+=2:(m&1&&m!==1&&(y+=2),m&4&&(y+=2));const T=(e[t+6]<<8|e[t+7])>>12-y&1,x=[2,1,2,3,3,4,4,5][m]+T,S=e[t+5]>>3,R=e[t+5]&7,I=new Uint8Array([a<<6|S<<1|R>>2,(R&3)<<6|m<<3|T<<2|f>>4,f<<4&224]),w=1536/u*9e4,b=n+i*w,_=e.subarray(t,t+p);return o.config=I,o.channelCount=x,o.samplerate=u,o.samples.push({unit:_,pts:b}),p}class dx{constructor(){this.VideoSample=null}createVideoSample(e,t,n,i){return{key:e,frame:!1,pts:t,dts:n,units:[],debug:i,length:0}}getLastNalUnit(e){var t;let n=this.VideoSample,i;if((!n||n.units.length===0)&&(n=e[e.length-1]),(t=n)!=null&&t.units){const a=n.units;i=a[a.length-1]}return i}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(e.pts===void 0){const n=t.samples,i=n.length;if(i){const a=n[i-1];e.pts=a.pts,e.dts=a.dts}else{t.dropped++;return}}t.samples.push(e)}e.debug.length&&O.log(e.pts+"/"+e.dts+":"+e.debug)}}class mp{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,n=e.byteLength-t,i=new Uint8Array(4),a=Math.min(4,t);if(a===0)throw new Error("no bytes available");i.set(e.subarray(n,n+a)),this.word=new DataView(i.buffer).getUint32(0),this.bitsAvailable=a*8,this.bytesAvailable-=a}skipBits(e){let t;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const n=this.word>>>32-t;if(e>32&&O.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return t=e-t,t>0&&this.bitsAvailable?n<<t|this.readBits(t):n}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if(this.word&2147483648>>>e)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(e){let t=8,n=8,i;for(let a=0;a<e;a++)n!==0&&(i=this.readEG(),n=(t+i+256)%256),t=n===0?t:n}readSPS(){let e=0,t=0,n=0,i=0,a,l,u;const f=this.readUByte.bind(this),d=this.readBits.bind(this),p=this.readUEG.bind(this),m=this.readBoolean.bind(this),y=this.skipBits.bind(this),T=this.skipEG.bind(this),v=this.skipUEG.bind(this),x=this.skipScalingList.bind(this);f();const S=f();if(d(5),y(3),f(),v(),S===100||S===110||S===122||S===244||S===44||S===83||S===86||S===118||S===128){const K=p();if(K===3&&y(1),v(),v(),y(1),m())for(l=K!==3?8:12,u=0;u<l;u++)m()&&(u<6?x(16):x(64))}v();const R=p();if(R===0)p();else if(R===1)for(y(1),T(),T(),a=p(),u=0;u<a;u++)T();v(),y(1);const I=p(),w=p(),b=d(1);b===0&&y(1),y(1),m()&&(e=p(),t=p(),n=p(),i=p());let _=[1,1];if(m()&&m())switch(f()){case 1:_=[1,1];break;case 2:_=[12,11];break;case 3:_=[10,11];break;case 4:_=[16,11];break;case 5:_=[40,33];break;case 6:_=[24,11];break;case 7:_=[20,11];break;case 8:_=[32,11];break;case 9:_=[80,33];break;case 10:_=[18,11];break;case 11:_=[15,11];break;case 12:_=[64,33];break;case 13:_=[160,99];break;case 14:_=[4,3];break;case 15:_=[3,2];break;case 16:_=[2,1];break;case 255:{_=[f()<<8|f(),f()<<8|f()];break}}return{width:Math.ceil((I+1)*16-e*2-t*2),height:(2-b)*(w+1)*16-(b?2:4)*(n+i),pixelRatio:_}}readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()}}class hx extends dx{parseAVCPES(e,t,n,i,a){const l=this.parseAVCNALu(e,n.data);let u=this.VideoSample,f,d=!1;n.data=null,u&&l.length&&!e.audFound&&(this.pushAccessUnit(u,e),u=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts,"")),l.forEach(p=>{var m;switch(p.type){case 1:{let x=!1;f=!0;const S=p.data;if(d&&S.length>4){const R=new mp(S).readSliceType();(R===2||R===4||R===7||R===9)&&(x=!0)}if(x){var y;(y=u)!=null&&y.frame&&!u.key&&(this.pushAccessUnit(u,e),u=this.VideoSample=null)}u||(u=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts,"")),u.frame=!0,u.key=x;break}case 5:f=!0,(m=u)!=null&&m.frame&&!u.key&&(this.pushAccessUnit(u,e),u=this.VideoSample=null),u||(u=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts,"")),u.key=!0,u.frame=!0;break;case 6:{f=!0,Sm(p.data,1,n.pts,t.samples);break}case 7:{var T,v;f=!0,d=!0;const x=p.data,R=new mp(x).readSPS();if(!e.sps||e.width!==R.width||e.height!==R.height||((T=e.pixelRatio)==null?void 0:T[0])!==R.pixelRatio[0]||((v=e.pixelRatio)==null?void 0:v[1])!==R.pixelRatio[1]){e.width=R.width,e.height=R.height,e.pixelRatio=R.pixelRatio,e.sps=[x],e.duration=a;const I=x.subarray(1,4);let w="avc1.";for(let b=0;b<3;b++){let _=I[b].toString(16);_.length<2&&(_="0"+_),w+=_}e.codec=w}break}case 8:f=!0,e.pps=[p.data];break;case 9:f=!0,e.audFound=!0,u&&this.pushAccessUnit(u,e),u=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts,"");break;case 12:f=!0;break;default:f=!1,u&&(u.debug+="unknown NAL "+p.type+" ");break}u&&f&&u.units.push(p)}),i&&u&&(this.pushAccessUnit(u,e),this.VideoSample=null)}parseAVCNALu(e,t){const n=t.byteLength;let i=e.naluState||0;const a=i,l=[];let u=0,f,d,p,m=-1,y=0;for(i===-1&&(m=0,y=t[0]&31,i=0,u=1);u<n;){if(f=t[u++],!i){i=f?0:1;continue}if(i===1){i=f?0:2;continue}if(!f)i=3;else if(f===1){if(d=u-i-1,m>=0){const T={data:t.subarray(m,d),type:y};l.push(T)}else{const T=this.getLastNalUnit(e.samples);T&&(a&&u<=4-a&&T.state&&(T.data=T.data.subarray(0,T.data.byteLength-a)),d>0&&(T.data=Gt(T.data,t.subarray(0,d)),T.state=0))}u<n?(p=t[u]&31,m=u,y=p,i=0):i=-1}else i=0}if(m>=0&&i>=0){const T={data:t.subarray(m,n),type:y,state:i};l.push(T)}if(l.length===0){const T=this.getLastNalUnit(e.samples);T&&(T.data=Gt(T.data,t))}return e.naluState=i,l}}class px{constructor(e,t,n){this.keyData=void 0,this.decrypter=void 0,this.keyData=n,this.decrypter=new yc(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer)}decryptAacSample(e,t,n){const i=e[t].unit;if(i.length<=16)return;const a=i.subarray(16,i.length-i.length%16),l=a.buffer.slice(a.byteOffset,a.byteOffset+a.length);this.decryptBuffer(l).then(u=>{const f=new Uint8Array(u);i.set(f,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,n)})}decryptAacSamples(e,t,n){for(;;t++){if(t>=e.length){n();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,n),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=Math.floor((e.length-48)/160)*16+16,n=new Int8Array(t);let i=0;for(let a=32;a<e.length-16;a+=160,i+=16)n.set(e.subarray(a,a+16),i);return n}getAvcDecryptedUnit(e,t){const n=new Uint8Array(t);let i=0;for(let a=32;a<e.length-16;a+=160,i+=16)e.set(n.subarray(i,i+16),a);return e}decryptAvcSample(e,t,n,i,a){const l=Lm(a.data),u=this.getAvcEncryptedData(l);this.decryptBuffer(u.buffer).then(f=>{a.data=this.getAvcDecryptedUnit(l,f),this.decrypter.isSync()||this.decryptAvcSamples(e,t,n+1,i)})}decryptAvcSamples(e,t,n,i){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,n=0){if(t>=e.length){i();return}const a=e[t].units;for(;!(n>=a.length);n++){const l=a[n];if(!(l.data.length<=48||l.type!==1&&l.type!==5)&&(this.decryptAvcSample(e,t,n,i,l),!this.decrypter.isSync()))return}}}}const at=188;class Qn{constructor(e,t,n){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.videoParser=new hx}static probe(e){const t=Qn.syncOffset(e);return t>0&&O.warn(`MPEG2-TS detected but first sync word found @ offset ${t}`),t!==-1}static syncOffset(e){const t=e.length;let n=Math.min(at*5,t-at)+1,i=0;for(;i<n;){let a=!1,l=-1,u=0;for(let f=i;f<t;f+=at)if(e[f]===71&&(t-f===at||e[f+at]===71)){if(u++,l===-1&&(l=f,l!==0&&(n=Math.min(l+at*99,e.length-at)+1)),a||(a=Yu(e,f)===0),a&&u>1&&(l===0&&u>2||f+at>n))return l}else{if(u)return-1;break}i++}return-1}static createTrack(e,t){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:ym[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?t:void 0}}resetInitSegment(e,t,n,i){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=Qn.createTrack("video"),this._audioTrack=Qn.createTrack("audio",i),this._id3Track=Qn.createTrack("id3"),this._txtTrack=Qn.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=n,this._duration=i}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:t,_id3Track:n}=this;e&&(e.pesData=null),t&&(t.pesData=null),n&&(n.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t,n=!1,i=!1){n||(this.sampleAes=null);let a;const l=this._videoTrack,u=this._audioTrack,f=this._id3Track,d=this._txtTrack;let p=l.pid,m=l.pesData,y=u.pid,T=f.pid,v=u.pesData,x=f.pesData,S=null,R=this.pmtParsed,I=this._pmtId,w=e.length;if(this.remainderData&&(e=Gt(this.remainderData,e),w=e.length,this.remainderData=null),w<at&&!i)return this.remainderData=e,{audioTrack:u,videoTrack:l,id3Track:f,textTrack:d};const b=Math.max(0,Qn.syncOffset(e));w-=(w-b)%at,w<e.byteLength&&!i&&(this.remainderData=new Uint8Array(e.buffer,w,e.buffer.byteLength-w));let _=0;for(let U=b;U<w;U+=at)if(e[U]===71){const z=!!(e[U+1]&64),ee=Yu(e,U),V=(e[U+3]&48)>>4;let Q;if(V>1){if(Q=U+5+e[U+4],Q===U+at)continue}else Q=U+4;switch(ee){case p:z&&(m&&(a=Wr(m))&&this.videoParser.parseAVCPES(l,d,a,!1,this._duration),m={data:[],size:0}),m&&(m.data.push(e.subarray(Q,U+at)),m.size+=U+at-Q);break;case y:if(z){if(v&&(a=Wr(v)))switch(u.segmentCodec){case"aac":this.parseAACPES(u,a);break;case"mp3":this.parseMPEGPES(u,a);break;case"ac3":this.parseAC3PES(u,a);break}v={data:[],size:0}}v&&(v.data.push(e.subarray(Q,U+at)),v.size+=U+at-Q);break;case T:z&&(x&&(a=Wr(x))&&this.parseID3PES(f,a),x={data:[],size:0}),x&&(x.data.push(e.subarray(Q,U+at)),x.size+=U+at-Q);break;case 0:z&&(Q+=e[Q]+1),I=this._pmtId=mx(e,Q);break;case I:{z&&(Q+=e[Q]+1);const ge=gx(e,Q,this.typeSupported,n,this.observer);p=ge.videoPid,p>0&&(l.pid=p,l.segmentCodec=ge.segmentVideoCodec),y=ge.audioPid,y>0&&(u.pid=y,u.segmentCodec=ge.segmentAudioCodec),T=ge.id3Pid,T>0&&(f.pid=T),S!==null&&!R&&(O.warn(`MPEG-TS PMT found at ${U} after unknown PID '${S}'. Backtracking to sync byte @${b} to parse all TS packets.`),S=null,U=b-188),R=this.pmtParsed=!0;break}case 17:case 8191:break;default:S=ee;break}}else _++;_>0&&Za(this.observer,new Error(`Found ${_} TS packet/s that do not start with 0x47`)),l.pesData=m,u.pesData=v,f.pesData=x;const K={audioTrack:u,videoTrack:l,id3Track:f,textTrack:d};return i&&this.extractRemainingSamples(K),K}flush(){const{remainderData:e}=this;this.remainderData=null;let t;return e?t=this.demux(e,-1,!1,!0):t={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:n,id3Track:i,textTrack:a}=e,l=n.pesData,u=t.pesData,f=i.pesData;let d;if(l&&(d=Wr(l))?(this.videoParser.parseAVCPES(n,a,d,!0,this._duration),n.pesData=null):n.pesData=l,u&&(d=Wr(u))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,d);break;case"mp3":this.parseMPEGPES(t,d);break;case"ac3":this.parseAC3PES(t,d);break}t.pesData=null}else u!=null&&u.size&&O.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=u;f&&(d=Wr(f))?(this.parseID3PES(i,d),i.pesData=null):i.pesData=f}demuxSampleAes(e,t,n){const i=this.demux(e,n,!0,!this.config.progressive),a=this.sampleAes=new px(this.observer,this.config,t);return this.decrypt(i,a)}decrypt(e,t){return new Promise(n=>{const{audioTrack:i,videoTrack:a}=e;i.samples&&i.segmentCodec==="aac"?t.decryptAacSamples(i.samples,0,()=>{a.samples?t.decryptAvcSamples(a.samples,0,0,()=>{n(e)}):n(e)}):a.samples&&t.decryptAvcSamples(a.samples,0,0,()=>{n(e)})})}destroy(){this._duration=0}parseAACPES(e,t){let n=0;const i=this.aacOverFlow;let a=t.data;if(i){this.aacOverFlow=null;const m=i.missing,y=i.sample.unit.byteLength;if(m===-1)a=Gt(i.sample.unit,a);else{const T=y-m;i.sample.unit.set(a.subarray(0,m),T),e.samples.push(i.sample),n=i.missing}}let l,u;for(l=n,u=a.length;l<u-1&&!Ja(a,l);l++);if(l!==n){let m;const y=l<u-1;if(y?m=`AAC PES did not start with ADTS header,offset:${l}`:m="No ADTS header found in AAC PES",Za(this.observer,new Error(m),y),!y)return}Um(e,this.observer,a,l,this.audioCodec);let f;if(t.pts!==void 0)f=t.pts;else if(i){const m=Bm(e.samplerate);f=i.sample.pts+m}else{O.warn("[tsdemuxer]: AAC PES unknown PTS");return}let d=0,p;for(;l<u;)if(p=$m(e,a,l,f,d),l+=p.length,p.missing){this.aacOverFlow=p;break}else for(d++;l<u-1&&!Ja(a,l);l++);}parseMPEGPES(e,t){const n=t.data,i=n.length;let a=0,l=0;const u=t.pts;if(u===void 0){O.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;l<i;)if(Vm(n,l)){const f=Gm(e,n,l,u,a);if(f)l+=f.length,a++;else break}else l++}parseAC3PES(e,t){{const n=t.data,i=t.pts;if(i===void 0){O.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const a=n.length;let l=0,u=0,f;for(;u<a&&(f=zm(e,n,u,i,l++))>0;)u+=f}}parseID3PES(e,t){if(t.pts===void 0){O.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const n=Ze({},t,{type:this._videoTrack?Qt.emsg:Qt.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(n)}}function Yu(o,e){return((o[e+1]&31)<<8)+o[e+2]}function mx(o,e){return(o[e+10]&31)<<8|o[e+11]}function gx(o,e,t,n,i){const a={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},l=(o[e+1]&15)<<8|o[e+2],u=e+3+l-4,f=(o[e+10]&15)<<8|o[e+11];for(e+=12+f;e<u;){const d=Yu(o,e),p=(o[e+3]&15)<<8|o[e+4];switch(o[e]){case 207:if(!n){vu("ADTS AAC");break}case 15:a.audioPid===-1&&(a.audioPid=d);break;case 21:a.id3Pid===-1&&(a.id3Pid=d);break;case 219:if(!n){vu("H.264");break}case 27:a.videoPid===-1&&(a.videoPid=d,a.segmentVideoCodec="avc");break;case 3:case 4:!t.mpeg&&!t.mp3?O.log("MPEG audio found, not supported in this browser"):a.audioPid===-1&&(a.audioPid=d,a.segmentAudioCodec="mp3");break;case 193:if(!n){vu("AC-3");break}case 129:t.ac3?a.audioPid===-1&&(a.audioPid=d,a.segmentAudioCodec="ac3"):O.log("AC-3 audio found, not supported in this browser");break;case 6:if(a.audioPid===-1&&p>0){let m=e+5,y=p;for(;y>2;){switch(o[m]){case 106:t.ac3!==!0?O.log("AC-3 audio found, not supported in this browser for now"):(a.audioPid=d,a.segmentAudioCodec="ac3");break}const v=o[m+1]+2;m+=v,y-=v}}break;case 194:case 135:return Za(i,new Error("Unsupported EC-3 in M2TS found")),a;case 36:return Za(i,new Error("Unsupported HEVC in M2TS found")),a}e+=p+5}return a}function Za(o,e,t){O.warn(`parsing error: ${e.message}`),o.emit(L.ERROR,L.ERROR,{type:Le.MEDIA_ERROR,details:G.FRAG_PARSING_ERROR,fatal:!1,levelRetry:t,error:e,reason:e.message})}function vu(o){O.log(`${o} with AES-128-CBC encryption found in unencrypted stream`)}function Wr(o){let e=0,t,n,i,a,l;const u=o.data;if(!o||o.size===0)return null;for(;u[0].length<19&&u.length>1;)u[0]=Gt(u[0],u[1]),u.splice(1,1);if(t=u[0],(t[0]<<16)+(t[1]<<8)+t[2]===1){if(n=(t[4]<<8)+t[5],n&&n>o.size-6)return null;const d=t[7];d&192&&(a=(t[9]&14)*536870912+(t[10]&255)*4194304+(t[11]&254)*16384+(t[12]&255)*128+(t[13]&254)/2,d&64?(l=(t[14]&14)*536870912+(t[15]&255)*4194304+(t[16]&254)*16384+(t[17]&255)*128+(t[18]&254)/2,a-l>60*9e4&&(O.warn(`${Math.round((a-l)/9e4)}s delta between PTS and DTS, align them`),a=l)):l=a),i=t[8];let p=i+9;if(o.size<=p)return null;o.size-=p;const m=new Uint8Array(o.size);for(let y=0,T=u.length;y<T;y++){t=u[y];let v=t.byteLength;if(p)if(p>v){p-=v;continue}else t=t.subarray(p),v-=p,p=0;m.set(t,e),e+=v}return n&&(n-=i+3),{data:m,pts:a,dts:l,len:n}}return null}class yx extends vc{resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=Ji(e,0);let n=(t==null?void 0:t.length)||0;if(t&&e[n]===11&&e[n+1]===119&&hc(t)!==void 0&&jm(e,n)<=16)return!1;for(let i=e.length;n<i;n++)if(Km(e,n))return O.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return ox(e,t)}appendFrame(e,t,n){if(this.basePTS!==null)return Gm(e,t,n,this.basePTS,this.frameIndex)}}class gp{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const Xn=Math.pow(2,32)-1;class N{static init(){N.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in N.types)N.types.hasOwnProperty(e)&&(N.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);N.HDLR_TYPES={video:t,audio:n};const i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),a=new Uint8Array([0,0,0,0,0,0,0,0]);N.STTS=N.STSC=N.STCO=a,N.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),N.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),N.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),N.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const l=new Uint8Array([105,115,111,109]),u=new Uint8Array([97,118,99,49]),f=new Uint8Array([0,0,0,1]);N.FTYP=N.box(N.types.ftyp,l,f,l,u),N.DINF=N.box(N.types.dinf,N.box(N.types.dref,i))}static box(e,...t){let n=8,i=t.length;const a=i;for(;i--;)n+=t[i].byteLength;const l=new Uint8Array(n);for(l[0]=n>>24&255,l[1]=n>>16&255,l[2]=n>>8&255,l[3]=n&255,l.set(e,4),i=0,n=8;i<a;i++)l.set(t[i],n),n+=t[i].byteLength;return l}static hdlr(e){return N.box(N.types.hdlr,N.HDLR_TYPES[e])}static mdat(e){return N.box(N.types.mdat,e)}static mdhd(e,t){t*=e;const n=Math.floor(t/(Xn+1)),i=Math.floor(t%(Xn+1));return N.box(N.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24,n>>16&255,n>>8&255,n&255,i>>24,i>>16&255,i>>8&255,i&255,85,196,0,0]))}static mdia(e){return N.box(N.types.mdia,N.mdhd(e.timescale,e.duration),N.hdlr(e.type),N.minf(e))}static mfhd(e){return N.box(N.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?N.box(N.types.minf,N.box(N.types.smhd,N.SMHD),N.DINF,N.stbl(e)):N.box(N.types.minf,N.box(N.types.vmhd,N.VMHD),N.DINF,N.stbl(e))}static moof(e,t,n){return N.box(N.types.moof,N.mfhd(e),N.traf(n,t))}static moov(e){let t=e.length;const n=[];for(;t--;)n[t]=N.trak(e[t]);return N.box.apply(null,[N.types.moov,N.mvhd(e[0].timescale,e[0].duration)].concat(n).concat(N.mvex(e)))}static mvex(e){let t=e.length;const n=[];for(;t--;)n[t]=N.trex(e[t]);return N.box.apply(null,[N.types.mvex,...n])}static mvhd(e,t){t*=e;const n=Math.floor(t/(Xn+1)),i=Math.floor(t%(Xn+1)),a=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24,n>>16&255,n>>8&255,n&255,i>>24,i>>16&255,i>>8&255,i&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return N.box(N.types.mvhd,a)}static sdtp(e){const t=e.samples||[],n=new Uint8Array(4+t.length);let i,a;for(i=0;i<t.length;i++)a=t[i].flags,n[i+4]=a.dependsOn<<4|a.isDependedOn<<2|a.hasRedundancy;return N.box(N.types.sdtp,n)}static stbl(e){return N.box(N.types.stbl,N.stsd(e),N.box(N.types.stts,N.STTS),N.box(N.types.stsc,N.STSC),N.box(N.types.stsz,N.STSZ),N.box(N.types.stco,N.STCO))}static avc1(e){let t=[],n=[],i,a,l;for(i=0;i<e.sps.length;i++)a=e.sps[i],l=a.byteLength,t.push(l>>>8&255),t.push(l&255),t=t.concat(Array.prototype.slice.call(a));for(i=0;i<e.pps.length;i++)a=e.pps[i],l=a.byteLength,n.push(l>>>8&255),n.push(l&255),n=n.concat(Array.prototype.slice.call(a));const u=N.box(N.types.avcC,new Uint8Array([1,t[3],t[4],t[5],255,224|e.sps.length].concat(t).concat([e.pps.length]).concat(n))),f=e.width,d=e.height,p=e.pixelRatio[0],m=e.pixelRatio[1];return N.box(N.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,f>>8&255,f&255,d>>8&255,d&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),u,N.box(N.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),N.box(N.types.pasp,new Uint8Array([p>>24,p>>16&255,p>>8&255,p&255,m>>24,m>>16&255,m>>8&255,m&255])))}static esds(e){const t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}static audioStsd(e){const t=e.samplerate;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,t&255,0,0])}static mp4a(e){return N.box(N.types.mp4a,N.audioStsd(e),N.box(N.types.esds,N.esds(e)))}static mp3(e){return N.box(N.types[".mp3"],N.audioStsd(e))}static ac3(e){return N.box(N.types["ac-3"],N.audioStsd(e),N.box(N.types.dac3,e.config))}static stsd(e){return e.type==="audio"?e.segmentCodec==="mp3"&&e.codec==="mp3"?N.box(N.types.stsd,N.STSD,N.mp3(e)):e.segmentCodec==="ac3"?N.box(N.types.stsd,N.STSD,N.ac3(e)):N.box(N.types.stsd,N.STSD,N.mp4a(e)):N.box(N.types.stsd,N.STSD,N.avc1(e))}static tkhd(e){const t=e.id,n=e.duration*e.timescale,i=e.width,a=e.height,l=Math.floor(n/(Xn+1)),u=Math.floor(n%(Xn+1));return N.box(N.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,l>>24,l>>16&255,l>>8&255,l&255,u>>24,u>>16&255,u>>8&255,u&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,i&255,0,0,a>>8&255,a&255,0,0]))}static traf(e,t){const n=N.sdtp(e),i=e.id,a=Math.floor(t/(Xn+1)),l=Math.floor(t%(Xn+1));return N.box(N.types.traf,N.box(N.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,i&255])),N.box(N.types.tfdt,new Uint8Array([1,0,0,0,a>>24,a>>16&255,a>>8&255,a&255,l>>24,l>>16&255,l>>8&255,l&255])),N.trun(e,n.length+16+20+8+16+8+8),n)}static trak(e){return e.duration=e.duration||4294967295,N.box(N.types.trak,N.tkhd(e),N.mdia(e))}static trex(e){const t=e.id;return N.box(N.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const n=e.samples||[],i=n.length,a=12+16*i,l=new Uint8Array(a);let u,f,d,p,m,y;for(t+=8+a,l.set([e.type==="video"?1:0,0,15,1,i>>>24&255,i>>>16&255,i>>>8&255,i&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255],0),u=0;u<i;u++)f=n[u],d=f.duration,p=f.size,m=f.flags,y=f.cts,l.set([d>>>24&255,d>>>16&255,d>>>8&255,d&255,p>>>24&255,p>>>16&255,p>>>8&255,p&255,m.isLeading<<2|m.dependsOn,m.isDependedOn<<6|m.hasRedundancy<<4|m.paddingValue<<1|m.isNonSync,m.degradPrio&61440,m.degradPrio&15,y>>>24&255,y>>>16&255,y>>>8&255,y&255],12+16*u);return N.box(N.types.trun,l)}static initSegment(e){N.types||N.init();const t=N.moov(e);return Gt(N.FTYP,t)}}N.types=void 0;N.HDLR_TYPES=void 0;N.STTS=void 0;N.STSC=void 0;N.STCO=void 0;N.STSZ=void 0;N.VMHD=void 0;N.SMHD=void 0;N.STSD=void 0;N.FTYP=void 0;N.DINF=void 0;const Wm=9e4;function Sc(o,e,t=1,n=!1){const i=o*e*t;return n?Math.round(i):i}function Ex(o,e,t=1,n=!1){return Sc(o,e,1/t,n)}function zi(o,e=!1){return Sc(o,1e3,1/Wm,e)}function vx(o,e=1){return Sc(o,Wm,1/e)}const Tx=10*1e3,yp=1024,xx=1152,Sx=1536;let Yr=null,Tu=null;class Ma{constructor(e,t,n,i=""){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.ISGenerated=!1,Yr===null){const l=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Yr=l?parseInt(l[1]):0}if(Tu===null){const a=navigator.userAgent.match(/Safari\/(\d+)/i);Tu=a?parseInt(a[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){O.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){O.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){O.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1;const n=e[0].pts,i=e.reduce((a,l)=>{let u=l.pts,f=u-a;return f<-4294967296&&(t=!0,u=$t(u,n),f=u-a),f>0?a:u},n);return t&&O.debug("PTS rollover detected"),i}remux(e,t,n,i,a,l,u,f){let d,p,m,y,T,v,x=a,S=a;const R=e.pid>-1,I=t.pid>-1,w=t.samples.length,b=e.samples.length>0,_=u&&w>0||w>1;if((!R||b)&&(!I||_)||this.ISGenerated||u){if(this.ISGenerated){var U,z,ee,V;const he=this.videoTrackConfig;he&&(t.width!==he.width||t.height!==he.height||((U=t.pixelRatio)==null?void 0:U[0])!==((z=he.pixelRatio)==null?void 0:z[0])||((ee=t.pixelRatio)==null?void 0:ee[1])!==((V=he.pixelRatio)==null?void 0:V[1]))&&this.resetInitSegment()}else m=this.generateIS(e,t,a,l);const Q=this.isVideoContiguous;let ge=-1,re;if(_&&(ge=Lx(t.samples),!Q&&this.config.forceKeyFrameOnDiscontinuity))if(v=!0,ge>0){O.warn(`[mp4-remuxer]: Dropped ${ge} out of ${w} video samples due to a missing keyframe`);const he=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(ge),t.dropped+=ge,S+=(t.samples[0].pts-he)/t.inputTimeScale,re=S}else ge===-1&&(O.warn(`[mp4-remuxer]: No keyframe found out of ${w} video samples`),v=!1);if(this.ISGenerated){if(b&&_){const he=this.getVideoStartPts(t.samples),le=($t(e.samples[0].pts,he)-he)/t.inputTimeScale;x+=Math.max(0,le),S+=Math.max(0,-le)}if(b){if(e.samplerate||(O.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),m=this.generateIS(e,t,a,l)),p=this.remuxAudio(e,x,this.isAudioContiguous,l,I||_||f===Te.AUDIO?S:void 0),_){const he=p?p.endPTS-p.startPTS:0;t.inputTimeScale||(O.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),m=this.generateIS(e,t,a,l)),d=this.remuxVideo(t,S,Q,he)}}else _&&(d=this.remuxVideo(t,S,Q,0));d&&(d.firstKeyFrame=ge,d.independent=ge!==-1,d.firstKeyFramePTS=re)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(n.samples.length&&(T=Ym(n,a,this._initPTS,this._initDTS)),i.samples.length&&(y=qm(i,a,this._initPTS))),{audio:p,video:d,initSegment:m,independent:v,text:y,id3:T}}generateIS(e,t,n,i){const a=e.samples,l=t.samples,u=this.typeSupported,f={},d=this._initPTS;let p=!d||i,m="audio/mp4",y,T,v;if(p&&(y=T=1/0),e.config&&a.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":u.mpeg?(m="audio/mpeg",e.codec=""):u.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}f.audio={id:"audio",container:m,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&u.mpeg?new Uint8Array(0):N.initSegment([e]),metadata:{channelCount:e.channelCount}},p&&(v=e.inputTimeScale,!d||v!==d.timescale?y=T=a[0].pts-Math.round(v*n):p=!1)}if(t.sps&&t.pps&&l.length){if(t.timescale=t.inputTimeScale,f.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:N.initSegment([t]),metadata:{width:t.width,height:t.height}},p)if(v=t.inputTimeScale,!d||v!==d.timescale){const x=this.getVideoStartPts(l),S=Math.round(v*n);T=Math.min(T,$t(l[0].dts,x)-S),y=Math.min(y,x-S)}else p=!1;this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(f).length)return this.ISGenerated=!0,p?(this._initPTS={baseTime:y,timescale:v},this._initDTS={baseTime:T,timescale:v}):y=v=void 0,{tracks:f,initPTS:y,timescale:v}}remuxVideo(e,t,n,i){const a=e.inputTimeScale,l=e.samples,u=[],f=l.length,d=this._initPTS;let p=this.nextAvcDts,m=8,y=this.videoSampleDuration,T,v,x=Number.POSITIVE_INFINITY,S=Number.NEGATIVE_INFINITY,R=!1;if(!n||p===null){const W=t*a,H=l[0].pts-$t(l[0].dts,l[0].pts);Yr&&p!==null&&Math.abs(W-H-p)<15e3?n=!0:p=W-H}const I=d.baseTime*a/d.timescale;for(let W=0;W<f;W++){const H=l[W];H.pts=$t(H.pts-I,p),H.dts=$t(H.dts-I,p),H.dts<l[W>0?W-1:W].dts&&(R=!0)}R&&l.sort(function(W,H){const D=W.dts-H.dts,$=W.pts-H.pts;return D||$}),T=l[0].dts,v=l[l.length-1].dts;const w=v-T,b=w?Math.round(w/(f-1)):y||e.inputTimeScale/30;if(n){const W=T-p,H=W>b,D=W<-1;if((H||D)&&(H?O.warn(`AVC: ${zi(W,!0)} ms (${W}dts) hole between fragments detected at ${t.toFixed(3)}`):O.warn(`AVC: ${zi(-W,!0)} ms (${W}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!D||p>=l[0].pts||Yr)){T=p;const $=l[0].pts-W;if(H)l[0].dts=T,l[0].pts=$;else for(let se=0;se<l.length&&!(l[se].dts>$);se++)l[se].dts-=W,l[se].pts-=W;O.log(`Video: Initial PTS/DTS adjusted: ${zi($,!0)}/${zi(T,!0)}, delta: ${zi(W,!0)} ms`)}}T=Math.max(0,T);let _=0,K=0,U=T;for(let W=0;W<f;W++){const H=l[W],D=H.units,$=D.length;let se=0;for(let de=0;de<$;de++)se+=D[de].data.length;K+=se,_+=$,H.length=se,H.dts<U?(H.dts=U,U+=b/4|0||1):U=H.dts,x=Math.min(H.pts,x),S=Math.max(H.pts,S)}v=l[f-1].dts;const z=K+4*_+8;let ee;try{ee=new Uint8Array(z)}catch(W){this.observer.emit(L.ERROR,L.ERROR,{type:Le.MUX_ERROR,details:G.REMUX_ALLOC_ERROR,fatal:!1,error:W,bytes:z,reason:`fail allocating video mdat ${z}`});return}const V=new DataView(ee.buffer);V.setUint32(0,z),ee.set(N.types.mdat,4);let Q=!1,ge=Number.POSITIVE_INFINITY,re=Number.POSITIVE_INFINITY,he=Number.NEGATIVE_INFINITY,pe=Number.NEGATIVE_INFINITY;for(let W=0;W<f;W++){const H=l[W],D=H.units;let $=0;for(let xe=0,Se=D.length;xe<Se;xe++){const Ce=D[xe],ke=Ce.data,Ne=Ce.data.byteLength;V.setUint32(m,Ne),m+=4,ee.set(ke,m),m+=Ne,$+=4+Ne}let se;if(W<f-1)y=l[W+1].dts-H.dts,se=l[W+1].pts-H.pts;else{const xe=this.config,Se=W>0?H.dts-l[W-1].dts:b;if(se=W>0?H.pts-l[W-1].pts:b,xe.stretchShortVideoTrack&&this.nextAudioPts!==null){const Ce=Math.floor(xe.maxBufferHole*a),ke=(i?x+i*a:this.nextAudioPts)-H.pts;ke>Ce?(y=ke-Se,y<0?y=Se:Q=!0,O.log(`[mp4-remuxer]: It is approximately ${ke/90} ms to the next segment; using duration ${y/90} ms for the last video frame.`)):y=Se}else y=Se}const de=Math.round(H.pts-H.dts);ge=Math.min(ge,y),he=Math.max(he,y),re=Math.min(re,se),pe=Math.max(pe,se),u.push(new Ep(H.key,y,$,de))}if(u.length){if(Yr){if(Yr<70){const W=u[0].flags;W.dependsOn=2,W.isNonSync=0}}else if(Tu&&pe-re<he-ge&&b/he<.025&&u[0].cts===0){O.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let W=T;for(let H=0,D=u.length;H<D;H++){const $=W+u[H].duration,se=W+u[H].cts;if(H<D-1){const de=$+u[H+1].cts;u[H].duration=de-se}else u[H].duration=H?u[H-1].duration:b;u[H].cts=0,W=$}}}y=Q||!y?b:y,this.nextAvcDts=p=v+y,this.videoSampleDuration=y,this.isVideoContiguous=!0;const J={data1:N.moof(e.sequenceNumber++,T,Ze({},e,{samples:u})),data2:ee,startPTS:x/a,endPTS:(S+y)/a,startDTS:T/a,endDTS:p/a,type:"video",hasAudio:!1,hasVideo:!0,nb:u.length,dropped:e.dropped};return e.samples=[],e.dropped=0,J}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return xx;case"ac3":return Sx;default:return yp}}remuxAudio(e,t,n,i,a){const l=e.inputTimeScale,u=e.samplerate?e.samplerate:l,f=l/u,d=this.getSamplesPerFrame(e),p=d*f,m=this._initPTS,y=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,T=[],v=a!==void 0;let x=e.samples,S=y?0:8,R=this.nextAudioPts||-1;const I=t*l,w=m.baseTime*l/m.timescale;if(this.isAudioContiguous=n=n||x.length&&R>0&&(i&&Math.abs(I-R)<9e3||Math.abs($t(x[0].pts-w,I)-R)<20*p),x.forEach(function(le){le.pts=$t(le.pts-w,I)}),!n||R<0){if(x=x.filter(le=>le.pts>=0),!x.length)return;a===0?R=0:i&&!v?R=Math.max(0,I):R=x[0].pts}if(e.segmentCodec==="aac"){const le=this.config.maxAudioFramesDrift;for(let me=0,J=R;me<x.length;me++){const W=x[me],H=W.pts,D=H-J,$=Math.abs(1e3*D/l);if(D<=-le*p&&v)me===0&&(O.warn(`Audio frame @ ${(H/l).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*D/l)} ms.`),this.nextAudioPts=R=J=H);else if(D>=le*p&&$<Tx&&v){let se=Math.round(D/p);J=H-se*p,J<0&&(se--,J+=p),me===0&&(this.nextAudioPts=R=J),O.warn(`[mp4-remuxer]: Injecting ${se} audio frame @ ${(J/l).toFixed(3)}s due to ${Math.round(1e3*D/l)} ms gap.`);for(let de=0;de<se;de++){const xe=Math.max(J,0);let Se=gp.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);Se||(O.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),Se=W.unit.subarray()),x.splice(me,0,{unit:Se,pts:xe}),J+=p,me++}}W.pts=J,J+=p}}let b=null,_=null,K,U=0,z=x.length;for(;z--;)U+=x[z].unit.byteLength;for(let le=0,me=x.length;le<me;le++){const J=x[le],W=J.unit;let H=J.pts;if(_!==null){const $=T[le-1];$.duration=Math.round((H-_)/f)}else if(n&&e.segmentCodec==="aac"&&(H=R),b=H,U>0){U+=S;try{K=new Uint8Array(U)}catch($){this.observer.emit(L.ERROR,L.ERROR,{type:Le.MUX_ERROR,details:G.REMUX_ALLOC_ERROR,fatal:!1,error:$,bytes:U,reason:`fail allocating audio mdat ${U}`});return}y||(new DataView(K.buffer).setUint32(0,U),K.set(N.types.mdat,4))}else return;K.set(W,S);const D=W.byteLength;S+=D,T.push(new Ep(!0,d,D,0)),_=H}const ee=T.length;if(!ee)return;const V=T[T.length-1];this.nextAudioPts=R=_+f*V.duration;const Q=y?new Uint8Array(0):N.moof(e.sequenceNumber++,b/f,Ze({},e,{samples:T}));e.samples=[];const ge=b/l,re=R/l,pe={data1:Q,data2:K,startPTS:ge,endPTS:re,startDTS:ge,endDTS:re,type:"audio",hasAudio:!0,hasVideo:!1,nb:ee};return this.isAudioContiguous=!0,pe}remuxEmptyAudio(e,t,n,i){const a=e.inputTimeScale,l=e.samplerate?e.samplerate:a,u=a/l,f=this.nextAudioPts,d=this._initDTS,p=d.baseTime*9e4/d.timescale,m=(f!==null?f:i.startDTS*a)+p,y=i.endDTS*a+p,T=u*yp,v=Math.ceil((y-m)/T),x=gp.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(O.warn("[mp4-remuxer]: remux empty Audio"),!x){O.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}const S=[];for(let R=0;R<v;R++){const I=m+R*T;S.push({unit:x,pts:I,dts:I})}return e.samples=S,this.remuxAudio(e,t,n,!1)}}function $t(o,e){let t;if(e===null)return o;for(e<o?t=-8589934592:t=8589934592;Math.abs(o-e)>4294967296;)o+=t;return o}function Lx(o){for(let e=0;e<o.length;e++)if(o[e].key)return e;return-1}function Ym(o,e,t,n){const i=o.samples.length;if(!i)return;const a=o.inputTimeScale;for(let u=0;u<i;u++){const f=o.samples[u];f.pts=$t(f.pts-t.baseTime*a/t.timescale,e*a)/a,f.dts=$t(f.dts-n.baseTime*a/n.timescale,e*a)/a}const l=o.samples;return o.samples=[],{samples:l}}function qm(o,e,t){const n=o.samples.length;if(!n)return;const i=o.inputTimeScale;for(let l=0;l<n;l++){const u=o.samples[l];u.pts=$t(u.pts-t.baseTime*i/t.timescale,e*i)/i}o.samples.sort((l,u)=>l.pts-u.pts);const a=o.samples;return o.samples=[],{samples:a}}class Ep{constructor(e,t,n,i){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=t,this.size=n,this.cts=i,this.flags={isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:e?2:1,isNonSync:e?0:1}}}class Ax{constructor(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}destroy(){}resetTimeStamp(e){this.initPTS=e,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(e,t,n,i){this.audioCodec=t,this.videoCodec=n,this.generateInitSegment(Dv(e,i)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:n}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const i=this.initData=Tm(e);i.audio&&(t=vp(i.audio,Fe.AUDIO)),i.video&&(n=vp(i.video,Fe.VIDEO));const a={};i.audio&&i.video?a.audiovideo={container:"video/mp4",codec:t+","+n,initSegment:e,id:"main"}:i.audio?a.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:i.video?a.video={container:"video/mp4",codec:n,initSegment:e,id:"main"}:O.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=a}remux(e,t,n,i,a,l){var u,f;let{initPTS:d,lastEndTime:p}=this;const m={audio:void 0,video:void 0,text:i,id3:n,initSegment:void 0};oe(p)||(p=this.lastEndTime=a||0);const y=t.samples;if(!(y!=null&&y.length))return m;const T={initPTS:void 0,timescale:1};let v=this.initData;if((u=v)!=null&&u.length||(this.generateInitSegment(y),v=this.initData),!((f=v)!=null&&f.length))return O.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),m;this.emitInitSegment&&(T.tracks=this.initTracks,this.emitInitSegment=!1);const x=Pv(y,v),S=_v(v,y),R=S===null?a:S;(Rx(d,R,a,x)||T.timescale!==d.timescale&&l)&&(T.initPTS=R-a,d&&d.timescale===1&&O.warn(`Adjusting initPTS by ${T.initPTS-d.baseTime}`),this.initPTS=d={baseTime:T.initPTS,timescale:1});const I=e?R-d.baseTime/d.timescale:p,w=I+x;Ov(v,y,d.baseTime/d.timescale),x>0?this.lastEndTime=w:(O.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const b=!!v.audio,_=!!v.video;let K="";b&&(K+="audio"),_&&(K+="video");const U={data1:y,startPTS:I,startDTS:I,endPTS:w,endDTS:w,type:K,hasAudio:b,hasVideo:_,nb:1,dropped:0};return m.audio=U.type==="audio"?U:void 0,m.video=U.type!=="audio"?U:void 0,m.initSegment=T,m.id3=Ym(n,a,d,d),i.samples.length&&(m.text=qm(i,a,d)),m}}function Rx(o,e,t,n){if(o===null)return!0;const i=Math.max(n,1),a=e-o.baseTime/o.timescale;return Math.abs(a-t)>i}function vp(o,e){const t=o==null?void 0:o.codec;if(t&&t.length>4)return t;if(e===Fe.AUDIO){if(t==="ec-3"||t==="ac-3"||t==="alac")return t;if(t==="fLaC"||t==="Opus")return za(t,!1);const n="mp4a.40.5";return O.info(`Parsed audio codec "${t}" or audio object type not handled. Using "${n}"`),n}return O.warn(`Unhandled video codec "${t}"`),t==="hvc1"||t==="hev1"?"hvc1.1.6.L120.90":t==="av01"?"av01.0.04M.08":"avc1.42e01e"}let Cn;try{Cn=self.performance.now.bind(self.performance)}catch{O.debug("Unable to use Performance API on this environment"),Cn=Zr==null?void 0:Zr.Date.now}const Ua=[{demux:cx,remux:Ax},{demux:Qn,remux:Ma},{demux:lx,remux:Ma},{demux:yx,remux:Ma}];Ua.splice(2,0,{demux:fx,remux:Ma});class Tp{constructor(e,t,n,i,a){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=n,this.vendor=i,this.id=a}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,n,i){const a=n.transmuxing;a.executeStart=Cn();let l=new Uint8Array(e);const{currentTransmuxState:u,transmuxConfig:f}=this;i&&(this.currentTransmuxState=i);const{contiguous:d,discontinuity:p,trackSwitch:m,accurateTimeOffset:y,timeOffset:T,initSegmentChange:v}=i||u,{audioCodec:x,videoCodec:S,defaultInitPts:R,duration:I,initSegmentData:w}=f,b=wx(l,t);if(b&&b.method==="AES-128"){const z=this.getDecrypter();if(z.isSync()){let ee=z.softwareDecrypt(l,b.key.buffer,b.iv.buffer);if(n.part>-1&&(ee=z.flush()),!ee)return a.executeEnd=Cn(),xu(n);l=new Uint8Array(ee)}else return this.decryptionPromise=z.webCryptoDecrypt(l,b.key.buffer,b.iv.buffer).then(ee=>{const V=this.push(ee,null,n);return this.decryptionPromise=null,V}),this.decryptionPromise}const _=this.needsProbing(p,m);if(_){const z=this.configureTransmuxer(l);if(z)return O.warn(`[transmuxer] ${z.message}`),this.observer.emit(L.ERROR,L.ERROR,{type:Le.MEDIA_ERROR,details:G.FRAG_PARSING_ERROR,fatal:!1,error:z,reason:z.message}),a.executeEnd=Cn(),xu(n)}(p||m||v||_)&&this.resetInitSegment(w,x,S,I,t),(p||v||_)&&this.resetInitialTimestamp(R),d||this.resetContiguity();const K=this.transmux(l,b,T,y,n),U=this.currentTransmuxState;return U.contiguous=!0,U.discontinuity=!1,U.trackSwitch=!1,a.executeEnd=Cn(),K}flush(e){const t=e.transmuxing;t.executeStart=Cn();const{decrypter:n,currentTransmuxState:i,decryptionPromise:a}=this;if(a)return a.then(()=>this.flush(e));const l=[],{timeOffset:u}=i;if(n){const m=n.flush();m&&l.push(this.push(m,null,e))}const{demuxer:f,remuxer:d}=this;if(!f||!d)return t.executeEnd=Cn(),[xu(e)];const p=f.flush(u);return Ba(p)?p.then(m=>(this.flushRemux(l,m,e),l)):(this.flushRemux(l,p,e),l)}flushRemux(e,t,n){const{audioTrack:i,videoTrack:a,id3Track:l,textTrack:u}=t,{accurateTimeOffset:f,timeOffset:d}=this.currentTransmuxState;O.log(`[transmuxer.ts]: Flushed fragment ${n.sn}${n.part>-1?" p: "+n.part:""} of level ${n.level}`);const p=this.remuxer.remux(i,a,l,u,d,f,!0,this.id);e.push({remuxResult:p,chunkMeta:n}),n.transmuxing.executeEnd=Cn()}resetInitialTimestamp(e){const{demuxer:t,remuxer:n}=this;!t||!n||(t.resetTimeStamp(e),n.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,n,i,a){const{demuxer:l,remuxer:u}=this;!l||!u||(l.resetInitSegment(e,t,n,i),u.resetInitSegment(e,t,n,a))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,n,i,a){let l;return t&&t.method==="SAMPLE-AES"?l=this.transmuxSampleAes(e,t,n,i,a):l=this.transmuxUnencrypted(e,n,i,a),l}transmuxUnencrypted(e,t,n,i){const{audioTrack:a,videoTrack:l,id3Track:u,textTrack:f}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(a,l,u,f,t,n,!1,this.id),chunkMeta:i}}transmuxSampleAes(e,t,n,i,a){return this.demuxer.demuxSampleAes(e,t,n).then(l=>({remuxResult:this.remuxer.remux(l.audioTrack,l.videoTrack,l.id3Track,l.textTrack,n,i,!1,this.id),chunkMeta:a}))}configureTransmuxer(e){const{config:t,observer:n,typeSupported:i,vendor:a}=this;let l;for(let y=0,T=Ua.length;y<T;y++){var u;if((u=Ua[y].demux)!=null&&u.probe(e)){l=Ua[y];break}}if(!l)return new Error("Failed to find demuxer by probing fragment data");const f=this.demuxer,d=this.remuxer,p=l.remux,m=l.demux;(!d||!(d instanceof p))&&(this.remuxer=new p(n,t,i,a)),(!f||!(f instanceof m))&&(this.demuxer=new m(n,t,i),this.probe=m.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new yc(this.config)),e}}function wx(o,e){let t=null;return o.byteLength>0&&(e==null?void 0:e.key)!=null&&e.iv!==null&&e.method!=null&&(t=e),t}const xu=o=>({remuxResult:{},chunkMeta:o});function Ba(o){return"then"in o&&o.then instanceof Function}class Cx{constructor(e,t,n,i,a){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=n,this.duration=i,this.defaultInitPts=a||null}}class Ix{constructor(e,t,n,i,a,l){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=n,this.trackSwitch=i,this.timeOffset=a,this.initSegmentChange=l}}var Xm={exports:{}};(function(o){var e=Object.prototype.hasOwnProperty,t="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(t=!1));function i(f,d,p){this.fn=f,this.context=d,this.once=p||!1}function a(f,d,p,m,y){if(typeof p!="function")throw new TypeError("The listener must be a function");var T=new i(p,m||f,y),v=t?t+d:d;return f._events[v]?f._events[v].fn?f._events[v]=[f._events[v],T]:f._events[v].push(T):(f._events[v]=T,f._eventsCount++),f}function l(f,d){--f._eventsCount===0?f._events=new n:delete f._events[d]}function u(){this._events=new n,this._eventsCount=0}u.prototype.eventNames=function(){var d=[],p,m;if(this._eventsCount===0)return d;for(m in p=this._events)e.call(p,m)&&d.push(t?m.slice(1):m);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(p)):d},u.prototype.listeners=function(d){var p=t?t+d:d,m=this._events[p];if(!m)return[];if(m.fn)return[m.fn];for(var y=0,T=m.length,v=new Array(T);y<T;y++)v[y]=m[y].fn;return v},u.prototype.listenerCount=function(d){var p=t?t+d:d,m=this._events[p];return m?m.fn?1:m.length:0},u.prototype.emit=function(d,p,m,y,T,v){var x=t?t+d:d;if(!this._events[x])return!1;var S=this._events[x],R=arguments.length,I,w;if(S.fn){switch(S.once&&this.removeListener(d,S.fn,void 0,!0),R){case 1:return S.fn.call(S.context),!0;case 2:return S.fn.call(S.context,p),!0;case 3:return S.fn.call(S.context,p,m),!0;case 4:return S.fn.call(S.context,p,m,y),!0;case 5:return S.fn.call(S.context,p,m,y,T),!0;case 6:return S.fn.call(S.context,p,m,y,T,v),!0}for(w=1,I=new Array(R-1);w<R;w++)I[w-1]=arguments[w];S.fn.apply(S.context,I)}else{var b=S.length,_;for(w=0;w<b;w++)switch(S[w].once&&this.removeListener(d,S[w].fn,void 0,!0),R){case 1:S[w].fn.call(S[w].context);break;case 2:S[w].fn.call(S[w].context,p);break;case 3:S[w].fn.call(S[w].context,p,m);break;case 4:S[w].fn.call(S[w].context,p,m,y);break;default:if(!I)for(_=1,I=new Array(R-1);_<R;_++)I[_-1]=arguments[_];S[w].fn.apply(S[w].context,I)}}return!0},u.prototype.on=function(d,p,m){return a(this,d,p,m,!1)},u.prototype.once=function(d,p,m){return a(this,d,p,m,!0)},u.prototype.removeListener=function(d,p,m,y){var T=t?t+d:d;if(!this._events[T])return this;if(!p)return l(this,T),this;var v=this._events[T];if(v.fn)v.fn===p&&(!y||v.once)&&(!m||v.context===m)&&l(this,T);else{for(var x=0,S=[],R=v.length;x<R;x++)(v[x].fn!==p||y&&!v[x].once||m&&v[x].context!==m)&&S.push(v[x]);S.length?this._events[T]=S.length===1?S[0]:S:l(this,T)}return this},u.prototype.removeAllListeners=function(d){var p;return d?(p=t?t+d:d,this._events[p]&&l(this,p)):(this._events=new n,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=t,u.EventEmitter=u,o.exports=u})(Xm);var kx=Xm.exports,Lc=JE(kx);class Qm{constructor(e,t,n,i){this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;const a=e.config;this.hls=e,this.id=t,this.useWorker=!!a.enableWorker,this.onTransmuxComplete=n,this.onFlush=i;const l=(d,p)=>{p=p||{},p.frag=this.frag,p.id=this.id,d===L.ERROR&&(this.error=p.error),this.hls.trigger(d,p)};this.observer=new Lc,this.observer.on(L.FRAG_DECRYPTED,l),this.observer.on(L.ERROR,l);const u=vr(a.preferManagedMediaSource)||{isTypeSupported:()=>!1},f={mpeg:u.isTypeSupported("audio/mpeg"),mp3:u.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:u.isTypeSupported('audio/mp4; codecs="ac-3"')};if(this.useWorker&&typeof Worker<"u"&&(a.workerPath||YT())){try{a.workerPath?(O.log(`loading Web Worker ${a.workerPath} for "${t}"`),this.workerContext=XT(a.workerPath)):(O.log(`injecting Web Worker for "${t}"`),this.workerContext=qT()),this.onwmsg=m=>this.onWorkerMessage(m);const{worker:p}=this.workerContext;p.addEventListener("message",this.onwmsg),p.onerror=m=>{const y=new Error(`${m.message}  (${m.filename}:${m.lineno})`);a.enableWorker=!1,O.warn(`Error in "${t}" Web Worker, fallback to inline`),this.hls.trigger(L.ERROR,{type:Le.OTHER_ERROR,details:G.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:y})},p.postMessage({cmd:"init",typeSupported:f,vendor:"",id:t,config:JSON.stringify(a)})}catch(p){O.warn(`Error setting up "${t}" Web Worker, fallback to inline`,p),this.resetWorker(),this.error=null,this.transmuxer=new Tp(this.observer,f,a,"",t)}return}this.transmuxer=new Tp(this.observer,f,a,"",t)}resetWorker(){if(this.workerContext){const{worker:e,objectURL:t}=this.workerContext;t&&self.URL.revokeObjectURL(t),e.removeEventListener("message",this.onwmsg),e.onerror=null,e.terminate(),this.workerContext=null}}destroy(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null}push(e,t,n,i,a,l,u,f,d,p){var m,y;d.transmuxing.start=self.performance.now();const{transmuxer:T}=this,v=l?l.start:a.start,x=a.decryptdata,S=this.frag,R=!(S&&a.cc===S.cc),I=!(S&&d.level===S.level),w=S?d.sn-S.sn:-1,b=this.part?d.part-this.part.index:-1,_=w===0&&d.id>1&&d.id===(S==null?void 0:S.stats.chunkCount),K=!I&&(w===1||w===0&&(b===1||_&&b<=0)),U=self.performance.now();(I||w||a.stats.parsing.start===0)&&(a.stats.parsing.start=U),l&&(b||!K)&&(l.stats.parsing.start=U);const z=!(S&&((m=a.initSegment)==null?void 0:m.url)===((y=S.initSegment)==null?void 0:y.url)),ee=new Ix(R,K,f,I,v,z);if(!K||R||z){O.log(`[transmuxer-interface, ${a.type}]: Starting new transmux session for sn: ${d.sn} p: ${d.part} level: ${d.level} id: ${d.id}
        discontinuity: ${R}
        trackSwitch: ${I}
        contiguous: ${K}
        accurateTimeOffset: ${f}
        timeOffset: ${v}
        initSegmentChange: ${z}`);const V=new Cx(n,i,t,u,p);this.configureTransmuxer(V)}if(this.frag=a,this.part=l,this.workerContext)this.workerContext.worker.postMessage({cmd:"demux",data:e,decryptdata:x,chunkMeta:d,state:ee},e instanceof ArrayBuffer?[e]:[]);else if(T){const V=T.push(e,x,d,ee);Ba(V)?(T.async=!0,V.then(Q=>{this.handleTransmuxComplete(Q)}).catch(Q=>{this.transmuxerError(Q,d,"transmuxer-interface push error")})):(T.async=!1,this.handleTransmuxComplete(V))}}flush(e){e.transmuxing.start=self.performance.now();const{transmuxer:t}=this;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:e});else if(t){let n=t.flush(e);Ba(n)||t.async?(Ba(n)||(n=Promise.resolve(n)),n.then(a=>{this.handleFlushResult(a,e)}).catch(a=>{this.transmuxerError(a,e,"transmuxer-interface flush error")})):this.handleFlushResult(n,e)}}transmuxerError(e,t,n){this.hls&&(this.error=e,this.hls.trigger(L.ERROR,{type:Le.MEDIA_ERROR,details:G.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,fatal:!1,error:e,err:e,reason:n}))}handleFlushResult(e,t){e.forEach(n=>{this.handleTransmuxComplete(n)}),this.onFlush(t)}onWorkerMessage(e){const t=e.data;if(!(t!=null&&t.event)){O.warn(`worker message received with no ${t?"event name":"data"}`);return}const n=this.hls;if(this.hls)switch(t.event){case"init":{var i;const a=(i=this.workerContext)==null?void 0:i.objectURL;a&&self.URL.revokeObjectURL(a);break}case"transmuxComplete":{this.handleTransmuxComplete(t.data);break}case"flush":{this.onFlush(t.data);break}case"workerLog":O[t.data.logType]&&O[t.data.logType](t.data.message);break;default:{t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,n.trigger(t.event,t.data);break}}}configureTransmuxer(e){const{transmuxer:t}=this;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:e}):t&&t.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}const xp=100;class Dx extends Ec{constructor(e,t,n){super(e,t,n,"[audio-stream-controller]",Te.AUDIO),this.videoBuffer=null,this.videoTrackCC=-1,this.waitingVideoCC=-1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null}_registerListeners(){const{hls:e}=this;e.on(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.LEVEL_LOADED,this.onLevelLoaded,this),e.on(L.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(L.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(L.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(L.ERROR,this.onError,this),e.on(L.BUFFER_RESET,this.onBufferReset,this),e.on(L.BUFFER_CREATED,this.onBufferCreated,this),e.on(L.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(L.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(L.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(L.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.LEVEL_LOADED,this.onLevelLoaded,this),e.off(L.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(L.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(L.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(L.ERROR,this.onError,this),e.off(L.BUFFER_RESET,this.onBufferReset,this),e.off(L.BUFFER_CREATED,this.onBufferCreated,this),e.off(L.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(L.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(L.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(L.FRAG_BUFFERED,this.onFragBuffered,this)}onInitPtsFound(e,{frag:t,id:n,initPTS:i,timescale:a}){if(n==="main"){const l=t.cc;this.initPTS[t.cc]={baseTime:i,timescale:a},this.log(`InitPTS for cc: ${l} found from main: ${i}`),this.videoTrackCC=l,this.state===Y.WAITING_INIT_PTS&&this.tick()}}startLoad(e){if(!this.levels){this.startPosition=e,this.state=Y.STOPPED;return}const t=this.lastCurrentTime;this.stopLoad(),this.setInterval(xp),t>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t,this.state=Y.IDLE):(this.loadedmetadata=!1,this.state=Y.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}doTick(){switch(this.state){case Y.IDLE:this.doTickIdle();break;case Y.WAITING_TRACK:{var e;const{levels:n,trackId:i}=this,a=n==null||(e=n[i])==null?void 0:e.details;if(a){if(this.waitForCdnTuneIn(a))break;this.state=Y.WAITING_INIT_PTS}break}case Y.FRAG_LOADING_WAITING_RETRY:{var t;const n=performance.now(),i=this.retryDate;if(!i||n>=i||(t=this.media)!=null&&t.seeking){const{levels:a,trackId:l}=this;this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded((a==null?void 0:a[l])||null),this.state=Y.IDLE}break}case Y.WAITING_INIT_PTS:{const n=this.waitingData;if(n){const{frag:i,part:a,cache:l,complete:u}=n;if(this.initPTS[i.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=Y.FRAG_LOADING;const f=l.flush(),d={frag:i,part:a,payload:f,networkDetails:null};this._handleFragmentLoadProgress(d),u&&super._handleFragmentLoadComplete(d)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log(`Waiting fragment cc (${i.cc}) cancelled because video is at cc ${this.videoTrackCC}`),this.clearWaitingFragment();else{const f=this.getLoadPosition(),d=Ue.bufferInfo(this.mediaBuffer,f,this.config.maxBufferHole);Wu(d.end,this.config.maxFragLookUpTolerance,i)<0&&(this.log(`Waiting fragment cc (${i.cc}) @ ${i.start} cancelled because another fragment at ${d.end} is needed`),this.clearWaitingFragment())}}else this.state=Y.IDLE}}this.onTickEnd()}clearWaitingFragment(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=Y.IDLE)}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){const{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){const{hls:e,levels:t,media:n,trackId:i}=this,a=e.config;if(!this.buffering||!n&&(this.startFragRequested||!a.startFragPrefetch)||!(t!=null&&t[i]))return;const l=t[i],u=l.details;if(!u||u.live&&this.levelLastLoaded!==l||this.waitForCdnTuneIn(u)){this.state=Y.WAITING_TRACK;return}const f=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&f&&(this.bufferFlushed=!1,this.afterBufferFlushed(f,Fe.AUDIO,Te.AUDIO));const d=this.getFwdBufferInfo(f,Te.AUDIO);if(d===null)return;if(!this.switchingTrack&&this._streamEnded(d,u)){e.trigger(L.BUFFER_EOS,{type:"audio"}),this.state=Y.ENDED;return}const p=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,Te.MAIN),m=d.len,y=this.getMaxBufferLength(p==null?void 0:p.len),T=u.fragments,v=T[0].start,x=this.getLoadPosition(),S=this.flushing?x:d.end;if(this.switchingTrack&&n){const b=x;u.PTSKnown&&b<v&&(d.end>v||d.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),n.currentTime=v+.05)}if(m>=y&&!this.switchingTrack&&S<T[T.length-1].start)return;let R=this.getNextFragment(S,u),I=!1;if(R&&this.isLoopLoading(R,S)&&(I=!!R.gap,R=this.getNextFragmentLoopLoading(R,u,d,Te.MAIN,y)),!R){this.bufferFlushed=!0;return}const w=p&&R.start>p.end+u.targetduration;if(w||!(p!=null&&p.len)&&d.len){const b=this.getAppendedFrag(R.start,Te.MAIN);if(b===null||(I||(I=!!b.gap||!!w&&p.len===0),w&&!I||I&&d.nextStart&&d.nextStart<b.end))return}this.loadFragment(R,l,S)}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.min(Math.max(t,e),this.config.maxMaxBufferLength):t}onMediaDetaching(){this.videoBuffer=null,this.bufferFlushed=this.flushing=!1,super.onMediaDetaching()}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(n=>new ei(n))}onAudioTrackSwitching(e,t){const n=!!t.url;this.trackId=t.id;const{fragCurrent:i}=this;i&&(i.abortRequests(),this.removeUnbufferedFrags(i.start)),this.resetLoadingState(),n?this.setInterval(xp):this.resetTransmuxer(),n?(this.switchingTrack=t,this.state=Y.IDLE,this.flushAudioIfNeeded(t)):(this.switchingTrack=null,this.bufferedTrack=t,this.state=Y.STOPPED),this.tick()}onManifestLoading(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=this.flushing=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1}onLevelLoaded(e,t){this.mainDetails=t.details,this.cachedTrackLoadedData!==null&&(this.hls.trigger(L.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}onAudioTrackLoaded(e,t){var n;if(this.mainDetails==null){this.cachedTrackLoadedData=t;return}const{levels:i}=this,{details:a,id:l}=t;if(!i){this.warn(`Audio tracks were reset while loading level ${l}`);return}this.log(`Audio track ${l} loaded [${a.startSN},${a.endSN}]${a.lastPartSn?`[part-${a.lastPartSn}-${a.lastPartIndex}]`:""},duration:${a.totalduration}`);const u=i[l];let f=0;if(a.live||(n=u.details)!=null&&n.live){this.checkLiveUpdate(a);const p=this.mainDetails;if(a.deltaUpdateFailed||!p)return;if(!u.details&&a.hasProgramDateTime&&p.hasProgramDateTime)Qa(a,p),f=a.fragments[0].start;else{var d;f=this.alignPlaylists(a,u.details,(d=this.levelLastLoaded)==null?void 0:d.details)}}u.details=a,this.levelLastLoaded=u,!this.startFragRequested&&(this.mainDetails||!a.live)&&this.setStartPosition(this.mainDetails||a,f),this.state===Y.WAITING_TRACK&&!this.waitForCdnTuneIn(a)&&(this.state=Y.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:n,part:i,payload:a}=e,{config:l,trackId:u,levels:f}=this;if(!f){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}const d=f[u];if(!d){this.warn("Audio track is undefined on fragment load progress");return}const p=d.details;if(!p){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(n.start);return}const m=l.defaultAudioCodec||d.audioCodec||"mp4a.40.2";let y=this.transmuxer;y||(y=this.transmuxer=new Qm(this.hls,Te.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const T=this.initPTS[n.cc],v=(t=n.initSegment)==null?void 0:t.data;if(T!==void 0){const S=i?i.index:-1,R=S!==-1,I=new gc(n.level,n.sn,n.stats.chunkCount,a.byteLength,S,R);y.push(a,v,m,"",n,i,p.totalduration,!1,I,T)}else{this.log(`Unknown video PTS for cc ${n.cc}, waiting for video PTS before demuxing audio frag ${n.sn} of [${p.startSN} ,${p.endSN}],track ${u}`);const{cache:x}=this.waitingData=this.waitingData||{frag:n,part:i,cache:new Fm,complete:!1};x.push(new Uint8Array(a)),this.waitingVideoCC=this.videoTrackCC,this.state=Y.WAITING_INIT_PTS}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1}onBufferCreated(e,t){const n=t.tracks.audio;n&&(this.mediaBuffer=n.buffer||null),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer||null)}onFragBuffered(e,t){const{frag:n,part:i}=t;if(n.type!==Te.AUDIO){if(!this.loadedmetadata&&n.type===Te.MAIN){const a=this.videoBuffer||this.media;a&&Ue.getBuffered(a).length&&(this.loadedmetadata=!0)}return}if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${i?" p: "+i.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(n.sn!=="initSegment"){this.fragPrevious=n;const a=this.switchingTrack;a&&(this.bufferedTrack=a,this.switchingTrack=null,this.hls.trigger(L.AUDIO_TRACK_SWITCHED,lt({},a)))}this.fragBufferedComplete(n,i)}onError(e,t){var n;if(t.fatal){this.state=Y.ERROR;return}switch(t.details){case G.FRAG_GAP:case G.FRAG_PARSING_ERROR:case G.FRAG_DECRYPT_ERROR:case G.FRAG_LOAD_ERROR:case G.FRAG_LOAD_TIMEOUT:case G.KEY_LOAD_ERROR:case G.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Te.AUDIO,t);break;case G.AUDIO_TRACK_LOAD_ERROR:case G.AUDIO_TRACK_LOAD_TIMEOUT:case G.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===Y.WAITING_TRACK&&((n=t.context)==null?void 0:n.type)===De.AUDIO_TRACK&&(this.state=Y.IDLE);break;case G.BUFFER_APPEND_ERROR:case G.BUFFER_FULL_ERROR:if(!t.parent||t.parent!=="audio")return;if(t.details===G.BUFFER_APPEND_ERROR){this.resetLoadingState();return}this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case G.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushing(e,{type:t}){t!==Fe.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:t}){if(t!==Fe.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===Y.ENDED&&(this.state=Y.IDLE);const n=this.mediaBuffer||this.media;n&&(this.afterBufferFlushed(n,t,Te.AUDIO),this.tick())}}_handleTransmuxComplete(e){var t;const n="audio",{hls:i}=this,{remuxResult:a,chunkMeta:l}=e,u=this.getCurrentContext(l);if(!u){this.resetWhenMissingContext(l);return}const{frag:f,part:d,level:p}=u,{details:m}=p,{audio:y,text:T,id3:v,initSegment:x}=a;if(this.fragContextChanged(f)||!m){this.fragmentTracker.removeFragment(f);return}if(this.state=Y.PARSING,this.switchingTrack&&y&&this.completeAudioSwitch(this.switchingTrack),x!=null&&x.tracks){const S=f.initSegment||f;this._bufferInitSegment(p,x.tracks,S,l),i.trigger(L.FRAG_PARSING_INIT_SEGMENT,{frag:S,id:n,tracks:x.tracks})}if(y){const{startPTS:S,endPTS:R,startDTS:I,endDTS:w}=y;d&&(d.elementaryStreams[Fe.AUDIO]={startPTS:S,endPTS:R,startDTS:I,endDTS:w}),f.setElementaryStreamInfo(Fe.AUDIO,S,R,I,w),this.bufferFragmentData(y,f,d,l)}if(v!=null&&(t=v.samples)!=null&&t.length){const S=Ze({id:n,frag:f,details:m},v);i.trigger(L.FRAG_PARSING_METADATA,S)}if(T){const S=Ze({id:n,frag:f,details:m},T);i.trigger(L.FRAG_PARSING_USERDATA,S)}}_bufferInitSegment(e,t,n,i){if(this.state!==Y.PARSING)return;t.video&&delete t.video;const a=t.audio;if(!a)return;a.id="audio";const l=e.audioCodec;this.log(`Init audio buffer, container:${a.container}, codecs[level/parsed]=[${l}/${a.codec}]`),l&&l.split(",").length===1&&(a.levelCodec=l),this.hls.trigger(L.BUFFER_CODECS,t);const u=a.initSegment;if(u!=null&&u.byteLength){const f={type:"audio",frag:n,part:null,chunkMeta:i,parent:n.type,data:u};this.hls.trigger(L.BUFFER_APPENDING,f)}this.tickImmediate()}loadFragment(e,t,n){const i=this.fragmentTracker.getState(e);if(this.fragCurrent=e,this.switchingTrack||i===ot.NOT_LOADED||i===ot.PARTIAL){var a;if(e.sn==="initSegment")this._loadInitSegment(e,t);else if((a=t.details)!=null&&a.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=Y.WAITING_INIT_PTS;const l=this.mainDetails;l&&l.fragments[0].start!==t.details.fragments[0].start&&Qa(t.details,l)}else this.startFragRequested=!0,super.loadFragment(e,t,n)}else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){if(this.media&&this.bufferedTrack){const{name:t,lang:n,assocLang:i,characteristics:a,audioCodec:l,channels:u}=this.bufferedTrack;yr({name:t,lang:n,assocLang:i,characteristics:a,audioCodec:l,channels:u},e,pr)||(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null)}}completeAudioSwitch(e){const{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(L.AUDIO_TRACK_SWITCHED,lt({},e))}}function Jm(o,e){if(o.length!==e.length)return!1;for(let t=0;t<o.length;t++)if(!ts(o[t].attrs,e[t].attrs))return!1;return!0}function ts(o,e,t){const n=o["STABLE-RENDITION-ID"];return n&&!t?n===e["STABLE-RENDITION-ID"]:!(t||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(i=>o[i]!==e[i])}function qu(o,e){return e.label.toLowerCase()===o.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(o.lang||"").toLowerCase())}class _x extends mc{constructor(e){super(e,"[audio-track-controller]"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.MANIFEST_PARSED,this.onManifestParsed,this),e.on(L.LEVEL_LOADING,this.onLevelLoading,this),e.on(L.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(L.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(L.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.MANIFEST_PARSED,this.onManifestParsed,this),e.off(L.LEVEL_LOADING,this.onLevelLoading,this),e.off(L.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(L.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(L.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:n,groupId:i,details:a}=t,l=this.tracksInGroup[n];if(!l||l.groupId!==i){this.warn(`Audio track with id:${n} and group:${i} not found in active group ${l==null?void 0:l.groupId}`);return}const u=l.details;l.details=t.details,this.log(`Audio track ${n} "${l.name}" lang:${l.lang} group:${i} loaded [${a.startSN}-${a.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,u)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.audioGroups||null,i=this.groupIds;let a=this.currentTrack;if(!n||(i==null?void 0:i.length)!==(n==null?void 0:n.length)||n!=null&&n.some(u=>(i==null?void 0:i.indexOf(u))===-1)){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const u=this.tracks.filter(y=>!n||n.indexOf(y.groupId)!==-1);if(u.length)this.selectDefaultTrack&&!u.some(y=>y.default)&&(this.selectDefaultTrack=!1),u.forEach((y,T)=>{y.id=T});else if(!a&&!this.tracksInGroup.length)return;this.tracksInGroup=u;const f=this.hls.config.audioPreference;if(!a&&f){const y=un(f,u,pr);if(y>-1)a=u[y];else{const T=un(f,this.tracks);a=this.tracks[T]}}let d=this.findTrackId(a);d===-1&&a&&(d=this.findTrackId(null));const p={audioTracks:u};this.log(`Updating audio tracks, ${u.length} track(s) found in group(s): ${n==null?void 0:n.join(",")}`),this.hls.trigger(L.AUDIO_TRACKS_UPDATED,p);const m=this.trackId;if(d!==-1&&m===-1)this.setAudioTrack(d);else if(u.length&&m===-1){var l;const y=new Error(`No audio track selected for current audio group-ID(s): ${(l=this.groupIds)==null?void 0:l.join(",")} track count: ${u.length}`);this.warn(y.message),this.hls.trigger(L.ERROR,{type:Le.MEDIA_ERROR,details:G.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:y})}}else this.shouldReloadPlaylist(a)&&this.setAudioTrack(this.trackId)}onError(e,t){t.fatal||!t.context||t.context.type===De.AUDIO_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&(this.requestScheduled=-1,this.checkRetry(t))}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const t=this.hls;if(t.config.audioPreference=e,e){const n=this.allAudioTracks;if(this.selectDefaultTrack=!1,n.length){const i=this.currentTrack;if(i&&yr(e,i,pr))return i;const a=un(e,this.tracksInGroup,pr);if(a>-1){const l=this.tracksInGroup[a];return this.setAudioTrack(a),l}else if(i){let l=t.loadLevel;l===-1&&(l=t.firstAutoLevel);const u=_T(e,t.levels,n,l,pr);if(u===-1)return null;t.nextLoadLevel=u}if(e.channels||e.audioCodec){const l=un(e,n);if(l>-1)return n[l]}}}return null}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length){this.warn(`Invalid audio track id: ${e}`);return}this.clearTimer(),this.selectDefaultTrack=!1;const n=this.currentTrack,i=t[e],a=i.details&&!i.details.live;if(e===this.trackId&&i===n&&a||(this.log(`Switching to audio-track ${e} "${i.name}" lang:${i.lang} group:${i.groupId} channels:${i.channels}`),this.trackId=e,this.currentTrack=i,this.hls.trigger(L.AUDIO_TRACK_SWITCHING,lt({},i)),a))return;const l=this.switchParams(i.url,n==null?void 0:n.details,i.details);this.loadPlaylist(l)}findTrackId(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const i=t[n];if(!(this.selectDefaultTrack&&!i.default)&&(!e||yr(e,i,pr)))return n}if(e){const{name:n,lang:i,assocLang:a,characteristics:l,audioCodec:u,channels:f}=e;for(let d=0;d<t.length;d++){const p=t[d];if(yr({name:n,lang:i,assocLang:a,characteristics:l,audioCodec:u,channels:f},p,pr))return d}for(let d=0;d<t.length;d++){const p=t[d];if(ts(e.attrs,p.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return d}for(let d=0;d<t.length;d++){const p=t[d];if(ts(e.attrs,p.attrs,["LANGUAGE"]))return d}}return-1}loadPlaylist(e){const t=this.currentTrack;if(this.shouldLoadPlaylist(t)&&t){super.loadPlaylist();const n=t.id,i=t.groupId;let a=t.url;if(e)try{a=e.addDirectives(a)}catch(l){this.warn(`Could not construct new URL with HLS Delivery Directives: ${l}`)}this.log(`loading audio-track playlist ${n} "${t.name}" lang:${t.lang} group:${i}`),this.clearTimer(),this.hls.trigger(L.AUDIO_TRACK_LOADING,{url:a,id:n,groupId:i,deliveryDirectives:e||null})}}}const Sp=500;class Px extends Ec{constructor(e,t,n){super(e,t,n,"[subtitle-stream-controller]",Te.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}_registerListeners(){const{hls:e}=this;e.on(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.LEVEL_LOADED,this.onLevelLoaded,this),e.on(L.ERROR,this.onError,this),e.on(L.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(L.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(L.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(L.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(L.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(L.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.LEVEL_LOADED,this.onLevelLoaded,this),e.off(L.ERROR,this.onError,this),e.off(L.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(L.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(L.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(L.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(L.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(L.FRAG_BUFFERED,this.onFragBuffered,this)}startLoad(e){this.stopLoad(),this.state=Y.IDLE,this.setInterval(Sp),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()}onMediaDetaching(){this.tracksBuffered=[],super.onMediaDetaching()}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:n,success:i}=t;if(this.fragPrevious=n,this.state=Y.IDLE,!i)return;const a=this.tracksBuffered[this.currentTrackId];if(!a)return;let l;const u=n.start;for(let d=0;d<a.length;d++)if(u>=a[d].start&&u<=a[d].end){l=a[d];break}const f=n.start+n.duration;l?l.end=f:(l={start:u,end:f},a.push(l)),this.fragmentTracker.fragBuffered(n),this.fragBufferedComplete(n,null)}onBufferFlushing(e,t){const{startOffset:n,endOffset:i}=t;if(n===0&&i!==Number.POSITIVE_INFINITY){const a=i-1;if(a<=0)return;t.endOffsetSubtitles=Math.max(0,a),this.tracksBuffered.forEach(l=>{for(let u=0;u<l.length;){if(l[u].end<=a){l.shift();continue}else if(l[u].start<a)l[u].start=a;else break;u++}}),this.fragmentTracker.removeFragmentsInRange(n,a,Te.SUBTITLE)}}onFragBuffered(e,t){if(!this.loadedmetadata&&t.frag.type===Te.MAIN){var n;(n=this.media)!=null&&n.buffered.length&&(this.loadedmetadata=!0)}}onError(e,t){const n=t.frag;(n==null?void 0:n.type)===Te.SUBTITLE&&(t.details===G.FRAG_GAP&&this.fragmentTracker.fragBuffered(n,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==Y.STOPPED&&(this.state=Y.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(this.levels&&Jm(this.levels,t)){this.levels=t.map(n=>new ei(n));return}this.tracksBuffered=[],this.levels=t.map(n=>{const i=new ei(n);return this.tracksBuffered[i.id]=[],i}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,Te.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){var n;if(this.currentTrackId=t.id,!((n=this.levels)!=null&&n.length)||this.currentTrackId===-1){this.clearInterval();return}const i=this.levels[this.currentTrackId];i!=null&&i.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,i&&this.setInterval(Sp)}onSubtitleTrackLoaded(e,t){var n;const{currentTrackId:i,levels:a}=this,{details:l,id:u}=t;if(!a){this.warn(`Subtitle tracks were reset while loading level ${u}`);return}const f=a[u];if(u>=a.length||!f)return;this.log(`Subtitle track ${u} loaded [${l.startSN},${l.endSN}]${l.lastPartSn?`[part-${l.lastPartSn}-${l.lastPartIndex}]`:""},duration:${l.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let d=0;if(l.live||(n=f.details)!=null&&n.live){const m=this.mainDetails;if(l.deltaUpdateFailed||!m)return;const y=m.fragments[0];if(!f.details)l.hasProgramDateTime&&m.hasProgramDateTime?(Qa(l,m),d=l.fragments[0].start):y&&(d=y.start,zu(l,d));else{var p;d=this.alignPlaylists(l,f.details,(p=this.levelLastLoaded)==null?void 0:p.details),d===0&&y&&(d=y.start,zu(l,d))}}f.details=l,this.levelLastLoaded=f,u===i&&(!this.startFragRequested&&(this.mainDetails||!l.live)&&this.setStartPosition(this.mainDetails||l,d),this.tick(),l.live&&!this.fragCurrent&&this.media&&this.state===Y.IDLE&&(Xa(null,l.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),f.details=void 0)))}_handleFragmentLoadComplete(e){const{frag:t,payload:n}=e,i=t.decryptdata,a=this.hls;if(!this.fragContextChanged(t)&&n&&n.byteLength>0&&i!=null&&i.key&&i.iv&&i.method==="AES-128"){const l=performance.now();this.decrypter.decrypt(new Uint8Array(n),i.key.buffer,i.iv.buffer).catch(u=>{throw a.trigger(L.ERROR,{type:Le.MEDIA_ERROR,details:G.FRAG_DECRYPT_ERROR,fatal:!1,error:u,reason:u.message,frag:t}),u}).then(u=>{const f=performance.now();a.trigger(L.FRAG_DECRYPTED,{frag:t,payload:u,stats:{tstart:l,tdecrypt:f}})}).catch(u=>{this.warn(`${u.name}: ${u.message}`),this.state=Y.IDLE})}}doTick(){if(!this.media){this.state=Y.IDLE;return}if(this.state===Y.IDLE){const{currentTrackId:e,levels:t}=this,n=t==null?void 0:t[e];if(!n||!t.length||!n.details)return;const{config:i}=this,a=this.getLoadPosition(),l=Ue.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],a,i.maxBufferHole),{end:u,len:f}=l,d=this.getFwdBufferInfo(this.media,Te.MAIN),p=n.details,m=this.getMaxBufferLength(d==null?void 0:d.len)+p.levelTargetDuration;if(f>m)return;const y=p.fragments,T=y.length,v=p.edge;let x=null;const S=this.fragPrevious;if(u<v){const R=i.maxFragLookUpTolerance,I=u>v-R?0:R;x=Xa(S,y,Math.max(y[0].start,u),I),!x&&S&&S.start<y[0].start&&(x=y[0])}else x=y[T-1];if(!x)return;if(x=this.mapToInitFragWhenRequired(x),x.sn!=="initSegment"){const R=x.sn-p.startSN,I=y[R-1];I&&I.cc===x.cc&&this.fragmentTracker.getState(I)===ot.NOT_LOADED&&(x=I)}this.fragmentTracker.getState(x)===ot.NOT_LOADED&&this.loadFragment(x,n,u)}}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.max(t,e):t}loadFragment(e,t,n){this.fragCurrent=e,e.sn==="initSegment"?this._loadInitSegment(e,t):(this.startFragRequested=!0,super.loadFragment(e,t,n))}get mediaBufferTimeRanges(){return new bx(this.tracksBuffered[this.currentTrackId]||[])}}class bx{constructor(e){this.buffered=void 0;const t=(n,i,a)=>{if(i=i>>>0,i>a-1)throw new DOMException(`Failed to execute '${n}' on 'TimeRanges': The index provided (${i}) is greater than the maximum bound (${a})`);return e[i][n]};this.buffered={get length(){return e.length},end(n){return t("end",n,e.length)},start(n){return t("start",n,e.length)}}}}class Ox extends mc{constructor(e){super(e,"[subtitle-track-controller]"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let t=null;const n=Oa(this.media.textTracks);for(let a=0;a<n.length;a++)if(n[a].mode==="hidden")t=n[a];else if(n[a].mode==="showing"){t=n[a];break}const i=this.findTrackForTextTrack(t);this.subtitleTrack!==i&&this.setSubtitleTrack(i)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.MANIFEST_PARSED,this.onManifestParsed,this),e.on(L.LEVEL_LOADING,this.onLevelLoading,this),e.on(L.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(L.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(L.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.MANIFEST_PARSED,this.onManifestParsed,this),e.off(L.LEVEL_LOADING,this.onLevelLoading,this),e.off(L.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(L.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(L.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(){if(!this.media)return;self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),Oa(this.media.textTracks).forEach(t=>{Xr(t)}),this.subtitleTrack=-1,this.media=null}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:n,groupId:i,details:a}=t,l=this.tracksInGroup[n];if(!l||l.groupId!==i){this.warn(`Subtitle track with id:${n} and group:${i} not found in active group ${l==null?void 0:l.groupId}`);return}const u=l.details;l.details=t.details,this.log(`Subtitle track ${n} "${l.name}" lang:${l.lang} group:${i} loaded [${a.startSN}-${a.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,u)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.subtitleGroups||null,i=this.groupIds;let a=this.currentTrack;if(!n||(i==null?void 0:i.length)!==(n==null?void 0:n.length)||n!=null&&n.some(l=>(i==null?void 0:i.indexOf(l))===-1)){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const l=this.tracks.filter(p=>!n||n.indexOf(p.groupId)!==-1);if(l.length)this.selectDefaultTrack&&!l.some(p=>p.default)&&(this.selectDefaultTrack=!1),l.forEach((p,m)=>{p.id=m});else if(!a&&!this.tracksInGroup.length)return;this.tracksInGroup=l;const u=this.hls.config.subtitlePreference;if(!a&&u){this.selectDefaultTrack=!1;const p=un(u,l);if(p>-1)a=l[p];else{const m=un(u,this.tracks);a=this.tracks[m]}}let f=this.findTrackId(a);f===-1&&a&&(f=this.findTrackId(null));const d={subtitleTracks:l};this.log(`Updating subtitle tracks, ${l.length} track(s) found in "${n==null?void 0:n.join(",")}" group-id`),this.hls.trigger(L.SUBTITLE_TRACKS_UPDATED,d),f!==-1&&this.trackId===-1&&this.setSubtitleTrack(f)}else this.shouldReloadPlaylist(a)&&this.setSubtitleTrack(this.trackId)}findTrackId(e){const t=this.tracksInGroup,n=this.selectDefaultTrack;for(let i=0;i<t.length;i++){const a=t[i];if(!(n&&!a.default||!n&&!e)&&(!e||yr(a,e)))return i}if(e){for(let i=0;i<t.length;i++){const a=t[i];if(ts(e.attrs,a.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return i}for(let i=0;i<t.length;i++){const a=t[i];if(ts(e.attrs,a.attrs,["LANGUAGE"]))return i}}return-1}findTrackForTextTrack(e){if(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const i=t[n];if(qu(i,e))return n}}return-1}onError(e,t){t.fatal||!t.context||t.context.type===De.SUBTITLE_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){const t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){const n=this.currentTrack;if(n&&yr(e,n))return n;const i=un(e,this.tracksInGroup);if(i>-1){const a=this.tracksInGroup[i];return this.setSubtitleTrack(i),a}else{if(n)return null;{const a=un(e,t);if(a>-1)return t[a]}}}}return null}loadPlaylist(e){super.loadPlaylist();const t=this.currentTrack;if(this.shouldLoadPlaylist(t)&&t){const n=t.id,i=t.groupId;let a=t.url;if(e)try{a=e.addDirectives(a)}catch(l){this.warn(`Could not construct new URL with HLS Delivery Directives: ${l}`)}this.log(`Loading subtitle playlist for id ${n}`),this.hls.trigger(L.SUBTITLE_TRACK_LOADING,{url:a,id:n,groupId:i,deliveryDirectives:e||null})}}toggleTrackModes(){const{media:e}=this;if(!e)return;const t=Oa(e.textTracks),n=this.currentTrack;let i;if(n&&(i=t.filter(a=>qu(n,a))[0],i||this.warn(`Unable to find subtitle TextTrack with name "${n.name}" and language "${n.lang}"`)),[].slice.call(t).forEach(a=>{a.mode!=="disabled"&&a!==i&&(a.mode="disabled")}),i){const a=this.subtitleDisplay?"showing":"hidden";i.mode!==a&&(i.mode=a)}}setSubtitleTrack(e){const t=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(e<-1||e>=t.length||!oe(e)){this.warn(`Invalid subtitle track id: ${e}`);return}this.clearTimer(),this.selectDefaultTrack=!1;const n=this.currentTrack,i=t[e]||null;if(this.trackId=e,this.currentTrack=i,this.toggleTrackModes(),!i){this.hls.trigger(L.SUBTITLE_TRACK_SWITCH,{id:e});return}const a=!!i.details&&!i.details.live;if(e===this.trackId&&i===n&&a)return;this.log(`Switching to subtitle-track ${e}`+(i?` "${i.name}" lang:${i.lang} group:${i.groupId}`:""));const{id:l,groupId:u="",name:f,type:d,url:p}=i;this.hls.trigger(L.SUBTITLE_TRACK_SWITCH,{id:l,groupId:u,name:f,type:d,url:p});const m=this.switchParams(i.url,n==null?void 0:n.details,i.details);this.loadPlaylist(m)}}class Fx{constructor(e){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=e}append(e,t,n){const i=this.queues[t];i.push(e),i.length===1&&!n&&this.executeNext(t)}insertAbort(e,t){this.queues[t].unshift(e),this.executeNext(t)}appendBlocker(e){let t;const n=new Promise(a=>{t=a}),i={execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};return this.append(i,e),n}executeNext(e){const t=this.queues[e];if(t.length){const n=t[0];try{n.execute()}catch(i){O.warn(`[buffer-operation-queue]: Exception executing "${e}" SourceBuffer operation: ${i}`),n.onError(i);const a=this.buffers[e];a!=null&&a.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues[e].shift(),this.executeNext(e)}current(e){return this.queues[e][0]}}const Lp=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/;class Nx{constructor(e){this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendSource=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this.log=void 0,this.warn=void 0,this.error=void 0,this._onEndStreaming=n=>{this.hls&&this.hls.pauseBuffering()},this._onStartStreaming=n=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=()=>{const{media:n,mediaSource:i}=this;this.log("Media source opened"),n&&(n.removeEventListener("emptied",this._onMediaEmptied),this.updateMediaElementDuration(),this.hls.trigger(L.MEDIA_ATTACHED,{media:n,mediaSource:i})),i&&i.removeEventListener("sourceopen",this._onMediaSourceOpen),this.checkPendingTracks()},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:n,_objectUrl:i}=this;n!==i&&O.error(`Media element src was set while attaching MediaSource (${i} > ${n})`)},this.hls=e;const t="[buffer-controller]";this.appendSource=jv(vr(e.config.preferManagedMediaSource)),this.log=O.log.bind(O,t),this.warn=O.warn.bind(O,t),this.error=O.error.bind(O,t),this._initSourceBuffer(),this.registerListeners()}hasSourceTypes(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null,this.hls=null}registerListeners(){const{hls:e}=this;e.on(L.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.MANIFEST_PARSED,this.onManifestParsed,this),e.on(L.BUFFER_RESET,this.onBufferReset,this),e.on(L.BUFFER_APPENDING,this.onBufferAppending,this),e.on(L.BUFFER_CODECS,this.onBufferCodecs,this),e.on(L.BUFFER_EOS,this.onBufferEos,this),e.on(L.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(L.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(L.FRAG_PARSED,this.onFragParsed,this),e.on(L.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){const{hls:e}=this;e.off(L.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.MANIFEST_PARSED,this.onManifestParsed,this),e.off(L.BUFFER_RESET,this.onBufferReset,this),e.off(L.BUFFER_APPENDING,this.onBufferAppending,this),e.off(L.BUFFER_CODECS,this.onBufferCodecs,this),e.off(L.BUFFER_EOS,this.onBufferEos,this),e.off(L.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(L.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(L.FRAG_PARSED,this.onFragParsed,this),e.off(L.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new Fx(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.appendErrors={audio:0,video:0,audiovideo:0},this.lastMpegAudioChunk=null}onManifestLoading(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){let n=2;(t.audio&&!t.video||!t.altAudio)&&(n=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=n,this.log(`${this.bufferCodecEventsExpected} bufferCodec event(s) expected`)}onMediaAttaching(e,t){const n=this.media=t.media,i=vr(this.appendSource);if(n&&i){var a;const l=this.mediaSource=new i;this.log(`created media source: ${(a=l.constructor)==null?void 0:a.name}`),l.addEventListener("sourceopen",this._onMediaSourceOpen),l.addEventListener("sourceended",this._onMediaSourceEnded),l.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(l.addEventListener("startstreaming",this._onStartStreaming),l.addEventListener("endstreaming",this._onEndStreaming));const u=this._objectUrl=self.URL.createObjectURL(l);if(this.appendSource)try{n.removeAttribute("src");const f=self.ManagedMediaSource;n.disableRemotePlayback=n.disableRemotePlayback||f&&l instanceof f,Ap(n),Mx(n,u),n.load()}catch{n.src=u}else n.src=u;n.addEventListener("emptied",this._onMediaEmptied)}}onMediaDetaching(){const{media:e,mediaSource:t,_objectUrl:n}=this;if(t){if(this.log("media source detaching"),t.readyState==="open")try{t.endOfStream()}catch(i){this.warn(`onMediaDetaching: ${i.message} while calling endOfStream`)}this.onBufferReset(),t.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("sourceended",this._onMediaSourceEnded),t.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(t.removeEventListener("startstreaming",this._onStartStreaming),t.removeEventListener("endstreaming",this._onEndStreaming)),e&&(e.removeEventListener("emptied",this._onMediaEmptied),n&&self.URL.revokeObjectURL(n),this.mediaSrc===n?(e.removeAttribute("src"),this.appendSource&&Ap(e),e.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(L.MEDIA_DETACHED,void 0)}onBufferReset(){this.getSourceBufferTypes().forEach(e=>{this.resetBuffer(e)}),this._initSourceBuffer(),this.hls.resumeBuffering()}resetBuffer(e){const t=this.sourceBuffer[e];try{if(t){var n;this.removeBufferListeners(e),this.sourceBuffer[e]=void 0,(n=this.mediaSource)!=null&&n.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(t)}}catch(i){this.warn(`onBufferReset ${e}`,i)}}onBufferCodecs(e,t){const n=this.getSourceBufferTypes().length,i=Object.keys(t);if(i.forEach(l=>{if(n){const f=this.tracks[l];if(f&&typeof f.buffer.changeType=="function"){var u;const{id:d,codec:p,levelCodec:m,container:y,metadata:T}=t[l],v=jh(f.codec,f.levelCodec),x=v==null?void 0:v.replace(Lp,"$1");let S=jh(p,m);const R=(u=S)==null?void 0:u.replace(Lp,"$1");if(S&&x!==R){l.slice(0,5)==="audio"&&(S=za(S,this.appendSource));const I=`${y};codecs=${S}`;this.appendChangeType(l,I),this.log(`switching codec ${v} to ${S}`),this.tracks[l]={buffer:f.buffer,codec:p,container:y,levelCodec:m,metadata:T,id:d}}}}else this.pendingTracks[l]=t[l]}),n)return;const a=Math.max(this.bufferCodecEventsExpected-1,0);this.bufferCodecEventsExpected!==a&&(this.log(`${a} bufferCodec event(s) expected ${i.join(",")}`),this.bufferCodecEventsExpected=a),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks()}appendChangeType(e,t){const{operationQueue:n}=this,i={execute:()=>{const a=this.sourceBuffer[e];a&&(this.log(`changing ${e} sourceBuffer type to ${t}`),a.changeType(t)),n.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:a=>{this.warn(`Failed to change ${e} SourceBuffer type`,a)}};n.append(i,e,!!this.pendingTracks[e])}onBufferAppending(e,t){const{hls:n,operationQueue:i,tracks:a}=this,{data:l,type:u,frag:f,part:d,chunkMeta:p}=t,m=p.buffering[u],y=self.performance.now();m.start=y;const T=f.stats.buffering,v=d?d.stats.buffering:null;T.start===0&&(T.start=y),v&&v.start===0&&(v.start=y);const x=a.audio;let S=!1;u==="audio"&&(x==null?void 0:x.container)==="audio/mpeg"&&(S=!this.lastMpegAudioChunk||p.id===1||this.lastMpegAudioChunk.sn!==p.sn,this.lastMpegAudioChunk=p);const R=f.start,I={execute:()=>{if(m.executeStart=self.performance.now(),S){const w=this.sourceBuffer[u];if(w){const b=R-w.timestampOffset;Math.abs(b)>=.1&&(this.log(`Updating audio SourceBuffer timestampOffset to ${R} (delta: ${b}) sn: ${f.sn})`),w.timestampOffset=R)}}this.appendExecutor(l,u)},onStart:()=>{},onComplete:()=>{const w=self.performance.now();m.executeEnd=m.end=w,T.first===0&&(T.first=w),v&&v.first===0&&(v.first=w);const{sourceBuffer:b}=this,_={};for(const K in b)_[K]=Ue.getBuffered(b[K]);this.appendErrors[u]=0,u==="audio"||u==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(L.BUFFER_APPENDED,{type:u,frag:f,part:d,chunkMeta:p,parent:f.type,timeRanges:_})},onError:w=>{const b={type:Le.MEDIA_ERROR,parent:f.type,details:G.BUFFER_APPEND_ERROR,sourceBufferName:u,frag:f,part:d,chunkMeta:p,error:w,err:w,fatal:!1};if(w.code===DOMException.QUOTA_EXCEEDED_ERR)b.details=G.BUFFER_FULL_ERROR;else{const _=++this.appendErrors[u];b.details=G.BUFFER_APPEND_ERROR,this.warn(`Failed ${_}/${n.config.appendErrorMaxRetry} times to append segment in "${u}" sourceBuffer`),_>=n.config.appendErrorMaxRetry&&(b.fatal=!0)}n.trigger(L.ERROR,b)}};i.append(I,u,!!this.pendingTracks[u])}onBufferFlushing(e,t){const{operationQueue:n}=this,i=a=>({execute:this.removeExecutor.bind(this,a,t.startOffset,t.endOffset),onStart:()=>{},onComplete:()=>{this.hls.trigger(L.BUFFER_FLUSHED,{type:a})},onError:l=>{this.warn(`Failed to remove from ${a} SourceBuffer`,l)}});t.type?n.append(i(t.type),t.type):this.getSourceBufferTypes().forEach(a=>{n.append(i(a),a)})}onFragParsed(e,t){const{frag:n,part:i}=t,a=[],l=i?i.elementaryStreams:n.elementaryStreams;l[Fe.AUDIOVIDEO]?a.push("audiovideo"):(l[Fe.AUDIO]&&a.push("audio"),l[Fe.VIDEO]&&a.push("video"));const u=()=>{const f=self.performance.now();n.stats.buffering.end=f,i&&(i.stats.buffering.end=f);const d=i?i.stats:n.stats;this.hls.trigger(L.FRAG_BUFFERED,{frag:n,part:i,stats:d,id:n.type})};a.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${n.type} level: ${n.level} sn: ${n.sn}`),this.blockBuffers(u,a)}onFragChanged(e,t){this.trimBuffers()}onBufferEos(e,t){this.getSourceBufferTypes().reduce((i,a)=>{const l=this.sourceBuffer[a];return l&&(!t.type||t.type===a)&&(l.ending=!0,l.ended||(l.ended=!0,this.log(`${a} sourceBuffer now EOS`))),i&&!!(!l||l.ended)},!0)&&(this.log("Queueing mediaSource.endOfStream()"),this.blockBuffers(()=>{this.getSourceBufferTypes().forEach(a=>{const l=this.sourceBuffer[a];l&&(l.ending=!1)});const{mediaSource:i}=this;if(!i||i.readyState!=="open"){i&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${i.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),i.endOfStream()}))}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}trimBuffers(){const{hls:e,details:t,media:n}=this;if(!n||t===null||!this.getSourceBufferTypes().length)return;const a=e.config,l=n.currentTime,u=t.levelTargetDuration,f=t.live&&a.liveBackBufferLength!==null?a.liveBackBufferLength:a.backBufferLength;if(oe(f)&&f>0){const d=Math.max(f,u),p=Math.floor(l/u)*u-d;this.flushBackBuffer(l,u,p)}if(oe(a.frontBufferFlushThreshold)&&a.frontBufferFlushThreshold>0){const d=Math.max(a.maxBufferLength,a.frontBufferFlushThreshold),p=Math.max(d,u),m=Math.floor(l/u)*u+p;this.flushFrontBuffer(l,u,m)}}flushBackBuffer(e,t,n){const{details:i,sourceBuffer:a}=this;this.getSourceBufferTypes().forEach(u=>{const f=a[u];if(f){const d=Ue.getBuffered(f);if(d.length>0&&n>d.start(0)){if(this.hls.trigger(L.BACK_BUFFER_REACHED,{bufferEnd:n}),i!=null&&i.live)this.hls.trigger(L.LIVE_BACK_BUFFER_REACHED,{bufferEnd:n});else if(f.ended&&d.end(d.length-1)-e<t*2){this.log(`Cannot flush ${u} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(L.BUFFER_FLUSHING,{startOffset:0,endOffset:n,type:u})}}})}flushFrontBuffer(e,t,n){const{sourceBuffer:i}=this;this.getSourceBufferTypes().forEach(l=>{const u=i[l];if(u){const f=Ue.getBuffered(u),d=f.length;if(d<2)return;const p=f.start(d-1),m=f.end(d-1);if(n>p||e>=p&&e<=m)return;if(u.ended&&e-m<2*t){this.log(`Cannot flush ${l} front buffer while SourceBuffer is in ended state`);return}this.hls.trigger(L.BUFFER_FLUSHING,{startOffset:p,endOffset:1/0,type:l})}})}updateMediaElementDuration(){if(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")return;const{details:e,hls:t,media:n,mediaSource:i}=this,a=e.fragments[0].start+e.totalduration,l=n.duration,u=oe(i.duration)?i.duration:0;e.live&&t.config.liveDurationInfinity?(i.duration=1/0,this.updateSeekableRange(e)):(a>u&&a>l||!oe(l))&&(this.log(`Updating Media Source duration to ${a.toFixed(3)}`),i.duration=a)}updateSeekableRange(e){const t=this.mediaSource,n=e.fragments;if(n.length&&e.live&&t!=null&&t.setLiveSeekableRange){const a=Math.max(0,n[0].start),l=Math.max(a,a+e.totalduration);this.log(`Media Source duration is set to ${t.duration}. Setting seekable range to ${a}-${l}.`),t.setLiveSeekableRange(a,l)}}checkPendingTracks(){const{bufferCodecEventsExpected:e,operationQueue:t,pendingTracks:n}=this,i=Object.keys(n).length;if(i&&(!e||i===2||"audiovideo"in n)){this.createSourceBuffers(n),this.pendingTracks={};const a=this.getSourceBufferTypes();if(a.length)this.hls.trigger(L.BUFFER_CREATED,{tracks:this.tracks}),a.forEach(l=>{t.executeNext(l)});else{const l=new Error("could not create source buffer for media codec(s)");this.hls.trigger(L.ERROR,{type:Le.MEDIA_ERROR,details:G.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:l,reason:l.message})}}}createSourceBuffers(e){const{sourceBuffer:t,mediaSource:n}=this;if(!n)throw Error("createSourceBuffers called when mediaSource was null");for(const a in e)if(!t[a]){var i;const l=e[a];if(!l)throw Error(`source buffer exists for track ${a}, however track does not`);let u=((i=l.levelCodec)==null?void 0:i.indexOf(","))===-1?l.levelCodec:l.codec;u&&a.slice(0,5)==="audio"&&(u=za(u,this.appendSource));const f=`${l.container};codecs=${u}`;this.log(`creating sourceBuffer(${f})`);try{const d=t[a]=n.addSourceBuffer(f),p=a;this.addBufferListener(p,"updatestart",this._onSBUpdateStart),this.addBufferListener(p,"updateend",this._onSBUpdateEnd),this.addBufferListener(p,"error",this._onSBUpdateError),this.appendSource&&this.addBufferListener(p,"bufferedchange",(m,y)=>{const T=y.removedRanges;T!=null&&T.length&&this.hls.trigger(L.BUFFER_FLUSHED,{type:a})}),this.tracks[a]={buffer:d,codec:u,container:l.container,levelCodec:l.levelCodec,metadata:l.metadata,id:l.id}}catch(d){this.error(`error while trying to add sourceBuffer: ${d.message}`),this.hls.trigger(L.ERROR,{type:Le.MEDIA_ERROR,details:G.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:d,sourceBufferName:a,mimeType:f})}}}get mediaSrc(){var e,t;const n=((e=this.media)==null||(t=e.querySelector)==null?void 0:t.call(e,"source"))||this.media;return n==null?void 0:n.src}_onSBUpdateStart(e){const{operationQueue:t}=this;t.current(e).onStart()}_onSBUpdateEnd(e){var t;if(((t=this.mediaSource)==null?void 0:t.readyState)==="closed"){this.resetBuffer(e);return}const{operationQueue:n}=this;n.current(e).onComplete(),n.shiftAndExecuteNext(e)}_onSBUpdateError(e,t){var n;const i=new Error(`${e} SourceBuffer error. MediaSource readyState: ${(n=this.mediaSource)==null?void 0:n.readyState}`);this.error(`${i}`,t),this.hls.trigger(L.ERROR,{type:Le.MEDIA_ERROR,details:G.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:i,fatal:!1});const a=this.operationQueue.current(e);a&&a.onError(i)}removeExecutor(e,t,n){const{media:i,mediaSource:a,operationQueue:l,sourceBuffer:u}=this,f=u[e];if(!i||!a||!f){this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),l.shiftAndExecuteNext(e);return}const d=oe(i.duration)?i.duration:1/0,p=oe(a.duration)?a.duration:1/0,m=Math.max(0,t),y=Math.min(n,d,p);y>m&&(!f.ending||f.ended)?(f.ended=!1,this.log(`Removing [${m},${y}] from the ${e} SourceBuffer`),f.remove(m,y)):l.shiftAndExecuteNext(e)}appendExecutor(e,t){const n=this.sourceBuffer[t];if(!n){if(!this.pendingTracks[t])throw new Error(`Attempting to append to the ${t} SourceBuffer, but it does not exist`);return}n.ended=!1,n.appendBuffer(e)}blockBuffers(e,t=this.getSourceBufferTypes()){if(!t.length){this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);return}const{operationQueue:n}=this,i=t.map(a=>n.appendBlocker(a));Promise.all(i).then(()=>{e(),t.forEach(a=>{const l=this.sourceBuffer[a];l!=null&&l.updating||n.shiftAndExecuteNext(a)})})}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(e,t,n){const i=this.sourceBuffer[e];if(!i)return;const a=n.bind(this,e);this.listeners[e].push({event:t,listener:a}),i.addEventListener(t,a)}removeBufferListeners(e){const t=this.sourceBuffer[e];t&&this.listeners[e].forEach(n=>{t.removeEventListener(n.event,n.listener)})}}function Ap(o){const e=o.querySelectorAll("source");[].slice.call(e).forEach(t=>{o.removeChild(t)})}function Mx(o,e){const t=self.document.createElement("source");t.type="video/mp4",t.src=e,o.appendChild(t)}const Ux={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},Zm=o=>String.fromCharCode(Ux[o]||o),Xt=15,An=100,Bx={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},$x={17:2,18:4,21:6,22:8,23:10,19:13,20:15},Gx={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},Hx={25:2,26:4,29:6,30:8,31:10,27:13,28:15},Vx=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class Kx{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const n=typeof t=="function"?t():t;O.log(`${this.time} [${e}] ${n}`)}}}const dr=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].toString(16));return t};class eg{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let n=0;n<t.length;n++){const i=t[n];e.hasOwnProperty(i)&&(this[i]=e[i])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class jx{constructor(){this.uchar=" ",this.penState=new eg}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class zx{constructor(e){this.chars=[],this.pos=0,this.currPenState=new eg,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<An;t++)this.chars.push(new jx);this.logger=e}equals(e){for(let t=0;t<An;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<An;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<An;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>An&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=An)}moveCursor(e){const t=this.pos+e;if(e>1)for(let n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=Zm(e);if(this.pos>=An){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<An;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let n=0;n<An;n++){const i=this.chars[n].uchar;i!==" "&&(t=!1),e.push(i)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class Su{constructor(e){this.rows=[],this.currRow=Xt-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<Xt;t++)this.rows.push(new zx(e));this.logger=e}reset(){for(let e=0;e<Xt;e++)this.rows[e].clear();this.currRow=Xt-1}equals(e){let t=!0;for(let n=0;n<Xt;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t}copy(e){for(let t=0;t<Xt;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<Xt;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+JSON.stringify(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let u=0;u<Xt;u++)this.rows[u].clear();const a=this.currRow+1-this.nrRollUpRows,l=this.lastOutputScreen;if(l){const u=l.rows[a].cueStartTime,f=this.logger.time;if(u!==null&&f!==null&&u<f)for(let d=0;d<this.nrRollUpRows;d++)this.rows[t-this.nrRollUpRows+d+1].copy(l.rows[a+d])}}this.currRow=t;const n=this.rows[this.currRow];if(e.indent!==null){const a=e.indent,l=Math.max(a-1,0);n.setCursor(e.indent),e.color=n.chars[l].penState.foreground}const i={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(i)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let n="",i=-1;for(let a=0;a<Xt;a++){const l=this.rows[a].getTextString();l&&(i=a+1,e?t.push("Row "+i+": '"+l+"'"):t.push(l.trim()))}return t.length>0&&(e?n="["+t.join(" | ")+"]":n=t.join(`
`)),n}getTextAndFormat(){return this.rows}}class Rp{constructor(e,t,n){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new Su(n),this.nonDisplayedMemory=new Su(n),this.lastOutputScreen=new Su(n),this.currRollUpRow=this.displayedMemory.rows[Xt-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=n}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[Xt-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let n=0;n<e.length;n++)this.writeScreen.insertChar(e[n]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const n=Math.floor(e/2)-16,i=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=i[n]}this.logger.log(2,"MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class wp{constructor(e,t,n){this.channels=void 0,this.currentChannel=0,this.cmdHistory=Yx(),this.logger=void 0;const i=this.logger=new Kx;this.channels=[null,new Rp(e,t,i),new Rp(e+1,n,i)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){this.logger.time=e;for(let n=0;n<t.length;n+=2){const i=t[n]&127,a=t[n+1]&127;let l=!1,u=null;if(i===0&&a===0)continue;this.logger.log(3,()=>"["+dr([t[n],t[n+1]])+"] -> ("+dr([i,a])+")");const f=this.cmdHistory;if(i>=16&&i<=31){if(Wx(i,a,f)){Ca(null,null,f),this.logger.log(3,()=>"Repeated command ("+dr([i,a])+") is dropped");continue}Ca(i,a,this.cmdHistory),l=this.parseCmd(i,a),l||(l=this.parseMidrow(i,a)),l||(l=this.parsePAC(i,a)),l||(l=this.parseBackgroundAttributes(i,a))}else Ca(null,null,f);if(!l&&(u=this.parseChars(i,a),u)){const p=this.currentChannel;p&&p>0?this.channels[p].insertChars(u):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!l&&!u&&this.logger.log(2,()=>"Couldn't parse cleaned data "+dr([i,a])+" orig: "+dr([t[n],t[n+1]]))}}parseCmd(e,t){const n=(e===20||e===28||e===21||e===29)&&t>=32&&t<=47,i=(e===23||e===31)&&t>=33&&t<=35;if(!(n||i))return!1;const a=e===20||e===21||e===23?1:2,l=this.channels[a];return e===20||e===21||e===28||e===29?t===32?l.ccRCL():t===33?l.ccBS():t===34?l.ccAOF():t===35?l.ccAON():t===36?l.ccDER():t===37?l.ccRU(2):t===38?l.ccRU(3):t===39?l.ccRU(4):t===40?l.ccFON():t===41?l.ccRDC():t===42?l.ccTR():t===43?l.ccRTD():t===44?l.ccEDM():t===45?l.ccCR():t===46?l.ccENM():t===47&&l.ccEOC():l.ccTO(t-32),this.currentChannel=a,!0}parseMidrow(e,t){let n=0;if((e===17||e===25)&&t>=32&&t<=47){if(e===17?n=1:n=2,n!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const i=this.channels[n];return i?(i.ccMIDROW(t),this.logger.log(3,()=>"MIDROW ("+dr([e,t])+")"),!0):!1}return!1}parsePAC(e,t){let n;const i=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,a=(e===16||e===24)&&t>=64&&t<=95;if(!(i||a))return!1;const l=e<=23?1:2;t>=64&&t<=95?n=l===1?Bx[e]:Gx[e]:n=l===1?$x[e]:Hx[e];const u=this.channels[l];return u?(u.setPAC(this.interpretPAC(n,t)),this.currentChannel=l,!0):!1}interpretPAC(e,t){let n;const i={color:null,italics:!1,indent:null,underline:!1,row:e};return t>95?n=t-96:n=t-64,i.underline=(n&1)===1,n<=13?i.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(i.italics=!0,i.color="white"):i.indent=Math.floor((n-16)/2)*4,i}parseChars(e,t){let n,i=null,a=null;if(e>=25?(n=2,a=e-8):(n=1,a=e),a>=17&&a<=19){let l;a===17?l=t+80:a===18?l=t+112:l=t+144,this.logger.log(2,()=>"Special char '"+Zm(l)+"' in channel "+n),i=[l]}else e>=32&&e<=127&&(i=t===0?[e]:[e,t]);return i&&this.logger.log(3,()=>"Char codes =  "+dr(i).join(",")),i}parseBackgroundAttributes(e,t){const n=(e===16||e===24)&&t>=32&&t<=47,i=(e===23||e===31)&&t>=45&&t<=47;if(!(n||i))return!1;let a;const l={};e===16||e===24?(a=Math.floor((t-32)/2),l.background=Vx[a],t%2===1&&(l.background=l.background+"_semi")):t===45?l.background="transparent":(l.foreground="black",t===47&&(l.underline=!0));const u=e<=23?1:2;return this.channels[u].setBkgData(l),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}Ca(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const n=this.channels[t];n&&n.cueSplitAtTime(e)}}}function Ca(o,e,t){t.a=o,t.b=e}function Wx(o,e,t){return t.a===o&&t.b===e}function Yx(){return{a:null,b:null}}class Ia{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,n){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=n,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}var Ac=function(){if(Zr!=null&&Zr.VTTCue)return self.VTTCue;const o=["","lr","rl"],e=["start","middle","end","left","right"];function t(u,f){if(typeof f!="string"||!Array.isArray(u))return!1;const d=f.toLowerCase();return~u.indexOf(d)?d:!1}function n(u){return t(o,u)}function i(u){return t(e,u)}function a(u,...f){let d=1;for(;d<arguments.length;d++){const p=arguments[d];for(const m in p)u[m]=p[m]}return u}function l(u,f,d){const p=this,m={enumerable:!0};p.hasBeenReset=!1;let y="",T=!1,v=u,x=f,S=d,R=null,I="",w=!0,b="auto",_="start",K=50,U="middle",z=50,ee="middle";Object.defineProperty(p,"id",a({},m,{get:function(){return y},set:function(V){y=""+V}})),Object.defineProperty(p,"pauseOnExit",a({},m,{get:function(){return T},set:function(V){T=!!V}})),Object.defineProperty(p,"startTime",a({},m,{get:function(){return v},set:function(V){if(typeof V!="number")throw new TypeError("Start time must be set to a number.");v=V,this.hasBeenReset=!0}})),Object.defineProperty(p,"endTime",a({},m,{get:function(){return x},set:function(V){if(typeof V!="number")throw new TypeError("End time must be set to a number.");x=V,this.hasBeenReset=!0}})),Object.defineProperty(p,"text",a({},m,{get:function(){return S},set:function(V){S=""+V,this.hasBeenReset=!0}})),Object.defineProperty(p,"region",a({},m,{get:function(){return R},set:function(V){R=V,this.hasBeenReset=!0}})),Object.defineProperty(p,"vertical",a({},m,{get:function(){return I},set:function(V){const Q=n(V);if(Q===!1)throw new SyntaxError("An invalid or illegal string was specified.");I=Q,this.hasBeenReset=!0}})),Object.defineProperty(p,"snapToLines",a({},m,{get:function(){return w},set:function(V){w=!!V,this.hasBeenReset=!0}})),Object.defineProperty(p,"line",a({},m,{get:function(){return b},set:function(V){if(typeof V!="number"&&V!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");b=V,this.hasBeenReset=!0}})),Object.defineProperty(p,"lineAlign",a({},m,{get:function(){return _},set:function(V){const Q=i(V);if(!Q)throw new SyntaxError("An invalid or illegal string was specified.");_=Q,this.hasBeenReset=!0}})),Object.defineProperty(p,"position",a({},m,{get:function(){return K},set:function(V){if(V<0||V>100)throw new Error("Position must be between 0 and 100.");K=V,this.hasBeenReset=!0}})),Object.defineProperty(p,"positionAlign",a({},m,{get:function(){return U},set:function(V){const Q=i(V);if(!Q)throw new SyntaxError("An invalid or illegal string was specified.");U=Q,this.hasBeenReset=!0}})),Object.defineProperty(p,"size",a({},m,{get:function(){return z},set:function(V){if(V<0||V>100)throw new Error("Size must be between 0 and 100.");z=V,this.hasBeenReset=!0}})),Object.defineProperty(p,"align",a({},m,{get:function(){return ee},set:function(V){const Q=i(V);if(!Q)throw new SyntaxError("An invalid or illegal string was specified.");ee=Q,this.hasBeenReset=!0}})),p.displayState=void 0}return l.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},l}();class qx{decode(e,t){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function tg(o){function e(n,i,a,l){return(n|0)*3600+(i|0)*60+(a|0)+parseFloat(l||0)}const t=o.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}class Xx{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&t!==""&&(this.values[e]=t)}get(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,n){for(let i=0;i<n.length;++i)if(t===n[i]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const n=parseFloat(t);if(n>=0&&n<=100)return this.set(e,n),!0}return!1}}function ng(o,e,t,n){const i=n?o.split(n):[o];for(const a in i){if(typeof i[a]!="string")continue;const l=i[a].split(t);if(l.length!==2)continue;const u=l[0],f=l[1];e(u,f)}}const Xu=new Ac(0,0,""),ka=Xu.align==="middle"?"middle":"center";function Qx(o,e,t){const n=o;function i(){const u=tg(o);if(u===null)throw new Error("Malformed timestamp: "+n);return o=o.replace(/^[^\sa-zA-Z-]+/,""),u}function a(u,f){const d=new Xx;ng(u,function(y,T){let v;switch(y){case"region":for(let x=t.length-1;x>=0;x--)if(t[x].id===T){d.set(y,t[x].region);break}break;case"vertical":d.alt(y,T,["rl","lr"]);break;case"line":v=T.split(","),d.integer(y,v[0]),d.percent(y,v[0])&&d.set("snapToLines",!1),d.alt(y,v[0],["auto"]),v.length===2&&d.alt("lineAlign",v[1],["start",ka,"end"]);break;case"position":v=T.split(","),d.percent(y,v[0]),v.length===2&&d.alt("positionAlign",v[1],["start",ka,"end","line-left","line-right","auto"]);break;case"size":d.percent(y,T);break;case"align":d.alt(y,T,["start",ka,"end","left","right"]);break}},/:/,/\s/),f.region=d.get("region",null),f.vertical=d.get("vertical","");let p=d.get("line","auto");p==="auto"&&Xu.line===-1&&(p=-1),f.line=p,f.lineAlign=d.get("lineAlign","start"),f.snapToLines=d.get("snapToLines",!0),f.size=d.get("size",100),f.align=d.get("align",ka);let m=d.get("position","auto");m==="auto"&&Xu.position===50&&(m=f.align==="start"||f.align==="left"?0:f.align==="end"||f.align==="right"?100:50),f.position=m}function l(){o=o.replace(/^\s+/,"")}if(l(),e.startTime=i(),l(),o.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+n);o=o.slice(3),l(),e.endTime=i(),l(),a(o,e)}function rg(o){return o.replace(/<br(?: \/)?>/gi,`
`)}class Jx{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new qx,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));function n(){let a=t.buffer,l=0;for(a=rg(a);l<a.length&&a[l]!=="\r"&&a[l]!==`
`;)++l;const u=a.slice(0,l);return a[l]==="\r"&&++l,a[l]===`
`&&++l,t.buffer=a.slice(l),u}function i(a){ng(a,function(l,u){},/:/)}try{let a="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;a=n();const u=a.match(/^()?WEBVTT([ \t].*)?$/);if(!(u!=null&&u[0]))throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let l=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(l?l=!1:a=n(),t.state){case"HEADER":/:/.test(a)?i(a):a||(t.state="ID");continue;case"NOTE":a||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(a)){t.state="NOTE";break}if(!a)continue;if(t.cue=new Ac(0,0,""),t.state="CUE",a.indexOf("-->")===-1){t.cue.id=a;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{Qx(a,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const u=a.indexOf("-->")!==-1;if(!a||u&&(l=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=a}continue;case"BADCUE":a||(t.state="ID")}}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const Zx=/\r\n|\n\r|\n|\r/g,Lu=function(e,t,n=0){return e.slice(n,n+t.length)===t},eS=function(e){let t=parseInt(e.slice(-3));const n=parseInt(e.slice(-6,-4)),i=parseInt(e.slice(-9,-7)),a=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!oe(t)||!oe(n)||!oe(i)||!oe(a))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*n,t+=60*1e3*i,t+=60*60*1e3*a,t},Au=function(e){let t=5381,n=e.length;for(;n;)t=t*33^e.charCodeAt(--n);return(t>>>0).toString()};function Rc(o,e,t){return Au(o.toString())+Au(e.toString())+Au(t)}const tS=function(e,t,n){let i=e[t],a=e[i.prevCC];if(!a||!a.new&&i.new){e.ccOffset=e.presentationOffset=i.start,i.new=!1;return}for(;(l=a)!=null&&l.new;){var l;e.ccOffset+=i.start-a.start,i.new=!1,i=a,a=e[i.prevCC]}e.presentationOffset=n};function nS(o,e,t,n,i,a,l){const u=new Jx,f=fn(new Uint8Array(o)).trim().replace(Zx,`
`).split(`
`),d=[],p=e?vx(e.baseTime,e.timescale):0;let m="00:00.000",y=0,T=0,v,x=!0;u.oncue=function(S){const R=t[n];let I=t.ccOffset;const w=(y-p)/9e4;if(R!=null&&R.new&&(T!==void 0?I=t.ccOffset=R.start:tS(t,n,w)),w){if(!e){v=new Error("Missing initPTS for VTT MPEGTS");return}I=w-t.presentationOffset}const b=S.endTime-S.startTime,_=$t((S.startTime+I-T)*9e4,i*9e4)/9e4;S.startTime=Math.max(_,0),S.endTime=Math.max(_+b,0);const K=S.text.trim();S.text=decodeURIComponent(encodeURIComponent(K)),S.id||(S.id=Rc(S.startTime,S.endTime,K)),S.endTime>0&&d.push(S)},u.onparsingerror=function(S){v=S},u.onflush=function(){if(v){l(v);return}a(d)},f.forEach(S=>{if(x)if(Lu(S,"X-TIMESTAMP-MAP=")){x=!1,S.slice(16).split(",").forEach(R=>{Lu(R,"LOCAL:")?m=R.slice(6):Lu(R,"MPEGTS:")&&(y=parseInt(R.slice(7)))});try{T=eS(m)/1e3}catch(R){v=R}return}else S===""&&(x=!1);u.parse(S+`
`)}),u.flush()}const Ru="stpp.ttml.im1t",ig=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,sg=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,rS={left:"start",center:"center",right:"end",start:"start",end:"end"};function Cp(o,e,t,n){const i=Re(new Uint8Array(o),["mdat"]);if(i.length===0){n(new Error("Could not parse IMSC1 mdat"));return}const a=i.map(u=>fn(u)),l=Ex(e.baseTime,1,e.timescale);try{a.forEach(u=>t(iS(u,l)))}catch(u){n(u)}}function iS(o,e){const i=new DOMParser().parseFromString(o,"text/xml").getElementsByTagName("tt")[0];if(!i)throw new Error("Invalid ttml");const a={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},l=Object.keys(a).reduce((m,y)=>(m[y]=i.getAttribute(`ttp:${y}`)||a[y],m),{}),u=i.getAttribute("xml:space")!=="preserve",f=Ip(wu(i,"styling","style")),d=Ip(wu(i,"layout","region")),p=wu(i,"body","[begin]");return[].map.call(p,m=>{const y=ag(m,u);if(!y||!m.hasAttribute("begin"))return null;const T=Iu(m.getAttribute("begin"),l),v=Iu(m.getAttribute("dur"),l);let x=Iu(m.getAttribute("end"),l);if(T===null)throw kp(m);if(x===null){if(v===null)throw kp(m);x=T+v}const S=new Ac(T-e,x-e,y);S.id=Rc(S.startTime,S.endTime,S.text);const R=d[m.getAttribute("region")],I=f[m.getAttribute("style")],w=sS(R,I,f),{textAlign:b}=w;if(b){const _=rS[b];_&&(S.lineAlign=_),S.align=b}return Ze(S,w),S}).filter(m=>m!==null)}function wu(o,e,t){const n=o.getElementsByTagName(e)[0];return n?[].slice.call(n.querySelectorAll(t)):[]}function Ip(o){return o.reduce((e,t)=>{const n=t.getAttribute("xml:id");return n&&(e[n]=t),e},{})}function ag(o,e){return[].slice.call(o.childNodes).reduce((t,n,i)=>{var a;return n.nodeName==="br"&&i?t+`
`:(a=n.childNodes)!=null&&a.length?ag(n,e):e?t+n.textContent.trim().replace(/\s+/g," "):t+n.textContent},"")}function sS(o,e,t){const n="http://www.w3.org/ns/ttml#styling";let i=null;const a=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],l=o!=null&&o.hasAttribute("style")?o.getAttribute("style"):null;return l&&t.hasOwnProperty(l)&&(i=t[l]),a.reduce((u,f)=>{const d=Cu(e,n,f)||Cu(o,n,f)||Cu(i,n,f);return d&&(u[f]=d),u},{})}function Cu(o,e,t){return o&&o.hasAttributeNS(e,t)?o.getAttributeNS(e,t):null}function kp(o){return new Error(`Could not parse ttml timestamp ${o}`)}function Iu(o,e){if(!o)return null;let t=tg(o);return t===null&&(ig.test(o)?t=aS(o,e):sg.test(o)&&(t=oS(o,e))),t}function aS(o,e){const t=ig.exec(o),n=(t[4]|0)+(t[5]|0)/e.subFrameRate;return(t[1]|0)*3600+(t[2]|0)*60+(t[3]|0)+n/e.frameRate}function oS(o,e){const t=sg.exec(o),n=Number(t[1]);switch(t[2]){case"h":return n*3600;case"m":return n*60;case"ms":return n*1e3;case"f":return n/e.frameRate;case"t":return n/e.tickRate}return n}class lS{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=_p(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(L.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(L.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(L.FRAG_LOADING,this.onFragLoading,this),e.on(L.FRAG_LOADED,this.onFragLoaded,this),e.on(L.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(L.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(L.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(L.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(L.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(L.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(L.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(L.FRAG_LOADING,this.onFragLoading,this),e.off(L.FRAG_LOADED,this.onFragLoaded,this),e.off(L.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(L.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(L.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(L.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(L.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){if(this.config.enableCEA708Captions&&(!this.cea608Parser1||!this.cea608Parser2)){const e=new Ia(this,"textTrack1"),t=new Ia(this,"textTrack2"),n=new Ia(this,"textTrack3"),i=new Ia(this,"textTrack4");this.cea608Parser1=new wp(1,e,t),this.cea608Parser2=new wp(3,n,i)}}addCues(e,t,n,i,a){let l=!1;for(let u=a.length;u--;){const f=a[u],d=uS(f[0],f[1],t,n);if(d>=0&&(f[0]=Math.min(f[0],t),f[1]=Math.max(f[1],n),l=!0,d/(n-t)>.5))return}if(l||a.push([t,n]),this.config.renderTextTracksNatively){const u=this.captionsTracks[e];this.Cues.newCue(u,t,n,i)}else{const u=this.Cues.newCue(null,t,n,i);this.hls.trigger(L.CUES_PARSED,{type:"captions",cues:u,track:e})}}onInitPtsFound(e,{frag:t,id:n,initPTS:i,timescale:a}){const{unparsedVttFrags:l}=this;n==="main"&&(this.initPTS[t.cc]={baseTime:i,timescale:a}),l.length&&(this.unparsedVttFrags=[],l.forEach(u=>{this.onFragLoaded(L.FRAG_LOADED,u)}))}getExistingTrack(e,t){const{media:n}=this;if(n)for(let i=0;i<n.textTracks.length;i++){const a=n.textTracks[i];if(Dp(a,{name:e,lang:t,attrs:{}}))return a}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:n,media:i}=this,{label:a,languageCode:l}=t[e],u=this.getExistingTrack(a,l);if(u)n[e]=u,Xr(n[e]),wm(n[e],i);else{const f=this.createTextTrack("captions",a,l);f&&(f[e]=!0,n[e]=f)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const n=t.label,i={_id:e,label:n,kind:"captions",default:t.media?!!t.media.default:!1,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=i,this.hls.trigger(L.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[i]})}createTextTrack(e,t,n){const i=this.media;if(i)return i.addTextTrack(e,t,n)}onMediaAttaching(e,t){this.media=t.media,this._cleanTracks()}onMediaDetaching(){const{captionsTracks:e}=this;Object.keys(e).forEach(t=>{Xr(e[t]),delete e[t]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=_p(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let n=0;n<t.length;n++)Xr(t[n])}onSubtitleTracksUpdated(e,t){const n=t.subtitleTracks||[],i=n.some(a=>a.textCodec===Ru);if(this.config.enableWebVTT||i&&this.config.enableIMSC1){if(Jm(this.tracks,n)){this.tracks=n;return}if(this.textTracks=[],this.tracks=n,this.config.renderTextTracksNatively){const l=this.media,u=l?Oa(l.textTracks):null;if(this.tracks.forEach((f,d)=>{let p;if(u){let m=null;for(let y=0;y<u.length;y++)if(u[y]&&Dp(u[y],f)){m=u[y],u[y]=null;break}m&&(p=m)}if(p)Xr(p);else{const m=og(f);p=this.createTextTrack(m,f.name,f.lang),p&&(p.mode="disabled")}p&&this.textTracks.push(p)}),u!=null&&u.length){const f=u.filter(d=>d!==null).map(d=>d.label);f.length&&O.warn(`Media element contains unused subtitle tracks: ${f.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const l=this.tracks.map(u=>({label:u.name,kind:u.type.toLowerCase(),default:u.default,subtitleTrack:u}));this.hls.trigger(L.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:l})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(n=>{const i=/(?:CC|SERVICE)([1-4])/.exec(n.instreamId);if(!i)return;const a=`textTrack${i[1]}`,l=this.captionsProperties[a];l&&(l.label=n.name,n.lang&&(l.languageCode=n.lang),l.media=n)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return t==null?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){if(this.enabled&&t.frag.type===Te.MAIN){var n,i;const{cea608Parser1:a,cea608Parser2:l,lastSn:u}=this,{cc:f,sn:d}=t.frag,p=(n=(i=t.part)==null?void 0:i.index)!=null?n:-1;a&&l&&(d!==u+1||d===u&&p!==this.lastPartIndex+1||f!==this.lastCc)&&(a.reset(),l.reset()),this.lastCc=f,this.lastSn=d,this.lastPartIndex=p}}onFragLoaded(e,t){const{frag:n,payload:i}=t;if(n.type===Te.SUBTITLE)if(i.byteLength){const a=n.decryptdata,l="stats"in t;if(a==null||!a.encrypted||l){const u=this.tracks[n.level],f=this.vttCCs;f[n.cc]||(f[n.cc]={start:n.start,prevCC:this.prevCC,new:!0},this.prevCC=n.cc),u&&u.textCodec===Ru?this._parseIMSC1(n,i):this._parseVTTs(t)}}else this.hls.trigger(L.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const n=this.hls;Cp(t,this.initPTS[e.cc],i=>{this._appendCues(i,e.level),n.trigger(L.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},i=>{O.log(`Failed to parse IMSC1: ${i}`),n.trigger(L.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:i})})}_parseVTTs(e){var t;const{frag:n,payload:i}=e,{initPTS:a,unparsedVttFrags:l}=this,u=a.length-1;if(!a[n.cc]&&u===-1){l.push(e);return}const f=this.hls,d=(t=n.initSegment)!=null&&t.data?Gt(n.initSegment.data,new Uint8Array(i)):i;nS(d,this.initPTS[n.cc],this.vttCCs,n.cc,n.start,p=>{this._appendCues(p,n.level),f.trigger(L.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})},p=>{const m=p.message==="Missing initPTS for VTT MPEGTS";m?l.push(e):this._fallbackToIMSC1(n,i),O.log(`Failed to parse VTT cue: ${p}`),!(m&&u>n.cc)&&f.trigger(L.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:p})})}_fallbackToIMSC1(e,t){const n=this.tracks[e.level];n.textCodec||Cp(t,this.initPTS[e.cc],()=>{n.textCodec=Ru,this._parseIMSC1(e,t)},()=>{n.textCodec="wvtt"})}_appendCues(e,t){const n=this.hls;if(this.config.renderTextTracksNatively){const i=this.textTracks[t];if(!i||i.mode==="disabled")return;e.forEach(a=>Cm(i,a))}else{const i=this.tracks[t];if(!i)return;const a=i.default?"default":"subtitles"+t;n.trigger(L.CUES_PARSED,{type:"subtitles",cues:e,track:a})}}onFragDecrypted(e,t){const{frag:n}=t;n.type===Te.SUBTITLE&&this.onFragLoaded(L.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){this.initCea608Parsers();const{cea608Parser1:n,cea608Parser2:i}=this;if(!this.enabled||!n||!i)return;const{frag:a,samples:l}=t;if(!(a.type===Te.MAIN&&this.closedCaptionsForLevel(a)==="NONE"))for(let u=0;u<l.length;u++){const f=l[u].bytes;if(f){const d=this.extractCea608Data(f);n.addData(l[u].pts,d[0]),i.addData(l[u].pts,d[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:n,endOffsetSubtitles:i,type:a}){const{media:l}=this;if(!(!l||l.currentTime<n)){if(!a||a==="video"){const{captionsTracks:u}=this;Object.keys(u).forEach(f=>Vu(u[f],t,n))}if(this.config.renderTextTracksNatively&&t===0&&i!==void 0){const{textTracks:u}=this;Object.keys(u).forEach(f=>Vu(u[f],t,i))}}}extractCea608Data(e){const t=[[],[]],n=e[0]&31;let i=2;for(let a=0;a<n;a++){const l=e[i++],u=127&e[i++],f=127&e[i++];if(u===0&&f===0)continue;if((4&l)!==0){const p=3&l;(p===0||p===1)&&(t[p].push(u),t[p].push(f))}}return t}}function og(o){return o.characteristics&&/transcribes-spoken-dialog/gi.test(o.characteristics)&&/describes-music-and-sound/gi.test(o.characteristics)?"captions":"subtitles"}function Dp(o,e){return!!o&&o.kind===og(e)&&qu(e,o)}function uS(o,e,t,n){return Math.min(e,n)-Math.max(o,t)}function _p(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}class wc{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(L.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(L.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(L.MANIFEST_PARSED,this.onManifestParsed,this),e.on(L.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(L.BUFFER_CODECS,this.onBufferCodecs,this),e.on(L.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(L.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(L.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(L.MANIFEST_PARSED,this.onManifestParsed,this),e.off(L.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(L.BUFFER_CODECS,this.onBufferCodecs,this),e.off(L.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const n=this.hls.levels[t.droppedLevel];this.isLevelAllowed(n)&&this.restrictedLevels.push({bitrate:n.bitrate,height:n.height,width:n.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){const n=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,n.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&oe(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const e=this.hls.levels;if(e.length){const t=this.hls,n=this.getMaxLevel(e.length-1);n!==this.autoLevelCapping&&O.log(`Setting autoLevelCapping to ${n}: ${e[n].height}p@${e[n].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=n,t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const n=t.filter((i,a)=>this.isLevelAllowed(i)&&a<=e);return this.clientRect=null,wc.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const n=e.getBoundingClientRect();t.width=n.width,t.height=n.height,!t.width&&!t.height&&(t.width=n.right-n.left||e.width||0,t.height=n.bottom-n.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return e}isLevelAllowed(e){return!this.restrictedLevels.some(n=>e.bitrate===n.bitrate&&e.width===n.width&&e.height===n.height)}static getMaxLevelByMediaSize(e,t,n){if(!(e!=null&&e.length))return-1;const i=(u,f)=>f?u.width!==f.width||u.height!==f.height:!0;let a=e.length-1;const l=Math.max(t,n);for(let u=0;u<e.length;u+=1){const f=e[u];if((f.width>=l||f.height>=l)&&i(f,e[u+1])){a=u;break}}return a}}class cS{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(L.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off(L.MEDIA_ATTACHING,this.onMediaAttaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const n=this.hls.config;if(n.capLevelOnFPSDrop){const i=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=i,i&&typeof i.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),n.fpsDroppedMonitoringPeriod)}}checkFPS(e,t,n){const i=performance.now();if(t){if(this.lastTime){const a=i-this.lastTime,l=n-this.lastDroppedFrames,u=t-this.lastDecodedFrames,f=1e3*l/a,d=this.hls;if(d.trigger(L.FPS_DROP,{currentDropped:l,currentDecoded:u,totalDroppedFrames:n}),f>0&&l>d.config.fpsDroppedMonitoringThreshold*u){let p=d.currentLevel;O.warn("drop FPS ratio greater than max allowed value for currentLevel: "+p),p>0&&(d.autoLevelCapping===-1||d.autoLevelCapping>=p)&&(p=p-1,d.trigger(L.FPS_DROP_LEVEL_CAPPING,{level:p,droppedLevel:d.currentLevel}),d.autoLevelCapping=p,this.streamController.nextLevelSwitch())}}this.lastTime=i,this.lastDroppedFrames=n,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}const Da="[eme]";class Qr{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=Qr.CDMCleanupPromise?[Qr.CDMCleanupPromise]:[],this.debug=O.debug.bind(O,Da),this.log=O.log.bind(O,Da),this.warn=O.warn.bind(O,Da),this.error=O.error.bind(O,Da),this.onMediaEncrypted=t=>{const{initDataType:n,initData:i}=t,a=`"${t.type}" event: init data type: "${n}"`;if(this.debug(a),i!==null){if(!this.keyFormatPromise){let l=Object.keys(this.keySystemAccessPromises);l.length||(l=Ta(this.config));const u=l.map(cu).filter(f=>!!f);this.keyFormatPromise=this.getKeyFormatPromise(u)}this.keyFormatPromise.then(l=>{const u=lu(l);let f,d;if(n==="sinf"){if(u!==be.FAIRPLAY){this.warn(`Ignoring unexpected "${t.type}" event with init data type: "${n}" for selected key-system ${u}`);return}const v=nt(new Uint8Array(i));try{const x=fc(JSON.parse(v).sinf),S=xm(x);if(!S)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");f=S.subarray(8,24),d=be.FAIRPLAY}catch(x){this.warn(`${a} Failed to parse sinf: ${x}`);return}}else{if(u!==be.WIDEVINE&&u!==be.PLAYREADY){this.warn(`Ignoring unexpected "${t.type}" event with init data type: "${n}" for selected key-system ${u}`);return}const v=Gv(i),x=v.filter(R=>!!R.systemId&&uu(R.systemId)===u);x.length>1&&this.warn(`${a} Using first of ${x.length} pssh found for selected key-system ${u}`);const S=x[0];if(!S){v.length===0||v.some(R=>!R.systemId)?this.warn(`${a} contains incomplete or invalid pssh data`):this.log(`ignoring ${a} for ${v.map(R=>uu(R.systemId)).join(",")} pssh data in favor of playlist keys`);return}if(d=uu(S.systemId),S.version===0&&S.data)if(d===be.WIDEVINE){const R=S.data.length-22;f=S.data.subarray(R,R+16)}else d===be.PLAYREADY&&(f=hm(S.data))}if(!d||!f){this.log(`Unable to handle ${a} with key-system ${u}`);return}const p=an.hexDump(f),{keyIdToKeySessionPromise:m,mediaKeySessions:y}=this;let T=m[p];for(let v=0;v<y.length;v++){const x=y[v],S=x.decryptdata;if(!S.keyId)continue;const R=an.hexDump(S.keyId);if(p===R||S.uri.replace(/-/g,"").indexOf(p)!==-1){if(T=m[R],S.pssh)break;delete m[R],S.pssh=new Uint8Array(i),S.keyId=f,T=m[p]=T.then(()=>this.generateRequestWithPreferredKeySession(x,n,i,"encrypted-event-key-match")),T.catch(I=>this.handleError(I));break}}if(!T){if(d!==u){this.log(`Ignoring "${a}" with ${d} init data for selected key-system ${u}`);return}T=m[p]=this.getKeySystemSelectionPromise([d]).then(({keySystem:v,mediaKeys:x})=>{var S;this.throwIfDestroyed();const R=new Zi("ISO-23001-7",p,(S=cu(v))!=null?S:"");return R.pssh=new Uint8Array(i),R.keyId=f,this.attemptSetMediaKeys(v,x).then(()=>{this.throwIfDestroyed();const I=this.createMediaKeySessionContext({decryptdata:R,keySystem:v,mediaKeys:x});return this.generateRequestWithPreferredKeySession(I,n,i,"encrypted-event-no-match")})}),T.catch(v=>this.handleError(v))}})}},this.onWaitingForKey=t=>{this.log(`"${t.type}" event`)},this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.unregisterListeners(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(L.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(L.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(L.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(L.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(L.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(L.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(L.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(L.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:n}=this.config,i=t[e];if(i)return i.licenseUrl;if(e===be.WIDEVINE&&n)return n}getLicenseServerUrlOrThrow(e){const t=this.getLicenseServerUrl(e);if(t===void 0)throw new Error(`no license server URL configured for key-system "${e}"`);return t}getServerCertificateUrl(e){const{drmSystems:t}=this.config,n=t[e];if(n)return n.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,n=(l,u,f)=>!!l&&f.indexOf(l)===u,i=t.map(l=>l.audioCodec).filter(n),a=t.map(l=>l.videoCodec).filter(n);return i.length+a.length===0&&a.push("avc1.42e01e"),new Promise((l,u)=>{const f=d=>{const p=d.shift();this.getMediaKeysPromise(p,i,a).then(m=>l({keySystem:p,mediaKeys:m})).catch(m=>{d.length?f(d):m instanceof Bt?u(m):u(new Bt({type:Le.KEY_SYSTEM_ERROR,details:G.KEY_SYSTEM_NO_ACCESS,error:m,fatal:!0},m.message))})};f(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:n}=this.config;if(typeof n!="function"){let i=`Configured requestMediaKeySystemAccess is not a function ${n}`;return dm===null&&self.location.protocol==="http:"&&(i=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(i))}return n(e,t)}getMediaKeysPromise(e,t,n){const i=gv(e,t,n,this.config.drmSystemOptions),a=this.keySystemAccessPromises[e];let l=a==null?void 0:a.keySystemAccess;if(!l){this.log(`Requesting encrypted media "${e}" key-system access with config: ${JSON.stringify(i)}`),l=this.requestMediaKeySystemAccess(e,i);const u=this.keySystemAccessPromises[e]={keySystemAccess:l};return l.catch(f=>{this.log(`Failed to obtain access to key-system "${e}": ${f}`)}),l.then(f=>{this.log(`Access for key-system "${f.keySystem}" obtained`);const d=this.fetchServerCertificate(e);return this.log(`Create media-keys for "${e}"`),u.mediaKeys=f.createMediaKeys().then(p=>(this.log(`Media-keys created for "${e}"`),d.then(m=>m?this.setMediaKeysServerCertificate(p,e,m):p))),u.mediaKeys.catch(p=>{this.error(`Failed to create media-keys for "${e}"}: ${p}`)}),u.mediaKeys})}return l.then(()=>a.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:n}){this.log(`Creating key-system session "${t}" keyId: ${an.hexDump(e.keyId||[])}`);const i=n.createSession(),a={decryptdata:e,keySystem:t,mediaKeys:n,mediaKeysSession:i,keyStatus:"status-pending"};return this.mediaKeySessions.push(a),a}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const n=this.createMediaKeySessionContext(e),i=this.getKeyIdString(t),a="cenc";this.keyIdToKeySessionPromise[i]=this.generateRequestWithPreferredKeySession(n,a,t.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(e.keyId===null)throw new Error("keyId is null");return an.hexDump(e.keyId)}updateKeySession(e,t){var n;const i=e.mediaKeysSession;return this.log(`Updating key-session "${i.sessionId}" for keyID ${an.hexDump(((n=e.decryptdata)==null?void 0:n.keyId)||[])}
      } (data length: ${t&&t.byteLength})`),i.update(t)}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){return new Promise((t,n)=>{const i=Ta(this.config),a=e.map(lu).filter(l=>!!l&&i.indexOf(l)!==-1);return this.getKeySystemSelectionPromise(a).then(({keySystem:l})=>{const u=cu(l);u?t(u):n(new Error(`Unable to find format for key-system "${l}"`))}).catch(n)})}loadKey(e){const t=e.keyInfo.decryptdata,n=this.getKeyIdString(t),i=`(keyId: ${n} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${i}`);let a=this.keyIdToKeySessionPromise[n];return a||(a=this.keyIdToKeySessionPromise[n]=this.getKeySystemForKeyPromise(t).then(({keySystem:l,mediaKeys:u})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${i}`),this.attemptSetMediaKeys(l,u).then(()=>{this.throwIfDestroyed();const f=this.createMediaKeySessionContext({keySystem:l,mediaKeys:u,decryptdata:t});return this.generateRequestWithPreferredKeySession(f,"cenc",t.pssh,"playlist-key")}))),a.catch(l=>this.handleError(l))),a}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e){this.hls&&(this.error(e.message),e instanceof Bt?this.hls.trigger(L.ERROR,e.data):this.hls.trigger(L.ERROR,{type:Le.KEY_SYSTEM_ERROR,details:G.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){const t=this.getKeyIdString(e),n=this.keyIdToKeySessionPromise[t];if(!n){const i=lu(e.keyFormat),a=i?[i]:Ta(this.config);return this.attemptKeySystemAccess(a)}return n}getKeySystemSelectionPromise(e){if(e.length||(e=Ta(this.config)),e.length===0)throw new Bt({type:Le.KEY_SYSTEM_ERROR,details:G.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${JSON.stringify({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}attemptSetMediaKeys(e,t){const n=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const i=Promise.all(n).then(()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)});return this.setMediaKeysQueue.push(i),i.then(()=>{this.log(`Media-keys set for "${e}"`),n.push(i),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(a=>n.indexOf(a)===-1)})}generateRequestWithPreferredKeySession(e,t,n,i){var a,l;const u=(a=this.config.drmSystems)==null||(l=a[e.keySystem])==null?void 0:l.generateRequest;if(u)try{const v=u.call(this.hls,t,n,e);if(!v)throw new Error("Invalid response from configured generateRequest filter");t=v.initDataType,n=e.decryptdata.pssh=v.initData?new Uint8Array(v.initData):null}catch(v){var f;if(this.warn(v.message),(f=this.hls)!=null&&f.config.debug)throw v}if(n===null)return this.log(`Skipping key-session request for "${i}" (no initData)`),Promise.resolve(e);const d=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${i}": ${d} (init data type: ${t} length: ${n?n.byteLength:null})`);const p=new Lc,m=e._onmessage=v=>{const x=e.mediaKeysSession;if(!x){p.emit("error",new Error("invalid state"));return}const{messageType:S,message:R}=v;this.log(`"${S}" message event for session "${x.sessionId}" message size: ${R.byteLength}`),S==="license-request"||S==="license-renewal"?this.renewLicense(e,R).catch(I=>{this.handleError(I),p.emit("error",I)}):S==="license-release"?e.keySystem===be.FAIRPLAY&&(this.updateKeySession(e,Gu("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${S}"`)},y=e._onkeystatuseschange=v=>{if(!e.mediaKeysSession){p.emit("error",new Error("invalid state"));return}this.onKeyStatusChange(e);const S=e.keyStatus;p.emit("keyStatus",S),S==="expired"&&(this.warn(`${e.keySystem} expired for key ${d}`),this.renewKeySession(e))};e.mediaKeysSession.addEventListener("message",m),e.mediaKeysSession.addEventListener("keystatuseschange",y);const T=new Promise((v,x)=>{p.on("error",x),p.on("keyStatus",S=>{S.startsWith("usable")?v():S==="output-restricted"?x(new Bt({type:Le.KEY_SYSTEM_ERROR,details:G.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):S==="internal-error"?x(new Bt({type:Le.KEY_SYSTEM_ERROR,details:G.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${S}"`)):S==="expired"?x(new Error("key expired while generating request")):this.warn(`unhandled key status change "${S}"`)})});return e.mediaKeysSession.generateRequest(t,n).then(()=>{var v;this.log(`Request generated for key-session "${(v=e.mediaKeysSession)==null?void 0:v.sessionId}" keyId: ${d}`)}).catch(v=>{throw new Bt({type:Le.KEY_SYSTEM_ERROR,details:G.KEY_SYSTEM_NO_SESSION,error:v,fatal:!1},`Error generating key-session request: ${v}`)}).then(()=>T).catch(v=>{throw p.removeAllListeners(),this.removeSession(e),v}).then(()=>(p.removeAllListeners(),e))}onKeyStatusChange(e){e.mediaKeysSession.keyStatuses.forEach((t,n)=>{this.log(`key status change "${t}" for keyStatuses keyId: ${an.hexDump("buffer"in n?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n))} session keyId: ${an.hexDump(new Uint8Array(e.decryptdata.keyId||[]))} uri: ${e.decryptdata.uri}`),e.keyStatus=t})}fetchServerCertificate(e){const t=this.config,n=t.loader,i=new n(t),a=this.getServerCertificateUrl(e);return a?(this.log(`Fetching server certificate for "${e}"`),new Promise((l,u)=>{const f={responseType:"arraybuffer",url:a},d=t.certLoadPolicy.default,p={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},m={onSuccess:(y,T,v,x)=>{l(y.data)},onError:(y,T,v,x)=>{u(new Bt({type:Le.KEY_SYSTEM_ERROR,details:G.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:v,response:lt({url:f.url,data:void 0},y)},`"${e}" certificate request failed (${a}). Status: ${y.code} (${y.text})`))},onTimeout:(y,T,v)=>{u(new Bt({type:Le.KEY_SYSTEM_ERROR,details:G.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:v,response:{url:f.url,data:void 0}},`"${e}" certificate request timed out (${a})`))},onAbort:(y,T,v)=>{u(new Error("aborted"))}};i.load(f,p,m)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,n){return new Promise((i,a)=>{e.setServerCertificate(n).then(l=>{this.log(`setServerCertificate ${l?"success":"not supported by CDM"} (${n==null?void 0:n.byteLength}) on "${t}"`),i(e)}).catch(l=>{a(new Bt({type:Le.KEY_SYSTEM_ERROR,details:G.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:l,fatal:!0},l.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(n=>this.updateKeySession(e,new Uint8Array(n)).catch(i=>{throw new Bt({type:Le.KEY_SYSTEM_ERROR,details:G.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:i,fatal:!0},i.message)}))}unpackPlayReadyKeyMessage(e,t){const n=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!n.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;const i=new DOMParser().parseFromString(n,"application/xml"),a=i.querySelectorAll("HttpHeader");if(a.length>0){let p;for(let m=0,y=a.length;m<y;m++){var l,u;p=a[m];const T=(l=p.querySelector("name"))==null?void 0:l.textContent,v=(u=p.querySelector("value"))==null?void 0:u.textContent;T&&v&&e.setRequestHeader(T,v)}}const f=i.querySelector("Challenge"),d=f==null?void 0:f.textContent;if(!d)throw new Error("Cannot find <Challenge> in key message");return Gu(atob(d))}setupLicenseXHR(e,t,n,i){const a=this.config.licenseXhrSetup;return a?Promise.resolve().then(()=>{if(!n.decryptdata)throw new Error("Key removed");return a.call(this.hls,e,t,n,i)}).catch(l=>{if(!n.decryptdata)throw l;return e.open("POST",t,!0),a.call(this.hls,e,t,n,i)}).then(l=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:l||i})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:i}))}requestLicense(e,t){const n=this.config.keyLoadPolicy.default;return new Promise((i,a)=>{const l=this.getLicenseServerUrlOrThrow(e.keySystem);this.log(`Sending license request to URL: ${l}`);const u=new XMLHttpRequest;u.responseType="arraybuffer",u.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return a(new Error("invalid state"));if(u.readyState===4)if(u.status===200){this._requestLicenseFailureCount=0;let f=u.response;this.log(`License received ${f instanceof ArrayBuffer?f.byteLength:f}`);const d=this.config.licenseResponseCallback;if(d)try{f=d.call(this.hls,u,l,e)}catch(p){this.error(p)}i(f)}else{const f=n.errorRetry,d=f?f.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>d||u.status>=400&&u.status<500)a(new Bt({type:Le.KEY_SYSTEM_ERROR,details:G.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:u,response:{url:l,data:void 0,code:u.status,text:u.statusText}},`License Request XHR failed (${l}). Status: ${u.status} (${u.statusText})`));else{const p=d-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${p} attempts left`),this.requestLicense(e,t).then(i,a)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=u,this.setupLicenseXHR(u,l,e,t).then(({xhr:f,licenseChallenge:d})=>{e.keySystem==be.PLAYREADY&&(d=this.unpackPlayReadyKeyMessage(f,d)),f.send(d)})})}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const n=t.media;this.media=n,n.removeEventListener("encrypted",this.onMediaEncrypted),n.removeEventListener("waitingforkey",this.onWaitingForKey),n.addEventListener("encrypted",this.onMediaEncrypted),n.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media,t=this.mediaKeySessions;e&&(e.removeEventListener("encrypted",this.onMediaEncrypted),e.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},Zi.clearKeyUriToKeyIdMap();const n=t.length;Qr.CDMCleanupPromise=Promise.all(t.map(i=>this.removeSession(i)).concat(e==null?void 0:e.setMediaKeys(null).catch(i=>{this.log(`Could not clear media keys: ${i}`)}))).then(()=>{n&&(this.log("finished closing key sessions and clearing media keys"),t.length=0)}).catch(i=>{this.log(`Could not close sessions and clear media keys: ${i}`)})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(e,{sessionKeys:t}){if(!(!t||!this.config.emeEnabled)&&!this.keyFormatPromise){const n=t.reduce((i,a)=>(i.indexOf(a.keyFormat)===-1&&i.push(a.keyFormat),i),[]);this.log(`Selecting key-system from session-keys ${n.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(n)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:n}=e;if(t){this.log(`Remove licenses and keys and close session ${t.sessionId}`),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),n&&n.readyState!==XMLHttpRequest.DONE&&n.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const i=this.mediaKeySessions.indexOf(e);return i>-1&&this.mediaKeySessions.splice(i,1),t.remove().catch(a=>{this.log(`Could not remove session: ${a}`)}).then(()=>t.close()).catch(a=>{this.log(`Could not close session: ${a}`)})}}}Qr.CDMCleanupPromise=void 0;class Bt extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}var gt;(function(o){o.MANIFEST="m",o.AUDIO="a",o.VIDEO="v",o.MUXED="av",o.INIT="i",o.CAPTION="c",o.TIMED_TEXT="tt",o.KEY="k",o.OTHER="o"})(gt||(gt={}));var Qu;(function(o){o.DASH="d",o.HLS="h",o.SMOOTH="s",o.OTHER="o"})(Qu||(Qu={}));var mr;(function(o){o.OBJECT="CMCD-Object",o.REQUEST="CMCD-Request",o.SESSION="CMCD-Session",o.STATUS="CMCD-Status"})(mr||(mr={}));const fS={[mr.OBJECT]:["br","d","ot","tb"],[mr.REQUEST]:["bl","dl","mtp","nor","nrr","su"],[mr.SESSION]:["cid","pr","sf","sid","st","v"],[mr.STATUS]:["bs","rtp"]};class ti{constructor(e,t){this.value=void 0,this.params=void 0,Array.isArray(e)&&(e=e.map(n=>n instanceof ti?n:new ti(n))),this.value=e,this.params=t}}class lg{constructor(e){this.description=void 0,this.description=e}}const dS="Dict";function hS(o){return Array.isArray(o)?JSON.stringify(o):o instanceof Map?"Map{}":o instanceof Set?"Set{}":typeof o=="object"?JSON.stringify(o):String(o)}function pS(o,e,t,n){return new Error(`failed to ${o} "${hS(e)}" as ${t}`,{cause:n})}const Pp="Bare Item",mS="Boolean",gS="Byte Sequence",yS="Decimal",ES="Integer";function vS(o){return o<-999999999999999||999999999999999<o}const TS=/[\x00-\x1f\x7f]+/,xS="Token",SS="Key";function hn(o,e,t){return pS("serialize",o,e,t)}function LS(o){if(typeof o!="boolean")throw hn(o,mS);return o?"?1":"?0"}function AS(o){return btoa(String.fromCharCode(...o))}function RS(o){if(ArrayBuffer.isView(o)===!1)throw hn(o,gS);return`:${AS(o)}:`}function ug(o){if(vS(o))throw hn(o,ES);return o.toString()}function wS(o){return`@${ug(o.getTime()/1e3)}`}function cg(o,e){if(o<0)return-cg(-o,e);const t=Math.pow(10,e);if(Math.abs(o*t%1-.5)<Number.EPSILON){const i=Math.floor(o*t);return(i%2===0?i:i+1)/t}else return Math.round(o*t)/t}function CS(o){const e=cg(o,3);if(Math.floor(Math.abs(e)).toString().length>12)throw hn(o,yS);const t=e.toString();return t.includes(".")?t:`${t}.0`}const IS="String";function kS(o){if(TS.test(o))throw hn(o,IS);return`"${o.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function DS(o){return o.description||o.toString().slice(7,-1)}function bp(o){const e=DS(o);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e)===!1)throw hn(e,xS);return e}function Ju(o){switch(typeof o){case"number":if(!oe(o))throw hn(o,Pp);return Number.isInteger(o)?ug(o):CS(o);case"string":return kS(o);case"symbol":return bp(o);case"boolean":return LS(o);case"object":if(o instanceof Date)return wS(o);if(o instanceof Uint8Array)return RS(o);if(o instanceof lg)return bp(o);default:throw hn(o,Pp)}}function Zu(o){if(/^[a-z*][a-z0-9\-_.*]*$/.test(o)===!1)throw hn(o,SS);return o}function Cc(o){return o==null?"":Object.entries(o).map(([e,t])=>t===!0?`;${Zu(e)}`:`;${Zu(e)}=${Ju(t)}`).join("")}function fg(o){return o instanceof ti?`${Ju(o.value)}${Cc(o.params)}`:Ju(o)}function _S(o){return`(${o.value.map(fg).join(" ")})${Cc(o.params)}`}function PS(o,e={whitespace:!0}){if(typeof o!="object")throw hn(o,dS);const t=o instanceof Map?o.entries():Object.entries(o),n=e!=null&&e.whitespace?" ":"";return Array.from(t).map(([i,a])=>{a instanceof ti||(a=new ti(a));let l=Zu(i);return a.value===!0?l+=Cc(a.params):(l+="=",Array.isArray(a.value)?l+=_S(a):l+=fg(a)),l}).join(`,${n}`)}function bS(o,e){return PS(o,e)}const OS=o=>o==="ot"||o==="sf"||o==="st",FS=o=>typeof o=="number"?oe(o):o!=null&&o!==""&&o!==!1;function NS(o,e){const t=new URL(o),n=new URL(e);if(t.origin!==n.origin)return o;const i=t.pathname.split("/").slice(1),a=n.pathname.split("/").slice(1,-1);for(;i[0]===a[0];)i.shift(),a.shift();for(;a.length;)a.shift(),i.unshift("..");return i.join("/")}function MS(){try{return crypto.randomUUID()}catch{try{const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch{let t=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,i=>{const a=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(i=="x"?a:a&3|8).toString(16)})}}}const $a=o=>Math.round(o),US=(o,e)=>(e!=null&&e.baseUrl&&(o=NS(o,e.baseUrl)),encodeURIComponent(o)),_a=o=>$a(o/100)*100,BS={br:$a,d:$a,bl:_a,dl:_a,mtp:_a,nor:US,rtp:_a,tb:$a};function $S(o,e){const t={};if(o==null||typeof o!="object")return t;const n=Object.keys(o).sort(),i=Ze({},BS,e==null?void 0:e.formatters),a=e==null?void 0:e.filter;return n.forEach(l=>{if(a!=null&&a(l))return;let u=o[l];const f=i[l];f&&(u=f(u,e)),!(l==="v"&&u===1)&&(l=="pr"&&u===1||FS(u)&&(OS(l)&&typeof u=="string"&&(u=new lg(u)),t[l]=u))}),t}function dg(o,e={}){return o?bS($S(o,e),Ze({whitespace:!1},e)):""}function GS(o,e={}){if(!o)return{};const t=Object.entries(o),n=Object.entries(fS).concat(Object.entries((e==null?void 0:e.customHeaderMap)||{})),i=t.reduce((a,l)=>{var u,f;const[d,p]=l,m=((u=n.find(y=>y[1].includes(d)))==null?void 0:u[0])||mr.REQUEST;return(f=a[m])!=null||(a[m]={}),a[m][d]=p,a},{});return Object.entries(i).reduce((a,[l,u])=>(a[l]=dg(u,e),a),{})}function HS(o,e,t){return Ze(o,GS(e,t))}const VS="CMCD";function KS(o,e={}){if(!o)return"";const t=dg(o,e);return`${VS}=${encodeURIComponent(t)}`}const Op=/CMCD=[^&#]+/;function jS(o,e,t){const n=KS(e,t);if(!n)return o;if(Op.test(o))return o.replace(Op,n);const i=o.includes("?")?"&":"?";return`${o}${i}${n}`}class zS{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=i=>{try{this.apply(i,{ot:gt.MANIFEST,su:!this.initialized})}catch(a){O.warn("Could not generate manifest CMCD data.",a)}},this.applyFragmentData=i=>{try{const a=i.frag,l=this.hls.levels[a.level],u=this.getObjectType(a),f={d:a.duration*1e3,ot:u};(u===gt.VIDEO||u===gt.AUDIO||u==gt.MUXED)&&(f.br=l.bitrate/1e3,f.tb=this.getTopBandwidth(u)/1e3,f.bl=this.getBufferLength(u)),this.apply(i,f)}catch(a){O.warn("Could not generate segment CMCD data.",a)}},this.hls=e;const t=this.config=e.config,{cmcd:n}=t;n!=null&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=n.sessionId||MS(),this.cid=n.contentId,this.useHeaders=n.useHeaders===!0,this.includeKeys=n.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(L.MEDIA_DETACHED,this.onMediaDetached,this),e.on(L.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(L.MEDIA_DETACHED,this.onMediaDetached,this),e.off(L.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var n,i;this.audioBuffer=(n=t.tracks.audio)==null?void 0:n.buffer,this.videoBuffer=(i=t.tracks.video)==null?void 0:i.buffer}createData(){var e;return{v:1,sf:Qu.HLS,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){Ze(t,this.createData());const n=t.ot===gt.INIT||t.ot===gt.VIDEO||t.ot===gt.MUXED;this.starved&&n&&(t.bs=!0,t.su=!0,this.starved=!1),t.su==null&&(t.su=this.buffering);const{includeKeys:i}=this;i&&(t=Object.keys(t).reduce((a,l)=>(i.includes(l)&&(a[l]=t[l]),a),{})),this.useHeaders?(e.headers||(e.headers={}),HS(e.headers,t)):e.url=jS(e.url,t)}getObjectType(e){const{type:t}=e;if(t==="subtitle")return gt.TIMED_TEXT;if(e.sn==="initSegment")return gt.INIT;if(t==="audio")return gt.AUDIO;if(t==="main")return this.hls.audioTracks.length?gt.VIDEO:gt.MUXED}getTopBandwidth(e){let t=0,n;const i=this.hls;if(e===gt.AUDIO)n=i.audioTracks;else{const a=i.maxAutoLevel,l=a>-1?a+1:i.levels.length;n=i.levels.slice(0,l)}for(const a of n)a.bitrate>t&&(t=a.bitrate);return t>0?t:NaN}getBufferLength(e){const t=this.hls.media,n=e===gt.AUDIO?this.audioBuffer:this.videoBuffer;return!n||!t?NaN:Ue.bufferInfo(n,t.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,n=e||this.config.loader;return class{constructor(a){this.loader=void 0,this.loader=new n(a)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(a,l,u){t(a),this.loader.load(a,l,u)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,n=e||this.config.loader;return class{constructor(a){this.loader=void 0,this.loader=new n(a)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(a,l,u){t(a),this.loader.load(a,l,u)}}}}const WS=3e5;class YS{constructor(e){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.log=O.log.bind(O,"[content-steering]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(L.MANIFEST_PARSED,this.onManifestParsed,this),e.on(L.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(L.MANIFEST_PARSED,this.onManifestParsed,this),e.off(L.ERROR,this.onError,this))}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=this.timeToLoad*1e3-(performance.now()-this.updated);if(e>0){this.scheduleRefresh(this.uri,e);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(n=>n!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:n}=t;n!==null&&(this.pathwayId=n.pathwayId,this.uri=n.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:n}=t;if((n==null?void 0:n.action)===ft.SendAlternateToPenaltyBox&&n.flags===qt.MoveAllAlternatesMatchingHost){const i=this.levels;let a=this.pathwayPriority,l=this.pathwayId;if(t.context){const{groupId:u,pathwayId:f,type:d}=t.context;u&&i?l=this.getPathwayForGroupId(u,d,l):f&&(l=f)}l in this.penalizedPathways||(this.penalizedPathways[l]=performance.now()),!a&&i&&(a=i.reduce((u,f)=>(u.indexOf(f.pathwayId)===-1&&u.push(f.pathwayId),u),[])),a&&a.length>1&&(this.updatePathwayPriority(a),n.resolved=this.pathwayId!==l),n.resolved||O.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${l} levels: ${i&&i.length} priorities: ${JSON.stringify(a)} penalized: ${JSON.stringify(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(t.length===0){const n=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${n}"`),t=this.getLevelsForPathway(n),this.pathwayId=n}return t.length!==e.length&&this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){this.pathwayPriority=e;let t;const n=this.penalizedPathways,i=performance.now();Object.keys(n).forEach(a=>{i-n[a]>WS&&delete n[a]});for(let a=0;a<e.length;a++){const l=e[a];if(l in n)continue;if(l===this.pathwayId)return;const u=this.hls.nextLoadLevel,f=this.hls.levels[u];if(t=this.getLevelsForPathway(l),t.length>0){this.log(`Setting Pathway to "${l}"`),this.pathwayId=l,_m(t),this.hls.trigger(L.LEVELS_UPDATED,{levels:t});const d=this.hls.levels[u];f&&d&&this.levels&&(d.attrs["STABLE-VARIANT-ID"]!==f.attrs["STABLE-VARIANT-ID"]&&d.bitrate!==f.bitrate&&this.log(`Unstable Pathways change from bitrate ${f.bitrate} to ${d.bitrate}`),this.hls.nextLoadLevel=u);break}}}getPathwayForGroupId(e,t,n){const i=this.getLevelsForPathway(n).concat(this.levels||[]);for(let a=0;a<i.length;a++)if(t===De.AUDIO_TRACK&&i[a].hasAudioGroup(e)||t===De.SUBTITLE_TRACK&&i[a].hasSubtitleGroup(e))return i[a].pathwayId;return n}clonePathways(e){const t=this.levels;if(!t)return;const n={},i={};e.forEach(a=>{const{ID:l,"BASE-ID":u,"URI-REPLACEMENT":f}=a;if(t.some(p=>p.pathwayId===l))return;const d=this.getLevelsForPathway(u).map(p=>{const m=new We(p.attrs);m["PATHWAY-ID"]=l;const y=m.AUDIO&&`${m.AUDIO}_clone_${l}`,T=m.SUBTITLES&&`${m.SUBTITLES}_clone_${l}`;y&&(n[m.AUDIO]=y,m.AUDIO=y),T&&(i[m.SUBTITLES]=T,m.SUBTITLES=T);const v=hg(p.uri,m["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",f),x=new ei({attrs:m,audioCodec:p.audioCodec,bitrate:p.bitrate,height:p.height,name:p.name,url:v,videoCodec:p.videoCodec,width:p.width});if(p.audioGroups)for(let S=1;S<p.audioGroups.length;S++)x.addGroupId("audio",`${p.audioGroups[S]}_clone_${l}`);if(p.subtitleGroups)for(let S=1;S<p.subtitleGroups.length;S++)x.addGroupId("text",`${p.subtitleGroups[S]}_clone_${l}`);return x});t.push(...d),Fp(this.audioTracks,n,f,l),Fp(this.subtitleTracks,i,f,l)})}loadSteeringManifest(e){const t=this.hls.config,n=t.loader;this.loader&&this.loader.destroy(),this.loader=new n(t);let i;try{i=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(i.protocol!=="data:"){const p=(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate)|0;i.searchParams.set("_HLS_pathway",this.pathwayId),i.searchParams.set("_HLS_throughput",""+p)}const a={responseType:"json",url:i.href},l=t.steeringManifestLoadPolicy.default,u=l.errorRetry||l.timeoutRetry||{},f={loadPolicy:l,timeout:l.maxLoadTimeMs,maxRetry:u.maxNumRetry||0,retryDelay:u.retryDelayMs||0,maxRetryDelay:u.maxRetryDelayMs||0},d={onSuccess:(p,m,y,T)=>{this.log(`Loaded steering manifest: "${i}"`);const v=p.data;if(v.VERSION!==1){this.log(`Steering VERSION ${v.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=v.TTL;const{"RELOAD-URI":x,"PATHWAY-CLONES":S,"PATHWAY-PRIORITY":R}=v;if(x)try{this.uri=new self.URL(x,i).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${x}`);return}this.scheduleRefresh(this.uri||y.url),S&&this.clonePathways(S);const I={steeringManifest:v,url:i.toString()};this.hls.trigger(L.STEERING_MANIFEST_LOADED,I),R&&this.updatePathwayPriority(R)},onError:(p,m,y,T)=>{if(this.log(`Error loading steering manifest: ${p.code} ${p.text} (${m.url})`),this.stopLoad(),p.code===410){this.enabled=!1,this.log(`Steering manifest ${m.url} no longer available`);return}let v=this.timeToLoad*1e3;if(p.code===429){const x=this.loader;if(typeof(x==null?void 0:x.getResponseHeader)=="function"){const S=x.getResponseHeader("Retry-After");S&&(v=parseFloat(S)*1e3)}this.log(`Steering manifest ${m.url} rate limited`);return}this.scheduleRefresh(this.uri||m.url,v)},onTimeout:(p,m,y)=>{this.log(`Timeout loading steering manifest (${m.url})`),this.scheduleRefresh(this.uri||m.url)}};this.log(`Requesting steering manifest: ${i}`),this.loader.load(a,f,d)}scheduleRefresh(e,t=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var n;const i=(n=this.hls)==null?void 0:n.media;if(i&&!i.ended){this.loadSteeringManifest(e);return}this.scheduleRefresh(e,this.timeToLoad*1e3)},t)}}function Fp(o,e,t,n){o&&Object.keys(e).forEach(i=>{const a=o.filter(l=>l.groupId===i).map(l=>{const u=Ze({},l);return u.details=void 0,u.attrs=new We(u.attrs),u.url=u.attrs.URI=hg(l.url,l.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),u.groupId=u.attrs["GROUP-ID"]=e[i],u.attrs["PATHWAY-ID"]=n,u});o.push(...a)})}function hg(o,e,t,n){const{HOST:i,PARAMS:a,[t]:l}=n;let u;e&&(u=l==null?void 0:l[e],u&&(o=u));const f=new self.URL(o);return i&&!u&&(f.host=i),a&&Object.keys(a).sort().forEach(d=>{d&&f.searchParams.set(d,a[d])}),f.href}const qS=/^age:\s*[\d.]+\s*$/im;class pg{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new io,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,n){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=n,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e||!t)return;const n=this.loader=new self.XMLHttpRequest,i=this.stats;i.loading.first=0,i.loaded=0,i.aborted=!1;const a=this.xhrSetup;a?Promise.resolve().then(()=>{if(!(this.loader!==n||this.stats.aborted))return a(n,t.url)}).catch(l=>{if(!(this.loader!==n||this.stats.aborted))return n.open("GET",t.url,!0),a(n,t.url)}).then(()=>{this.loader!==n||this.stats.aborted||this.openAndSendXhr(n,t,e)}).catch(l=>{this.callbacks.onError({code:n.status,text:l.message},t,n,i)}):this.openAndSendXhr(n,t,e)}openAndSendXhr(e,t,n){e.readyState||e.open("GET",t.url,!0);const i=t.headers,{maxTimeToFirstByteMs:a,maxLoadTimeMs:l}=n.loadPolicy;if(i)for(const u in i)e.setRequestHeader(u,i[u]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),n.timeout=a&&oe(a)?a:l,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:n}=this;if(!e||!t)return;const i=t.readyState,a=this.config;if(!n.aborted&&i>=2&&(n.loading.first===0&&(n.loading.first=Math.max(self.performance.now(),n.loading.start),a.timeout!==a.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),a.timeout=a.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),a.loadPolicy.maxLoadTimeMs-(n.loading.first-n.loading.start)))),i===4)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const l=t.status,u=t.responseType==="text"?t.responseText:null;if(l>=200&&l<300){const m=u??t.response;if(m!=null){n.loading.end=Math.max(self.performance.now(),n.loading.first);const y=t.responseType==="arraybuffer"?m.byteLength:m.length;if(n.loaded=n.total=y,n.bwEstimate=n.total*8e3/(n.loading.end-n.loading.first),!this.callbacks)return;const T=this.callbacks.onProgress;if(T&&T(n,e,m,t),!this.callbacks)return;const v={url:t.responseURL,data:m,code:l};this.callbacks.onSuccess(v,n,e,t);return}}const f=a.loadPolicy.errorRetry,d=n.retry,p={url:e.url,data:void 0,code:l};qa(f,d,!1,p)?this.retry(f):(O.error(`${l} while loading ${e.url}`),this.callbacks.onError({code:l,text:t.statusText},e,t,n))}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry,t=this.stats.retry;if(qa(e,t,!0))this.retry(e);else{var n;O.warn(`timeout while loading ${(n=this.context)==null?void 0:n.url}`);const i=this.callbacks;i&&(this.abortInternal(),i.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:n}=this;this.retryDelay=pc(e,n.retry),n.retry++,O.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t==null?void 0:t.url}, retrying ${n.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&qS.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}function XS(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const QS=/(\d+)-(\d+)\/(\d+)/;class Np{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||tL,this.controller=new self.AbortController,this.stats=new io}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,n){const i=this.stats;if(i.loading.start)throw new Error("Loader can only be used once.");i.loading.start=self.performance.now();const a=JS(e,this.controller.signal),l=n.onProgress,u=e.responseType==="arraybuffer",f=u?"byteLength":"length",{maxTimeToFirstByteMs:d,maxLoadTimeMs:p}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=n,this.request=this.fetchSetup(e,a),self.clearTimeout(this.requestTimeout),t.timeout=d&&oe(d)?d:p,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),n.onTimeout(i,e,this.response)},t.timeout),self.fetch(this.request).then(m=>{this.response=this.loader=m;const y=Math.max(self.performance.now(),i.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=p,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),n.onTimeout(i,e,this.response)},p-(y-i.loading.start)),!m.ok){const{status:T,statusText:v}=m;throw new nL(v||"fetch, bad network response",T,m)}return i.loading.first=y,i.total=eL(m.headers)||i.total,l&&oe(t.highWaterMark)?this.loadProgressively(m,i,e,t.highWaterMark,l):u?m.arrayBuffer():e.responseType==="json"?m.json():m.text()}).then(m=>{const y=this.response;if(!y)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),i.loading.end=Math.max(self.performance.now(),i.loading.first);const T=m[f];T&&(i.loaded=i.total=T);const v={url:y.url,data:m,code:y.status};l&&!oe(t.highWaterMark)&&l(i,e,m,y),n.onSuccess(v,i,e,y)}).catch(m=>{if(self.clearTimeout(this.requestTimeout),i.aborted)return;const y=m&&m.code||0,T=m?m.message:null;n.onError({code:y,text:T},e,m?m.details:null,i)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,n,i=0,a){const l=new Fm,u=e.body.getReader(),f=()=>u.read().then(d=>{if(d.done)return l.dataLength&&a(t,n,l.flush(),e),Promise.resolve(new ArrayBuffer(0));const p=d.value,m=p.length;return t.loaded+=m,m<i||l.dataLength?(l.push(p),l.dataLength>=i&&a(t,n,l.flush(),e)):a(t,n,p,e),f()}).catch(()=>Promise.reject());return f()}}function JS(o,e){const t={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(Ze({},o.headers))};return o.rangeEnd&&t.headers.set("Range","bytes="+o.rangeStart+"-"+String(o.rangeEnd-1)),t}function ZS(o){const e=QS.exec(o);if(e)return parseInt(e[2])-parseInt(e[1])+1}function eL(o){const e=o.get("Content-Range");if(e){const n=ZS(e);if(oe(n))return n}const t=o.get("Content-Length");if(t)return parseInt(t)}function tL(o,e){return new self.Request(o.url,e)}class nL extends Error{constructor(e,t,n){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=n}}const rL=/\s/,iL={newCue(o,e,t,n){const i=[];let a,l,u,f,d;const p=self.VTTCue||self.TextTrackCue;for(let y=0;y<n.rows.length;y++)if(a=n.rows[y],u=!0,f=0,d="",!a.isEmpty()){var m;for(let x=0;x<a.chars.length;x++)rL.test(a.chars[x].uchar)&&u?f++:(d+=a.chars[x].uchar,u=!1);a.cueStartTime=e,e===t&&(t+=1e-4),f>=16?f--:f++;const T=rg(d.trim()),v=Rc(e,t,T);o!=null&&(m=o.cues)!=null&&m.getCueById(v)||(l=new p(e,t,T),l.id=v,l.line=y+1,l.align="left",l.position=10+Math.min(80,Math.floor(f*8/32)*10),i.push(l))}return o&&i.length&&(i.sort((y,T)=>y.line==="auto"||T.line==="auto"?0:y.line>8&&T.line>8?T.line-y.line:y.line-T.line),i.forEach(y=>Cm(o,y))),i}},sL={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},mg=lt(lt({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:pg,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:PT,bufferController:Nx,capLevelController:wc,errorController:TT,fpsController:cS,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:dm,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,useMediaCapabilities:!0,certLoadPolicy:{default:sL},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},aL()),{},{subtitleStreamController:Px,subtitleTrackController:Ox,timelineController:lS,audioStreamController:Dx,audioTrackController:_x,emeController:Qr,cmcdController:zS,contentSteeringController:YS});function aL(){return{cueHandler:iL,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function oL(o,e){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const t=ec(o),n=["manifest","level","frag"],i=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return n.forEach(a=>{const l=`${a==="level"?"playlist":a}LoadPolicy`,u=e[l]===void 0,f=[];i.forEach(d=>{const p=`${a}Loading${d}`,m=e[p];if(m!==void 0&&u){f.push(p);const y=t[l].default;switch(e[l]={default:y},d){case"TimeOut":y.maxLoadTimeMs=m,y.maxTimeToFirstByteMs=m;break;case"MaxRetry":y.errorRetry.maxNumRetry=m,y.timeoutRetry.maxNumRetry=m;break;case"RetryDelay":y.errorRetry.retryDelayMs=m,y.timeoutRetry.retryDelayMs=m;break;case"MaxRetryTimeout":y.errorRetry.maxRetryDelayMs=m,y.timeoutRetry.maxRetryDelayMs=m;break}}}),f.length&&O.warn(`hls.js config: "${f.join('", "')}" setting(s) are deprecated, use "${l}": ${JSON.stringify(e[l])}`)}),lt(lt({},t),e)}function ec(o){return o&&typeof o=="object"?Array.isArray(o)?o.map(ec):Object.keys(o).reduce((e,t)=>(e[t]=ec(o[t]),e),{}):o}function lL(o){const e=o.loader;e!==Np&&e!==pg?(O.log("[config]: Custom loader detected, cannot enable progressive streaming"),o.progressive=!1):XS()&&(o.loader=Np,o.progressive=!0,o.enableSoftwareAES=!0,O.log("[config]: Progressive streaming enabled, using FetchLoader"))}let ku;class uL extends mc{constructor(e,t){super(e,"[level-controller]"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(L.LEVEL_LOADED,this.onLevelLoaded,this),e.on(L.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(L.FRAG_BUFFERED,this.onFragBuffered,this),e.on(L.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(L.LEVEL_LOADED,this.onLevelLoaded,this),e.off(L.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(L.FRAG_BUFFERED,this.onFragBuffered,this),e.off(L.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const n=this.hls.config.preferManagedMediaSource,i=[],a={},l={};let u=!1,f=!1,d=!1;t.levels.forEach(p=>{var m,y;const T=p.attrs;let{audioCodec:v,videoCodec:x}=p;((m=v)==null?void 0:m.indexOf("mp4a.40.34"))!==-1&&(ku||(ku=/chrome|firefox/i.test(navigator.userAgent)),ku&&(p.audioCodec=v=void 0)),v&&(p.audioCodec=v=za(v,n)),((y=x)==null?void 0:y.indexOf("avc1"))===0&&(x=p.videoCodec=qv(x));const{width:S,height:R,unknownCodecs:I}=p;if(u||(u=!!(S&&R)),f||(f=!!x),d||(d=!!v),I!=null&&I.length||v&&!pu(v,"audio",n)||x&&!pu(x,"video",n))return;const{CODECS:w,"FRAME-RATE":b,"HDCP-LEVEL":_,"PATHWAY-ID":K,RESOLUTION:U,"VIDEO-RANGE":z}=T,V=`${`${K||"."}-`}${p.bitrate}-${U}-${b}-${w}-${z}-${_}`;if(a[V])if(a[V].uri!==p.url&&!p.attrs["PATHWAY-ID"]){const Q=l[V]+=1;p.attrs["PATHWAY-ID"]=new Array(Q+1).join(".");const ge=new ei(p);a[V]=ge,i.push(ge)}else a[V].addGroupId("audio",T.AUDIO),a[V].addGroupId("text",T.SUBTITLES);else{const Q=new ei(p);a[V]=Q,l[V]=1,i.push(Q)}}),this.filterAndSortMediaOptions(i,t,u,f,d)}filterAndSortMediaOptions(e,t,n,i,a){let l=[],u=[],f=e;if((n||i)&&a&&(f=f.filter(({videoCodec:v,videoRange:x,width:S,height:R})=>(!!v||!!(S&&R))&&lT(x))),f.length===0){Promise.resolve().then(()=>{if(this.hls){t.levels.length&&this.warn(`One or more CODECS in variant not supported: ${JSON.stringify(t.levels[0].attrs)}`);const v=new Error("no level with compatible codecs found in manifest");this.hls.trigger(L.ERROR,{type:Le.MEDIA_ERROR,details:G.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:v,reason:v.message})}});return}if(t.audioTracks){const{preferManagedMediaSource:v}=this.hls.config;l=t.audioTracks.filter(x=>!x.audioCodec||pu(x.audioCodec,"audio",v)),Mp(l)}t.subtitles&&(u=t.subtitles,Mp(u));const d=f.slice(0);f.sort((v,x)=>{if(v.attrs["HDCP-LEVEL"]!==x.attrs["HDCP-LEVEL"])return(v.attrs["HDCP-LEVEL"]||"")>(x.attrs["HDCP-LEVEL"]||"")?1:-1;if(n&&v.height!==x.height)return v.height-x.height;if(v.frameRate!==x.frameRate)return v.frameRate-x.frameRate;if(v.videoRange!==x.videoRange)return Wa.indexOf(v.videoRange)-Wa.indexOf(x.videoRange);if(v.videoCodec!==x.videoCodec){const S=Kh(v.videoCodec),R=Kh(x.videoCodec);if(S!==R)return R-S}if(v.uri===x.uri&&v.codecSet!==x.codecSet){const S=ja(v.codecSet),R=ja(x.codecSet);if(S!==R)return R-S}return v.averageBitrate!==x.averageBitrate?v.averageBitrate-x.averageBitrate:0});let p=d[0];if(this.steering&&(f=this.steering.filterParsedLevels(f),f.length!==d.length)){for(let v=0;v<d.length;v++)if(d[v].pathwayId===f[0].pathwayId){p=d[v];break}}this._levels=f;for(let v=0;v<f.length;v++)if(f[v]===p){var m;this._firstLevel=v;const x=p.bitrate,S=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${f.length} level(s) found, first bitrate: ${x}`),((m=this.hls.userConfig)==null?void 0:m.abrEwmaDefaultEstimate)===void 0){const R=Math.min(x,this.hls.config.abrEwmaDefaultEstimateMax);R>S&&S===mg.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=R)}break}const y=a&&!i,T={levels:f,audioTracks:l,subtitleTracks:u,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:a,video:i,altAudio:!y&&l.some(v=>!!v.url)};this.hls.trigger(L.MANIFEST_PARSED,T),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}get levels(){return this._levels.length===0?null:this._levels}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(t.length===0)return;if(e<0||e>=t.length){const p=new Error("invalid level idx"),m=e<0;if(this.hls.trigger(L.ERROR,{type:Le.OTHER_ERROR,details:G.LEVEL_SWITCH_ERROR,level:e,fatal:m,error:p,reason:p.message}),m)return;e=Math.min(e,t.length-1)}const n=this.currentLevelIndex,i=this.currentLevel,a=i?i.attrs["PATHWAY-ID"]:void 0,l=t[e],u=l.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=l,n===e&&l.details&&i&&a===u)return;this.log(`Switching to level ${e} (${l.height?l.height+"p ":""}${l.videoRange?l.videoRange+" ":""}${l.codecSet?l.codecSet+" ":""}@${l.bitrate})${u?" with Pathway "+u:""} from level ${n}${a?" with Pathway "+a:""}`);const f={level:e,attrs:l.attrs,details:l.details,bitrate:l.bitrate,averageBitrate:l.averageBitrate,maxBitrate:l.maxBitrate,realBitrate:l.realBitrate,width:l.width,height:l.height,codecSet:l.codecSet,audioCodec:l.audioCodec,videoCodec:l.videoCodec,audioGroups:l.audioGroups,subtitleGroups:l.subtitleGroups,loaded:l.loaded,loadError:l.loadError,fragmentError:l.fragmentError,name:l.name,id:l.id,uri:l.uri,url:l.url,urlId:0,audioGroupIds:l.audioGroupIds,textGroupIds:l.textGroupIds};this.hls.trigger(L.LEVEL_SWITCHING,f);const d=l.details;if(!d||d.live){const p=this.switchParams(l.uri,i==null?void 0:i.details,d);this.loadPlaylist(p)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){const e=this.hls.config.startLevel;return e!==void 0?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}onError(e,t){t.fatal||!t.context||t.context.type===De.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,{frag:t}){if(t!==void 0&&t.type===Te.MAIN){const n=t.elementaryStreams;if(!Object.keys(n).some(a=>!!n[a]))return;const i=this._levels[t.level];i!=null&&i.loadError&&(this.log(`Resetting level error count of ${i.loadError} on frag buffered`),i.loadError=0)}}onLevelLoaded(e,t){var n;const{level:i,details:a}=t,l=this._levels[i];if(!l){var u;this.warn(`Invalid level index ${i}`),(u=t.deliveryDirectives)!=null&&u.skip&&(a.deltaUpdateFailed=!0);return}i===this.currentLevelIndex?(l.fragmentError===0&&(l.loadError=0),this.playlistLoaded(i,t,l.details)):(n=t.deliveryDirectives)!=null&&n.skip&&(a.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist();const t=this.currentLevelIndex,n=this.currentLevel;if(n&&this.shouldLoadPlaylist(n)){let i=n.uri;if(e)try{i=e.addDirectives(i)}catch(l){this.warn(`Could not construct new URL with HLS Delivery Directives: ${l}`)}const a=n.attrs["PATHWAY-ID"];this.log(`Loading level index ${t}${(e==null?void 0:e.msn)!==void 0?" at sn "+e.msn+" part "+e.part:""} with${a?" Pathway "+a:""} ${i}`),this.clearTimer(),this.hls.trigger(L.LEVEL_LOADING,{url:i,level:t,pathwayId:n.attrs["PATHWAY-ID"],id:0,deliveryDirectives:e||null})}}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;const n=this._levels.filter((i,a)=>a!==e?!0:(this.steering&&this.steering.removeLevel(i),i===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,i.details&&i.details.fragments.forEach(l=>l.level=-1)),!1));_m(n),this._levels=n,this.currentLevelIndex>-1&&(t=this.currentLevel)!=null&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.hls.trigger(L.LEVELS_UPDATED,{levels:n})}onLevelsUpdated(e,{levels:t}){this._levels=t}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:n}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger(L.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:n}))}}function Mp(o){const e={};o.forEach(t=>{const n=t.groupId||"";t.id=e[n]=e[n]||0,e[n]++})}class cL{constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const n in this.keyUriToKeyInfo){const i=this.keyUriToKeyInfo[n].loader;if(i){var t;if(e&&e!==((t=i.context)==null?void 0:t.frag.type))return;i.abort()}}}detach(){for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e,t=G.KEY_LOAD_ERROR,n,i,a){return new wn({type:Le.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:a,error:n,networkDetails:i})}loadClear(e,t){if(this.emeController&&this.config.emeEnabled){const{sn:n,cc:i}=e;for(let a=0;a<t.length;a++){const l=t[a];if(i<=l.cc&&(n==="initSegment"||l.sn==="initSegment"||n<l.sn)){this.emeController.selectKeySystemFormat(l).then(u=>{l.setKeyFormat(u)});break}}}}load(e){return!e.decryptdata&&e.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var n,i;t&&e.setKeyFormat(t);const a=e.decryptdata;if(!a){const d=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,G.KEY_LOAD_ERROR,d))}const l=a.uri;if(!l)return Promise.reject(this.createKeyLoadError(e,G.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${l}"`)));let u=this.keyUriToKeyInfo[l];if((n=u)!=null&&n.decryptdata.key)return a.key=u.decryptdata.key,Promise.resolve({frag:e,keyInfo:u});if((i=u)!=null&&i.keyLoadPromise){var f;switch((f=u.mediaKeySessionContext)==null?void 0:f.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return u.keyLoadPromise.then(d=>(a.key=d.keyInfo.decryptdata.key,{frag:e,keyInfo:u}))}}switch(u=this.keyUriToKeyInfo[l]={decryptdata:a,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},a.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return a.keyFormat==="identity"?this.loadKeyHTTP(u,e):this.loadKeyEME(u,e);case"AES-128":return this.loadKeyHTTP(u,e);default:return Promise.reject(this.createKeyLoadError(e,G.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${a.method}"`)))}}loadKeyEME(e,t){const n={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const i=this.emeController.loadKey(n);if(i)return(e.keyLoadPromise=i.then(a=>(e.mediaKeySessionContext=a,n))).catch(a=>{throw e.keyLoadPromise=null,a})}return Promise.resolve(n)}loadKeyHTTP(e,t){const n=this.config,i=n.loader,a=new i(n);return t.keyLoader=e.loader=a,e.keyLoadPromise=new Promise((l,u)=>{const f={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},d=n.keyLoadPolicy.default,p={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},m={onSuccess:(y,T,v,x)=>{const{frag:S,keyInfo:R,url:I}=v;if(!S.decryptdata||R!==this.keyUriToKeyInfo[I])return u(this.createKeyLoadError(S,G.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),x));R.decryptdata.key=S.decryptdata.key=new Uint8Array(y.data),S.keyLoader=null,R.loader=null,l({frag:S,keyInfo:R})},onError:(y,T,v,x)=>{this.resetLoader(T),u(this.createKeyLoadError(t,G.KEY_LOAD_ERROR,new Error(`HTTP Error ${y.code} loading key ${y.text}`),v,lt({url:f.url,data:void 0},y)))},onTimeout:(y,T,v)=>{this.resetLoader(T),u(this.createKeyLoadError(t,G.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),v))},onAbort:(y,T,v)=>{this.resetLoader(T),u(this.createKeyLoadError(t,G.INTERNAL_ABORTED,new Error("key loading aborted"),v))}};a.load(f,p,m)})}resetLoader(e){const{frag:t,keyInfo:n,url:i}=e,a=n.loader;t.keyLoader===a&&(t.keyLoader=null,n.loader=null),delete this.keyUriToKeyInfo[i],a&&a.destroy()}}function gg(){return self.SourceBuffer||self.WebKitSourceBuffer}function yg(){if(!vr())return!1;const e=gg();return!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function"}function fL(){if(!yg())return!1;const o=vr();return typeof(o==null?void 0:o.isTypeSupported)=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(e=>o.isTypeSupported(es(e,"video")))||["mp4a.40.2","fLaC"].some(e=>o.isTypeSupported(es(e,"audio"))))}function dL(){var o;const e=gg();return typeof(e==null||(o=e.prototype)==null?void 0:o.changeType)=="function"}const hL=250,Ga=2,pL=.1,mL=.05;class gL{constructor(e,t,n,i){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=e,this.media=t,this.fragmentTracker=n,this.hls=i}destroy(){this.media=null,this.hls=this.fragmentTracker=null}poll(e,t){const{config:n,media:i,stalled:a}=this;if(i===null)return;const{currentTime:l,seeking:u}=i,f=this.seeking&&!u,d=!this.seeking&&u;if(this.seeking=u,l!==e){if(this.moved=!0,u||(this.nudgeRetry=0),a!==null){if(this.stallReported){const S=self.performance.now()-a;O.warn(`playback not stuck anymore @${l}, after ${Math.round(S)}ms`),this.stallReported=!1}this.stalled=null}return}if(d||f){this.stalled=null;return}if(i.paused&&!u||i.ended||i.playbackRate===0||!Ue.getBuffered(i).length){this.nudgeRetry=0;return}const p=Ue.bufferInfo(i,l,0),m=p.nextStart||0;if(u){const S=p.len>Ga,R=!m||t&&t.start<=l||m-l>Ga&&!this.fragmentTracker.getPartialFragment(l);if(S||R)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var y;if(!(p.len>0)&&!m)return;const R=Math.max(m,p.start||0)-l,I=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,b=(I==null||(y=I.details)==null?void 0:y.live)?I.details.targetduration*2:Ga,_=this.fragmentTracker.getPartialFragment(l);if(R>0&&(R<=b||_)){i.paused||this._trySkipBufferHole(_);return}}const T=self.performance.now();if(a===null){this.stalled=T;return}const v=T-a;if(!u&&v>=hL&&(this._reportStall(p),!this.media))return;const x=Ue.bufferInfo(i,l,n.maxBufferHole);this._tryFixBufferStall(x,v)}_tryFixBufferStall(e,t){const{config:n,fragmentTracker:i,media:a}=this;if(a===null)return;const l=a.currentTime,u=i.getPartialFragment(l);u&&(this._trySkipBufferHole(u)||!this.media)||(e.len>n.maxBufferHole||e.nextStart&&e.nextStart-l<n.maxBufferHole)&&t>n.highBufferWatchdogPeriod*1e3&&(O.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}_reportStall(e){const{hls:t,media:n,stallReported:i}=this;if(!i&&n){this.stallReported=!0;const a=new Error(`Playback stalling at @${n.currentTime} due to low buffer (${JSON.stringify(e)})`);O.warn(a.message),t.trigger(L.ERROR,{type:Le.MEDIA_ERROR,details:G.BUFFER_STALLED_ERROR,fatal:!1,error:a,buffer:e.len})}}_trySkipBufferHole(e){const{config:t,hls:n,media:i}=this;if(i===null)return 0;const a=i.currentTime,l=Ue.bufferInfo(i,a,0),u=a<l.start?l.start:l.nextStart;if(u){const f=l.len<=t.maxBufferHole,d=l.len>0&&l.len<1&&i.readyState<3,p=u-a;if(p>0&&(f||d)){if(p>t.maxBufferHole){const{fragmentTracker:y}=this;let T=!1;if(a===0){const v=y.getAppendedFrag(0,Te.MAIN);v&&u<v.end&&(T=!0)}if(!T){const v=e||y.getAppendedFrag(a,Te.MAIN);if(v){let x=!1,S=v.end;for(;S<u;){const R=y.getPartialFragment(S);if(R)S+=R.duration;else{x=!0;break}}if(x)return 0}}}const m=Math.max(u+mL,a+pL);if(O.warn(`skipping hole, adjusting currentTime from ${a} to ${m}`),this.moved=!0,this.stalled=null,i.currentTime=m,e&&!e.gap){const y=new Error(`fragment loaded with buffer holes, seeking from ${a} to ${m}`);n.trigger(L.ERROR,{type:Le.MEDIA_ERROR,details:G.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:y,reason:y.message,frag:e})}return m}}return 0}_tryNudgeBuffer(){const{config:e,hls:t,media:n,nudgeRetry:i}=this;if(n===null)return;const a=n.currentTime;if(this.nudgeRetry++,i<e.nudgeMaxRetry){const l=a+(i+1)*e.nudgeOffset,u=new Error(`Nudging 'currentTime' from ${a} to ${l}`);O.warn(u.message),n.currentTime=l,t.trigger(L.ERROR,{type:Le.MEDIA_ERROR,details:G.BUFFER_NUDGE_ON_STALL,error:u,fatal:!1})}else{const l=new Error(`Playhead still not moving while enough data buffered @${a} after ${e.nudgeMaxRetry} nudges`);O.error(l.message),t.trigger(L.ERROR,{type:Le.MEDIA_ERROR,details:G.BUFFER_STALLED_ERROR,error:l,fatal:!0})}}}const yL=100;class EL extends Ec{constructor(e,t,n){super(e,t,n,"[stream-controller]",Te.MAIN),this.audioCodecSwap=!1,this.gapController=null,this.level=-1,this._forceStartLoad=!1,this.altAudio=!1,this.audioOnly=!1,this.fragPlaying=null,this.onvplaying=null,this.onvseeked=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.MANIFEST_PARSED,this.onManifestParsed,this),e.on(L.LEVEL_LOADING,this.onLevelLoading,this),e.on(L.LEVEL_LOADED,this.onLevelLoaded,this),e.on(L.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(L.ERROR,this.onError,this),e.on(L.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(L.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(L.BUFFER_CREATED,this.onBufferCreated,this),e.on(L.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(L.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(L.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.MANIFEST_PARSED,this.onManifestParsed,this),e.off(L.LEVEL_LOADED,this.onLevelLoaded,this),e.off(L.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(L.ERROR,this.onError,this),e.off(L.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(L.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(L.BUFFER_CREATED,this.onBufferCreated,this),e.off(L.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(L.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(L.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying()}startLoad(e){if(this.levels){const{lastCurrentTime:t,hls:n}=this;if(this.stopLoad(),this.setInterval(yL),this.level=-1,!this.startFragRequested){let i=n.startLevel;i===-1&&(n.config.testBandwidth&&this.levels.length>1?(i=0,this.bitrateTest=!0):i=n.firstAutoLevel),n.nextLoadLevel=i,this.level=n.loadLevel,this.loadedmetadata=!1}t>0&&e===-1&&(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t),this.state=Y.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this._forceStartLoad=!0,this.state=Y.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case Y.WAITING_LEVEL:{const{levels:t,level:n}=this,i=t==null?void 0:t[n],a=i==null?void 0:i.details;if(a&&(!a.live||this.levelLastLoaded===i)){if(this.waitForCdnTuneIn(a))break;this.state=Y.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=Y.IDLE;break}break}case Y.FRAG_LOADING_WAITING_RETRY:{var e;const t=self.performance.now(),n=this.retryDate;if(!n||t>=n||(e=this.media)!=null&&e.seeking){const{levels:i,level:a}=this,l=i==null?void 0:i[a];this.resetStartWhenNotLoaded(l||null),this.state=Y.IDLE}}break}this.state===Y.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){super.onTickEnd(),this.checkBuffer(),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:n,media:i}=this;if(t===null||!i&&(this.startFragRequested||!e.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const a=this.buffering?e.nextLoadLevel:e.loadLevel;if(!(n!=null&&n[a]))return;const l=n[a],u=this.getMainFwdBufferInfo();if(u===null)return;const f=this.getLevelDetails();if(f&&this._streamEnded(u,f)){const x={};this.altAudio&&(x.type="video"),this.hls.trigger(L.BUFFER_EOS,x),this.state=Y.ENDED;return}if(!this.buffering)return;e.loadLevel!==a&&e.manualLevel===-1&&this.log(`Adapting to level ${a} from level ${this.level}`),this.level=e.nextLoadLevel=a;const d=l.details;if(!d||this.state===Y.WAITING_LEVEL||d.live&&this.levelLastLoaded!==l){this.level=a,this.state=Y.WAITING_LEVEL;return}const p=u.len,m=this.getMaxBufferLength(l.maxBitrate);if(p>=m)return;this.backtrackFragment&&this.backtrackFragment.start>u.end&&(this.backtrackFragment=null);const y=this.backtrackFragment?this.backtrackFragment.start:u.end;let T=this.getNextFragment(y,d);if(this.couldBacktrack&&!this.fragPrevious&&T&&T.sn!=="initSegment"&&this.fragmentTracker.getState(T)!==ot.OK){var v;const S=((v=this.backtrackFragment)!=null?v:T).sn-d.startSN,R=d.fragments[S-1];R&&T.cc===R.cc&&(T=R,this.fragmentTracker.removeFragment(R))}else this.backtrackFragment&&u.len&&(this.backtrackFragment=null);if(T&&this.isLoopLoading(T,y)){if(!T.gap){const S=this.audioOnly&&!this.altAudio?Fe.AUDIO:Fe.VIDEO,R=(S===Fe.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;R&&this.afterBufferFlushed(R,S,Te.MAIN)}T=this.getNextFragmentLoopLoading(T,d,u,Te.MAIN,m)}T&&(T.initSegment&&!T.initSegment.data&&!this.bitrateTest&&(T=T.initSegment),this.loadFragment(T,l,y))}loadFragment(e,t,n){const i=this.fragmentTracker.getState(e);this.fragCurrent=e,i===ot.NOT_LOADED||i===ot.PARTIAL?e.sn==="initSegment"?this._loadInitSegment(e,t):this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):(this.startFragRequested=!0,super.loadFragment(e,t,n)):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,Te.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(t!=null&&t.readyState){let n;const i=this.getAppendedFrag(t.currentTime);i&&i.start>1&&this.flushMainBuffer(0,i.start-1);const a=this.getLevelDetails();if(a!=null&&a.live){const u=this.getMainFwdBufferInfo();if(!u||u.len<a.targetduration*2)return}if(!t.paused&&e){const u=this.hls.nextLoadLevel,f=e[u],d=this.fragLastKbps;d&&this.fragCurrent?n=this.fragCurrent.duration*f.maxBitrate/(1e3*d)+1:n=0}else n=0;const l=this.getBufferedFrag(t.currentTime+n);if(l){const u=this.followingBufferedFrag(l);if(u){this.abortCurrentFrag();const f=u.maxStartPTS?u.maxStartPTS:u.start,d=u.duration,p=Math.max(l.end,f+Math.min(Math.max(d-this.config.maxFragLookUpTolerance,d*(this.couldBacktrack?.5:.125)),d*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(p,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case Y.KEY_LOADING:case Y.FRAG_LOADING:case Y.FRAG_LOADING_WAITING_RETRY:case Y.PARSING:case Y.PARSED:this.state=Y.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const n=t.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),n.addEventListener("playing",this.onvplaying),n.addEventListener("seeked",this.onvseeked),this.gapController=new gL(this.config,n,this.fragmentTracker,this.hls)}onMediaDetaching(){const{media:e}=this;e&&this.onvplaying&&this.onvseeked&&(e.removeEventListener("playing",this.onvplaying),e.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){const e=this.media,t=e?e.currentTime:null;oe(t)&&this.log(`Media seeked to ${t.toFixed(3)}`);const n=this.getMainFwdBufferInfo();if(n===null||n.len===0){this.warn(`Main forward buffer length on "seeked" event ${n?n.len:"empty"})`);return}this.tick()}onManifestLoading(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(L.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=this.fragLastKbps=0,this.levels=this.fragPlaying=this.backtrackFragment=this.levelLastLoaded=null,this.altAudio=this.audioOnly=this.startFragRequested=!1}onManifestParsed(e,t){let n=!1,i=!1;t.levels.forEach(a=>{const l=a.audioCodec;l&&(n=n||l.indexOf("mp4a.40.2")!==-1,i=i||l.indexOf("mp4a.40.5")!==-1)}),this.audioCodecSwitch=n&&i&&!dL(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:n}=this;if(!n||this.state!==Y.IDLE)return;const i=n[t.level];(!i.details||i.details.live&&this.levelLastLoaded!==i||this.waitForCdnTuneIn(i.details))&&(this.state=Y.WAITING_LEVEL)}onLevelLoaded(e,t){var n;const{levels:i}=this,a=t.level,l=t.details,u=l.totalduration;if(!i){this.warn(`Levels were reset while loading level ${a}`);return}this.log(`Level ${a} loaded [${l.startSN},${l.endSN}]${l.lastPartSn?`[part-${l.lastPartSn}-${l.lastPartIndex}]`:""}, cc [${l.startCC}, ${l.endCC}] duration:${u}`);const f=i[a],d=this.fragCurrent;d&&(this.state===Y.FRAG_LOADING||this.state===Y.FRAG_LOADING_WAITING_RETRY)&&d.level!==t.level&&d.loader&&this.abortCurrentFrag();let p=0;if(l.live||(n=f.details)!=null&&n.live){var m;if(this.checkLiveUpdate(l),l.deltaUpdateFailed)return;p=this.alignPlaylists(l,f.details,(m=this.levelLastLoaded)==null?void 0:m.details)}if(f.details=l,this.levelLastLoaded=f,this.hls.trigger(L.LEVEL_UPDATED,{details:l,level:a}),this.state===Y.WAITING_LEVEL){if(this.waitForCdnTuneIn(l))return;this.state=Y.IDLE}this.startFragRequested?l.live&&this.synchronizeToLiveEdge(l):this.setStartPosition(l,p),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:n,part:i,payload:a}=e,{levels:l}=this;if(!l){this.warn(`Levels were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}const u=l[n.level],f=u.details;if(!f){this.warn(`Dropping fragment ${n.sn} of level ${n.level} after level details were reset`),this.fragmentTracker.removeFragment(n);return}const d=u.videoCodec,p=f.PTSKnown||!f.live,m=(t=n.initSegment)==null?void 0:t.data,y=this._getAudioCodec(u),T=this.transmuxer=this.transmuxer||new Qm(this.hls,Te.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),v=i?i.index:-1,x=v!==-1,S=new gc(n.level,n.sn,n.stats.chunkCount,a.byteLength,v,x),R=this.initPTS[n.cc];T.push(a,m,y,d,n,i,f.totalduration,p,S,R)}onAudioTrackSwitching(e,t){const n=this.altAudio;if(!!!t.url){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const l=this.fragCurrent;l&&(this.log("Switching to main audio track, cancel main fragment load"),l.abortRequests(),this.fragmentTracker.removeFragment(l)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();const a=this.hls;n&&(a.trigger(L.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),a.trigger(L.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const n=t.id,i=!!this.hls.audioTracks[n].url;if(i){const a=this.videoBuffer;a&&this.mediaBuffer!==a&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=a)}this.altAudio=i,this.tick()}onBufferCreated(e,t){const n=t.tracks;let i,a,l=!1;for(const u in n){const f=n[u];if(f.id==="main"){if(a=u,i=f,u==="video"){const d=n[u];d&&(this.videoBuffer=d.buffer)}}else l=!0}l&&i?(this.log(`Alternate track found, use ${a}.buffered to schedule main fragment loading`),this.mediaBuffer=i.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:n,part:i}=t;if(n&&n.type!==Te.MAIN)return;if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${i?" p: "+i.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}`),this.state===Y.PARSED&&(this.state=Y.IDLE);return}const a=i?i.stats:n.stats;this.fragLastKbps=Math.round(8*a.total/(a.buffering.end-a.loading.first)),n.sn!=="initSegment"&&(this.fragPrevious=n),this.fragBufferedComplete(n,i)}onError(e,t){var n;if(t.fatal){this.state=Y.ERROR;return}switch(t.details){case G.FRAG_GAP:case G.FRAG_PARSING_ERROR:case G.FRAG_DECRYPT_ERROR:case G.FRAG_LOAD_ERROR:case G.FRAG_LOAD_TIMEOUT:case G.KEY_LOAD_ERROR:case G.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Te.MAIN,t);break;case G.LEVEL_LOAD_ERROR:case G.LEVEL_LOAD_TIMEOUT:case G.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===Y.WAITING_LEVEL&&((n=t.context)==null?void 0:n.type)===De.LEVEL&&(this.state=Y.IDLE);break;case G.BUFFER_APPEND_ERROR:case G.BUFFER_FULL_ERROR:if(!t.parent||t.parent!=="main")return;if(t.details===G.BUFFER_APPEND_ERROR){this.resetLoadingState();return}this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case G.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}checkBuffer(){const{media:e,gapController:t}=this;if(!(!e||!t||!e.readyState)){if(this.loadedmetadata||!Ue.getBuffered(e).length){const n=this.state!==Y.IDLE?this.fragCurrent:null;t.poll(this.lastCurrentTime,n)}this.lastCurrentTime=e.currentTime}}onFragLoadEmergencyAborted(){this.state=Y.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==Fe.AUDIO||this.audioOnly&&!this.altAudio){const n=(t===Fe.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(n,t,Te.MAIN),this.tick()}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let n=this.startPosition;if(n>=0&&t<n){if(e.seeking){this.log(`could not seek to ${n}, already seeking at ${t}`);return}const i=Ue.getBuffered(e),l=(i.length?i.start(0):0)-n;l>0&&(l<this.config.maxBufferHole||l<this.config.maxFragLookUpTolerance)&&(this.log(`adjusting start position by ${l} to match buffer start`),n+=l,this.startPosition=n),this.log(`seek to target start position ${n} from current time ${t}`),e.currentTime=n}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t.indexOf("mp4a.40.5")!==-1?t="mp4a.40.2":t="mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(n=>{const{hls:i}=this;if(!n||this.fragContextChanged(e))return;t.fragmentError=0,this.state=Y.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const a=e.stats;a.parsing.start=a.parsing.end=a.buffering.start=a.buffering.end=self.performance.now(),i.trigger(L.FRAG_LOADED,n),e.bitrateTest=!1})}_handleTransmuxComplete(e){var t;const n="main",{hls:i}=this,{remuxResult:a,chunkMeta:l}=e,u=this.getCurrentContext(l);if(!u){this.resetWhenMissingContext(l);return}const{frag:f,part:d,level:p}=u,{video:m,text:y,id3:T,initSegment:v}=a,{details:x}=p,S=this.altAudio?void 0:a.audio;if(this.fragContextChanged(f)){this.fragmentTracker.removeFragment(f);return}if(this.state=Y.PARSING,v){if(v!=null&&v.tracks){const w=f.initSegment||f;this._bufferInitSegment(p,v.tracks,w,l),i.trigger(L.FRAG_PARSING_INIT_SEGMENT,{frag:w,id:n,tracks:v.tracks})}const R=v.initPTS,I=v.timescale;oe(R)&&(this.initPTS[f.cc]={baseTime:R,timescale:I},i.trigger(L.INIT_PTS_FOUND,{frag:f,id:n,initPTS:R,timescale:I}))}if(m&&x&&f.sn!=="initSegment"){const R=x.fragments[f.sn-1-x.startSN],I=f.sn===x.startSN,w=!R||f.cc>R.cc;if(a.independent!==!1){const{startPTS:b,endPTS:_,startDTS:K,endDTS:U}=m;if(d)d.elementaryStreams[m.type]={startPTS:b,endPTS:_,startDTS:K,endDTS:U};else if(m.firstKeyFrame&&m.independent&&l.id===1&&!w&&(this.couldBacktrack=!0),m.dropped&&m.independent){const z=this.getMainFwdBufferInfo(),ee=(z?z.end:this.getLoadPosition())+this.config.maxBufferHole,V=m.firstKeyFramePTS?m.firstKeyFramePTS:b;if(!I&&ee<V-this.config.maxBufferHole&&!w){this.backtrack(f);return}else w&&(f.gap=!0);f.setElementaryStreamInfo(m.type,f.start,_,f.start,U,!0)}else I&&b>Ga&&(f.gap=!0);f.setElementaryStreamInfo(m.type,b,_,K,U),this.backtrackFragment&&(this.backtrackFragment=f),this.bufferFragmentData(m,f,d,l,I||w)}else if(I||w)f.gap=!0;else{this.backtrack(f);return}}if(S){const{startPTS:R,endPTS:I,startDTS:w,endDTS:b}=S;d&&(d.elementaryStreams[Fe.AUDIO]={startPTS:R,endPTS:I,startDTS:w,endDTS:b}),f.setElementaryStreamInfo(Fe.AUDIO,R,I,w,b),this.bufferFragmentData(S,f,d,l)}if(x&&T!=null&&(t=T.samples)!=null&&t.length){const R={id:n,frag:f,details:x,samples:T.samples};i.trigger(L.FRAG_PARSING_METADATA,R)}if(x&&y){const R={id:n,frag:f,details:x,samples:y.samples};i.trigger(L.FRAG_PARSING_USERDATA,R)}}_bufferInitSegment(e,t,n,i){if(this.state!==Y.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&delete t.audio;const{audio:a,video:l,audiovideo:u}=t;if(a){let f=e.audioCodec;const d=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){f&&(f.indexOf("mp4a.40.5")!==-1?f="mp4a.40.2":f="mp4a.40.5");const p=a.metadata;p&&"channelCount"in p&&(p.channelCount||1)!==1&&d.indexOf("firefox")===-1&&(f="mp4a.40.5")}f&&f.indexOf("mp4a.40.5")!==-1&&d.indexOf("android")!==-1&&a.container!=="audio/mpeg"&&(f="mp4a.40.2",this.log(`Android: force audio codec to ${f}`)),e.audioCodec&&e.audioCodec!==f&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${f}"`),a.levelCodec=f,a.id="main",this.log(`Init audio buffer, container:${a.container}, codecs[selected/level/parsed]=[${f||""}/${e.audioCodec||""}/${a.codec}]`)}l&&(l.levelCodec=e.videoCodec,l.id="main",this.log(`Init video buffer, container:${l.container}, codecs[level/parsed]=[${e.videoCodec||""}/${l.codec}]`)),u&&this.log(`Init audiovideo buffer, container:${u.container}, codecs[level/parsed]=[${e.codecs}/${u.codec}]`),this.hls.trigger(L.BUFFER_CODECS,t),Object.keys(t).forEach(f=>{const p=t[f].initSegment;p!=null&&p.byteLength&&this.hls.trigger(L.BUFFER_APPENDING,{type:f,data:p,frag:n,part:null,chunkMeta:i,parent:n.type})}),this.tickImmediate()}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,Te.MAIN)}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=Y.IDLE}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&e.seeking===!1){const n=e.currentTime;if(Ue.isBuffered(e,n)?t=this.getAppendedFrag(n):Ue.isBuffered(e,n+.1)&&(t=this.getAppendedFrag(n+.1)),t){this.backtrackFragment=null;const i=this.fragPlaying,a=t.level;(!i||t.sn!==i.sn||i.level!==a)&&(this.fragPlaying=t,this.hls.trigger(L.FRAG_CHANGED,{frag:t}),(!i||i.level!==a)&&this.hls.trigger(L.LEVEL_SWITCHED,{level:a}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){const e=this.media;return e?this.fragPlaying||this.getAppendedFrag(e.currentTime):null}get currentProgramDateTime(){const e=this.media;if(e){const t=e.currentTime,n=this.currentFrag;if(n&&oe(t)&&oe(n.programDateTime)){const i=n.programDateTime+(t-n.start)*1e3;return new Date(i)}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class cn{static get version(){return"1.5.20"}static isMSESupported(){return yg()}static isSupported(){return fL()}static getMediaSource(){return vr()}static get Events(){return L}static get ErrorTypes(){return Le}static get ErrorDetails(){return G}static get DefaultConfig(){return cn.defaultConfig?cn.defaultConfig:mg}static set DefaultConfig(e){cn.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this.started=!1,this._emitter=new Lc,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,this.triggeringException=void 0,av(e.debug||!1,"Hls instance");const t=this.config=oL(cn.DefaultConfig,e);this.userConfig=e,t.progressive&&lL(t);const{abrController:n,bufferController:i,capLevelController:a,errorController:l,fpsController:u}=t,f=new l(this),d=this.abrController=new n(this),p=this.bufferController=new i(this),m=this.capLevelController=new a(this),y=new u(this),T=new eT(this),v=new sT(this),x=t.contentSteeringController,S=x?new x(this):null,R=this.levelController=new uL(this,S),I=new OT(this),w=new cL(this.config),b=this.streamController=new EL(this,I,w);m.setStreamController(b),y.setStreamController(b);const _=[T,R,b];S&&_.splice(1,0,S),this.networkControllers=_;const K=[d,p,m,y,v,I];this.audioTrackController=this.createController(t.audioTrackController,_);const U=t.audioStreamController;U&&_.push(new U(this,I,w)),this.subtitleTrackController=this.createController(t.subtitleTrackController,_);const z=t.subtitleStreamController;z&&_.push(new z(this,I,w)),this.createController(t.timelineController,K),w.emeController=this.emeController=this.createController(t.emeController,K),this.cmcdController=this.createController(t.cmcdController,K),this.latencyController=this.createController(aT,K),this.coreComponents=K,_.push(f);const ee=f.onErrorOut;typeof ee=="function"&&this.on(L.ERROR,ee,f)}createController(e,t){if(e){const n=new e(this);return t&&t.push(n),n}return null}on(e,t,n=this){this._emitter.on(e,t,n)}once(e,t,n=this){this._emitter.once(e,t,n)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,n=this,i){this._emitter.off(e,t,n,i)}listeners(e){return this._emitter.listeners(e)}emit(e,t,n){return this._emitter.emit(e,t,n)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(n){if(O.error("An internal error happened while handling event "+e+'. Error message: "'+n.message+'". Here is a stacktrace:',n),!this.triggeringException){this.triggeringException=!0;const i=e===L.ERROR;this.trigger(L.ERROR,{type:Le.OTHER_ERROR,details:G.INTERNAL_EXCEPTION,fatal:i,event:e,error:n}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){O.log("destroy"),this.trigger(L.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(t=>t.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(t=>t.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){O.log("attachMedia"),this._media=e,this.trigger(L.MEDIA_ATTACHING,{media:e})}detachMedia(){O.log("detachMedia"),this.trigger(L.MEDIA_DETACHING,void 0),this._media=null}loadSource(e){this.stopLoad();const t=this.media,n=this.url,i=this.url=cc.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,O.log(`loadSource:${i}`),t&&n&&(n!==i||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(L.MANIFEST_LOADING,{url:e})}startLoad(e=-1){O.log(`startLoad(${e})`),this.started=!0,this.resumeBuffering();for(let t=0;t<this.networkControllers.length&&(this.networkControllers[t].startLoad(e),!(!this.started||!this.networkControllers));t++);}stopLoad(){O.log("stopLoad"),this.started=!1;for(let e=0;e<this.networkControllers.length&&(this.networkControllers[e].stopLoad(),!(this.started||!this.networkControllers));e++);}resumeBuffering(){O.log("resume buffering"),this.networkControllers.forEach(e=>{e.resumeBuffering&&e.resumeBuffering()})}pauseBuffering(){O.log("pause buffering"),this.networkControllers.forEach(e=>{e.pauseBuffering&&e.pauseBuffering()})}swapAudioCodec(){O.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){O.log("recoverMediaError");const e=this._media;this.detachMedia(),e&&this.attachMedia(e)}removeLevel(e){this.levelController.removeLevel(e)}get levels(){const e=this.levelController.levels;return e||[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){O.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){O.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){O.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){O.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return e===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){O.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(O.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){oT(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const n=e.length;for(let i=0;i<n;i++)if(e[i].maxBitrate>=t)return i;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:n}=this;let i;if(t===-1&&e!=null&&e.length?i=e.length-1:i=t,n)for(let a=i;a--;){const l=e[a].attrs["HDCP-LEVEL"];if(l&&l<=n)return a}return i}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}setAudioOption(e){var t;return(t=this.audioTrackController)==null?void 0:t.setAudioOption(e)}setSubtitleOption(e){var t;return(t=this.subtitleTrackController)==null||t.setSubtitleOption(e),null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}}cn.defaultConfig=void 0;const vL=()=>{const[o,e]=j.useState([]),[t,n]=j.useState(!0),i=j.useRef(null);let a=null;j.useEffect(()=>(fetch("playlist.m3u").then(f=>f.text()).then(f=>{var m;const d=f.split(`
`),p=[];for(let y=0;y<d.length;y++){const T=d[y].trim();if(T.startsWith("#EXTINF")){const v=T.split(",")[1].trim(),x=(m=d[y+1])==null?void 0:m.trim();x&&x.startsWith("http")&&p.push({name:v,url:x})}}e(p),n(!1)}).catch(f=>{console.error("Fout bij het ophalen van het bestand:",f),n(!1)}),()=>{a&&a.destroy()}),[]);const l=u=>{if(a&&a.destroy(),cn.isSupported()){a=new cn;const f=`/api/proxy?url=${encodeURIComponent(u)}`;a.loadSource(f),a.attachMedia(i.current),a.on(cn.Events.MANIFEST_PARSED,function(){i.current.play()}),a.on(cn.Events.ERROR,function(d,p){console.error("Fout bij het laden van de stream:",p)})}else i.current.canPlayType("application/vnd.apple.mpegurl")&&(i.current.src=u,i.current.play())};return X.jsxs("div",{className:"iptv-container",children:[X.jsx("h1",{className:"iptv-title",children:" IPTV Player"}),X.jsx("div",{className:"channel-list",children:t?X.jsx("div",{className:"loading",children:"Kanalen worden geladen..."}):o.length>0?o.map((u,f)=>X.jsx("div",{className:"channel-item",onClick:()=>l(u.url),children:u.name},f)):X.jsx("div",{className:"no-channels",children:"Geen kanalen gevonden."})}),X.jsx("video",{ref:i,controls:!0,className:"video-player",children:"Je browser ondersteunt geen video-afspelen."})]})};var Du={exports:{}},_u,Up;function TL(){if(Up)return _u;Up=1;var o="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return _u=o,_u}var Pu,Bp;function xL(){if(Bp)return Pu;Bp=1;var o=TL();function e(){}function t(){}return t.resetWarningCache=e,Pu=function(){function n(l,u,f,d,p,m){if(m!==o){var y=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw y.name="Invariant Violation",y}}n.isRequired=n;function i(){return n}var a={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:i,element:n,elementType:n,instanceOf:i,node:n,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:t,resetWarningCache:e};return a.PropTypes=a,a},Pu}var $p;function SL(){return $p||($p=1,Du.exports=xL()()),Du.exports}var LL=SL();const Ve=rs(LL);var bu,Gp;function AL(){if(Gp)return bu;Gp=1;function o(u){return u&&typeof u=="object"&&"default"in u?u.default:u}var e=to(),t=o(e);function n(u,f,d){return f in u?Object.defineProperty(u,f,{value:d,enumerable:!0,configurable:!0,writable:!0}):u[f]=d,u}function i(u,f){u.prototype=Object.create(f.prototype),u.prototype.constructor=u,u.__proto__=f}var a=!!(typeof window<"u"&&window.document&&window.document.createElement);function l(u,f,d){if(typeof u!="function")throw new Error("Expected reducePropsToState to be a function.");if(typeof f!="function")throw new Error("Expected handleStateChangeOnClient to be a function.");if(typeof d<"u"&&typeof d!="function")throw new Error("Expected mapStateOnServer to either be undefined or a function.");function p(m){return m.displayName||m.name||"Component"}return function(y){if(typeof y!="function")throw new Error("Expected WrappedComponent to be a React component.");var T=[],v;function x(){v=u(T.map(function(R){return R.props})),S.canUseDOM?f(v):d&&(v=d(v))}var S=function(R){i(I,R);function I(){return R.apply(this,arguments)||this}I.peek=function(){return v},I.rewind=function(){if(I.canUseDOM)throw new Error("You may only call rewind() on the server. Call peek() to read the current state.");var _=v;return v=void 0,T=[],_};var w=I.prototype;return w.UNSAFE_componentWillMount=function(){T.push(this),x()},w.componentDidUpdate=function(){x()},w.componentWillUnmount=function(){var _=T.indexOf(this);T.splice(_,1),x()},w.render=function(){return t.createElement(y,this.props)},I}(e.PureComponent);return n(S,"displayName","SideEffect("+p(y)+")"),n(S,"canUseDOM",a),S}}return bu=l,bu}var RL=AL();const wL=rs(RL);var Ou,Hp;function CL(){if(Hp)return Ou;Hp=1;var o=typeof Element<"u",e=typeof Map=="function",t=typeof Set=="function",n=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function i(a,l){if(a===l)return!0;if(a&&l&&typeof a=="object"&&typeof l=="object"){if(a.constructor!==l.constructor)return!1;var u,f,d;if(Array.isArray(a)){if(u=a.length,u!=l.length)return!1;for(f=u;f--!==0;)if(!i(a[f],l[f]))return!1;return!0}var p;if(e&&a instanceof Map&&l instanceof Map){if(a.size!==l.size)return!1;for(p=a.entries();!(f=p.next()).done;)if(!l.has(f.value[0]))return!1;for(p=a.entries();!(f=p.next()).done;)if(!i(f.value[1],l.get(f.value[0])))return!1;return!0}if(t&&a instanceof Set&&l instanceof Set){if(a.size!==l.size)return!1;for(p=a.entries();!(f=p.next()).done;)if(!l.has(f.value[0]))return!1;return!0}if(n&&ArrayBuffer.isView(a)&&ArrayBuffer.isView(l)){if(u=a.length,u!=l.length)return!1;for(f=u;f--!==0;)if(a[f]!==l[f])return!1;return!0}if(a.constructor===RegExp)return a.source===l.source&&a.flags===l.flags;if(a.valueOf!==Object.prototype.valueOf&&typeof a.valueOf=="function"&&typeof l.valueOf=="function")return a.valueOf()===l.valueOf();if(a.toString!==Object.prototype.toString&&typeof a.toString=="function"&&typeof l.toString=="function")return a.toString()===l.toString();if(d=Object.keys(a),u=d.length,u!==Object.keys(l).length)return!1;for(f=u;f--!==0;)if(!Object.prototype.hasOwnProperty.call(l,d[f]))return!1;if(o&&a instanceof Element)return!1;for(f=u;f--!==0;)if(!((d[f]==="_owner"||d[f]==="__v"||d[f]==="__o")&&a.$$typeof)&&!i(a[d[f]],l[d[f]]))return!1;return!0}return a!==a&&l!==l}return Ou=function(l,u){try{return i(l,u)}catch(f){if((f.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw f}},Ou}var IL=CL();const kL=rs(IL);/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var Fu,Vp;function DL(){if(Vp)return Fu;Vp=1;var o=Object.getOwnPropertySymbols,e=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable;function n(a){if(a==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(a)}function i(){try{if(!Object.assign)return!1;var a=new String("abc");if(a[5]="de",Object.getOwnPropertyNames(a)[0]==="5")return!1;for(var l={},u=0;u<10;u++)l["_"+String.fromCharCode(u)]=u;var f=Object.getOwnPropertyNames(l).map(function(p){return l[p]});if(f.join("")!=="0123456789")return!1;var d={};return"abcdefghijklmnopqrst".split("").forEach(function(p){d[p]=p}),Object.keys(Object.assign({},d)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}return Fu=i()?Object.assign:function(a,l){for(var u,f=n(a),d,p=1;p<arguments.length;p++){u=Object(arguments[p]);for(var m in u)e.call(u,m)&&(f[m]=u[m]);if(o){d=o(u);for(var y=0;y<d.length;y++)t.call(u,d[y])&&(f[d[y]]=u[d[y]])}}return f},Fu}var _L=DL();const PL=rs(_L);var Er={BODY:"bodyAttributes",HTML:"htmlAttributes",TITLE:"titleAttributes"},we={BASE:"base",BODY:"body",HEAD:"head",HTML:"html",LINK:"link",META:"meta",NOSCRIPT:"noscript",SCRIPT:"script",STYLE:"style",TITLE:"title"};Object.keys(we).map(function(o){return we[o]});var Ke={CHARSET:"charset",CSS_TEXT:"cssText",HREF:"href",HTTPEQUIV:"http-equiv",INNER_HTML:"innerHTML",ITEM_PROP:"itemprop",NAME:"name",PROPERTY:"property",REL:"rel",SRC:"src",TARGET:"target"},eo={accesskey:"accessKey",charset:"charSet",class:"className",contenteditable:"contentEditable",contextmenu:"contextMenu","http-equiv":"httpEquiv",itemprop:"itemProp",tabindex:"tabIndex"},ns={DEFAULT_TITLE:"defaultTitle",DEFER:"defer",ENCODE_SPECIAL_CHARACTERS:"encodeSpecialCharacters",ON_CHANGE_CLIENT_STATE:"onChangeClientState",TITLE_TEMPLATE:"titleTemplate"},bL=Object.keys(eo).reduce(function(o,e){return o[eo[e]]=e,o},{}),OL=[we.NOSCRIPT,we.SCRIPT,we.STYLE],Jt="data-react-helmet",FL=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},NL=function(o,e){if(!(o instanceof e))throw new TypeError("Cannot call a class as a function")},ML=function(){function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}}(),wt=Object.assign||function(o){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(o[n]=t[n])}return o},UL=function(o,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);o.prototype=Object.create(e&&e.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(o,e):o.__proto__=e)},Kp=function(o,e){var t={};for(var n in o)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n]);return t},BL=function(o,e){if(!o)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:o},tc=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return t===!1?String(e):String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")},$L=function(e){var t=Jr(e,we.TITLE),n=Jr(e,ns.TITLE_TEMPLATE);if(n&&t)return n.replace(/%s/g,function(){return Array.isArray(t)?t.join(""):t});var i=Jr(e,ns.DEFAULT_TITLE);return t||i||void 0},GL=function(e){return Jr(e,ns.ON_CHANGE_CLIENT_STATE)||function(){}},Nu=function(e,t){return t.filter(function(n){return typeof n[e]<"u"}).map(function(n){return n[e]}).reduce(function(n,i){return wt({},n,i)},{})},HL=function(e,t){return t.filter(function(n){return typeof n[we.BASE]<"u"}).map(function(n){return n[we.BASE]}).reverse().reduce(function(n,i){if(!n.length)for(var a=Object.keys(i),l=0;l<a.length;l++){var u=a[l],f=u.toLowerCase();if(e.indexOf(f)!==-1&&i[f])return n.concat(i)}return n},[])},Wi=function(e,t,n){var i={};return n.filter(function(a){return Array.isArray(a[e])?!0:(typeof a[e]<"u"&&zL("Helmet: "+e+' should be of type "Array". Instead found type "'+FL(a[e])+'"'),!1)}).map(function(a){return a[e]}).reverse().reduce(function(a,l){var u={};l.filter(function(y){for(var T=void 0,v=Object.keys(y),x=0;x<v.length;x++){var S=v[x],R=S.toLowerCase();t.indexOf(R)!==-1&&!(T===Ke.REL&&y[T].toLowerCase()==="canonical")&&!(R===Ke.REL&&y[R].toLowerCase()==="stylesheet")&&(T=R),t.indexOf(S)!==-1&&(S===Ke.INNER_HTML||S===Ke.CSS_TEXT||S===Ke.ITEM_PROP)&&(T=S)}if(!T||!y[T])return!1;var I=y[T].toLowerCase();return i[T]||(i[T]={}),u[T]||(u[T]={}),i[T][I]?!1:(u[T][I]=!0,!0)}).reverse().forEach(function(y){return a.push(y)});for(var f=Object.keys(u),d=0;d<f.length;d++){var p=f[d],m=PL({},i[p],u[p]);i[p]=m}return a},[]).reverse()},Jr=function(e,t){for(var n=e.length-1;n>=0;n--){var i=e[n];if(i.hasOwnProperty(t))return i[t]}return null},VL=function(e){return{baseTag:HL([Ke.HREF,Ke.TARGET],e),bodyAttributes:Nu(Er.BODY,e),defer:Jr(e,ns.DEFER),encode:Jr(e,ns.ENCODE_SPECIAL_CHARACTERS),htmlAttributes:Nu(Er.HTML,e),linkTags:Wi(we.LINK,[Ke.REL,Ke.HREF],e),metaTags:Wi(we.META,[Ke.NAME,Ke.CHARSET,Ke.HTTPEQUIV,Ke.PROPERTY,Ke.ITEM_PROP],e),noscriptTags:Wi(we.NOSCRIPT,[Ke.INNER_HTML],e),onChangeClientState:GL(e),scriptTags:Wi(we.SCRIPT,[Ke.SRC,Ke.INNER_HTML],e),styleTags:Wi(we.STYLE,[Ke.CSS_TEXT],e),title:$L(e),titleAttributes:Nu(Er.TITLE,e)}},nc=function(){var o=Date.now();return function(e){var t=Date.now();t-o>16?(o=t,e(t)):setTimeout(function(){nc(e)},0)}}(),jp=function(e){return clearTimeout(e)},KL=typeof window<"u"?window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||nc:global.requestAnimationFrame||nc,jL=typeof window<"u"?window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||jp:global.cancelAnimationFrame||jp,zL=function(e){return console&&typeof console.warn=="function"&&console.warn(e)},Yi=null,WL=function(e){Yi&&jL(Yi),e.defer?Yi=KL(function(){zp(e,function(){Yi=null})}):(zp(e),Yi=null)},zp=function(e,t){var n=e.baseTag,i=e.bodyAttributes,a=e.htmlAttributes,l=e.linkTags,u=e.metaTags,f=e.noscriptTags,d=e.onChangeClientState,p=e.scriptTags,m=e.styleTags,y=e.title,T=e.titleAttributes;rc(we.BODY,i),rc(we.HTML,a),YL(y,T);var v={baseTag:qr(we.BASE,n),linkTags:qr(we.LINK,l),metaTags:qr(we.META,u),noscriptTags:qr(we.NOSCRIPT,f),scriptTags:qr(we.SCRIPT,p),styleTags:qr(we.STYLE,m)},x={},S={};Object.keys(v).forEach(function(R){var I=v[R],w=I.newTags,b=I.oldTags;w.length&&(x[R]=w),b.length&&(S[R]=v[R].oldTags)}),t&&t(),d(e,x,S)},Eg=function(e){return Array.isArray(e)?e.join(""):e},YL=function(e,t){typeof e<"u"&&document.title!==e&&(document.title=Eg(e)),rc(we.TITLE,t)},rc=function(e,t){var n=document.getElementsByTagName(e)[0];if(n){for(var i=n.getAttribute(Jt),a=i?i.split(","):[],l=[].concat(a),u=Object.keys(t),f=0;f<u.length;f++){var d=u[f],p=t[d]||"";n.getAttribute(d)!==p&&n.setAttribute(d,p),a.indexOf(d)===-1&&a.push(d);var m=l.indexOf(d);m!==-1&&l.splice(m,1)}for(var y=l.length-1;y>=0;y--)n.removeAttribute(l[y]);a.length===l.length?n.removeAttribute(Jt):n.getAttribute(Jt)!==u.join(",")&&n.setAttribute(Jt,u.join(","))}},qr=function(e,t){var n=document.head||document.querySelector(we.HEAD),i=n.querySelectorAll(e+"["+Jt+"]"),a=Array.prototype.slice.call(i),l=[],u=void 0;return t&&t.length&&t.forEach(function(f){var d=document.createElement(e);for(var p in f)if(f.hasOwnProperty(p))if(p===Ke.INNER_HTML)d.innerHTML=f.innerHTML;else if(p===Ke.CSS_TEXT)d.styleSheet?d.styleSheet.cssText=f.cssText:d.appendChild(document.createTextNode(f.cssText));else{var m=typeof f[p]>"u"?"":f[p];d.setAttribute(p,m)}d.setAttribute(Jt,"true"),a.some(function(y,T){return u=T,d.isEqualNode(y)})?a.splice(u,1):l.push(d)}),a.forEach(function(f){return f.parentNode.removeChild(f)}),l.forEach(function(f){return n.appendChild(f)}),{oldTags:a,newTags:l}},vg=function(e){return Object.keys(e).reduce(function(t,n){var i=typeof e[n]<"u"?n+'="'+e[n]+'"':""+n;return t?t+" "+i:i},"")},qL=function(e,t,n,i){var a=vg(n),l=Eg(t);return a?"<"+e+" "+Jt+'="true" '+a+">"+tc(l,i)+"</"+e+">":"<"+e+" "+Jt+'="true">'+tc(l,i)+"</"+e+">"},XL=function(e,t,n){return t.reduce(function(i,a){var l=Object.keys(a).filter(function(d){return!(d===Ke.INNER_HTML||d===Ke.CSS_TEXT)}).reduce(function(d,p){var m=typeof a[p]>"u"?p:p+'="'+tc(a[p],n)+'"';return d?d+" "+m:m},""),u=a.innerHTML||a.cssText||"",f=OL.indexOf(e)===-1;return i+"<"+e+" "+Jt+'="true" '+l+(f?"/>":">"+u+"</"+e+">")},"")},Tg=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Object.keys(e).reduce(function(n,i){return n[eo[i]||i]=e[i],n},t)},QL=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Object.keys(e).reduce(function(n,i){return n[bL[i]||i]=e[i],n},t)},JL=function(e,t,n){var i,a=(i={key:t},i[Jt]=!0,i),l=Tg(n,a);return[qi.createElement(we.TITLE,l,t)]},ZL=function(e,t){return t.map(function(n,i){var a,l=(a={key:i},a[Jt]=!0,a);return Object.keys(n).forEach(function(u){var f=eo[u]||u;if(f===Ke.INNER_HTML||f===Ke.CSS_TEXT){var d=n.innerHTML||n.cssText;l.dangerouslySetInnerHTML={__html:d}}else l[f]=n[u]}),qi.createElement(e,l)})},Rn=function(e,t,n){switch(e){case we.TITLE:return{toComponent:function(){return JL(e,t.title,t.titleAttributes)},toString:function(){return qL(e,t.title,t.titleAttributes,n)}};case Er.BODY:case Er.HTML:return{toComponent:function(){return Tg(t)},toString:function(){return vg(t)}};default:return{toComponent:function(){return ZL(e,t)},toString:function(){return XL(e,t,n)}}}},xg=function(e){var t=e.baseTag,n=e.bodyAttributes,i=e.encode,a=e.htmlAttributes,l=e.linkTags,u=e.metaTags,f=e.noscriptTags,d=e.scriptTags,p=e.styleTags,m=e.title,y=m===void 0?"":m,T=e.titleAttributes;return{base:Rn(we.BASE,t,i),bodyAttributes:Rn(Er.BODY,n,i),htmlAttributes:Rn(Er.HTML,a,i),link:Rn(we.LINK,l,i),meta:Rn(we.META,u,i),noscript:Rn(we.NOSCRIPT,f,i),script:Rn(we.SCRIPT,d,i),style:Rn(we.STYLE,p,i),title:Rn(we.TITLE,{title:y,titleAttributes:T},i)}},eA=function(e){var t,n;return n=t=function(i){UL(a,i);function a(){return NL(this,a),BL(this,i.apply(this,arguments))}return a.prototype.shouldComponentUpdate=function(u){return!kL(this.props,u)},a.prototype.mapNestedChildrenToProps=function(u,f){if(!f)return null;switch(u.type){case we.SCRIPT:case we.NOSCRIPT:return{innerHTML:f};case we.STYLE:return{cssText:f}}throw new Error("<"+u.type+" /> elements are self-closing and can not contain children. Refer to our API for more information.")},a.prototype.flattenArrayTypeChildren=function(u){var f,d=u.child,p=u.arrayTypeChildren,m=u.newChildProps,y=u.nestedChildren;return wt({},p,(f={},f[d.type]=[].concat(p[d.type]||[],[wt({},m,this.mapNestedChildrenToProps(d,y))]),f))},a.prototype.mapObjectTypeChildren=function(u){var f,d,p=u.child,m=u.newProps,y=u.newChildProps,T=u.nestedChildren;switch(p.type){case we.TITLE:return wt({},m,(f={},f[p.type]=T,f.titleAttributes=wt({},y),f));case we.BODY:return wt({},m,{bodyAttributes:wt({},y)});case we.HTML:return wt({},m,{htmlAttributes:wt({},y)})}return wt({},m,(d={},d[p.type]=wt({},y),d))},a.prototype.mapArrayTypeChildrenToProps=function(u,f){var d=wt({},f);return Object.keys(u).forEach(function(p){var m;d=wt({},d,(m={},m[p]=u[p],m))}),d},a.prototype.warnOnInvalidChildren=function(u,f){return!0},a.prototype.mapChildrenToProps=function(u,f){var d=this,p={};return qi.Children.forEach(u,function(m){if(!(!m||!m.props)){var y=m.props,T=y.children,v=Kp(y,["children"]),x=QL(v);switch(d.warnOnInvalidChildren(m,T),m.type){case we.LINK:case we.META:case we.NOSCRIPT:case we.SCRIPT:case we.STYLE:p=d.flattenArrayTypeChildren({child:m,arrayTypeChildren:p,newChildProps:x,nestedChildren:T});break;default:f=d.mapObjectTypeChildren({child:m,newProps:f,newChildProps:x,nestedChildren:T});break}}}),f=this.mapArrayTypeChildrenToProps(p,f),f},a.prototype.render=function(){var u=this.props,f=u.children,d=Kp(u,["children"]),p=wt({},d);return f&&(p=this.mapChildrenToProps(f,p)),qi.createElement(e,p)},ML(a,null,[{key:"canUseDOM",set:function(u){e.canUseDOM=u}}]),a}(qi.Component),t.propTypes={base:Ve.object,bodyAttributes:Ve.object,children:Ve.oneOfType([Ve.arrayOf(Ve.node),Ve.node]),defaultTitle:Ve.string,defer:Ve.bool,encodeSpecialCharacters:Ve.bool,htmlAttributes:Ve.object,link:Ve.arrayOf(Ve.object),meta:Ve.arrayOf(Ve.object),noscript:Ve.arrayOf(Ve.object),onChangeClientState:Ve.func,script:Ve.arrayOf(Ve.object),style:Ve.arrayOf(Ve.object),title:Ve.string,titleAttributes:Ve.object,titleTemplate:Ve.string},t.defaultProps={defer:!0,encodeSpecialCharacters:!0},t.peek=e.peek,t.rewind=function(){var i=e.rewind();return i||(i=xg({baseTag:[],bodyAttributes:{},encodeSpecialCharacters:!0,htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}})),i},n},tA=function(){return null},nA=wL(VL,WL,xg)(tA),ic=eA(nA);ic.renderStatic=ic.rewind;const rA=()=>X.jsxs("div",{className:"not-found-page",children:[X.jsxs(ic,{children:[X.jsx("title",{children:"Technolaar - Pagina Niet Gevonden"}),X.jsx("meta",{name:"description",content:"Oeps! De pagina die je zoekt, bestaat niet. Ga terug naar de homepagina of ontdek onze diensten."})]}),X.jsx("div",{className:"notFoundBannerContainer",children:X.jsxs("div",{className:"notFoundBannerText",children:[X.jsx("h1",{children:"404 - Pagina Niet Gevonden"}),X.jsx("p",{children:"Oeps! Het lijkt erop dat de pagina die je zoekt niet bestaat."}),X.jsx(Ge,{to:"/",className:"notFoundButton",children:"Terug naar Home"})]})})]}),iA=()=>X.jsxs("footer",{className:"footer",children:[X.jsx("div",{className:"footer-content",children:X.jsxs("div",{className:"footer-column",children:[X.jsx("h3",{children:" "}),X.jsx("nav",{children:X.jsxs("ul",{className:"nav-list_",children:[X.jsx("li",{children:X.jsx(Ge,{to:"/",className:"nav-link",children:" "})}),X.jsx("li",{children:X.jsx(Ge,{to:"/all-channels",className:"nav-link",children:" "})}),X.jsx("li",{children:X.jsx(Ge,{to:"/competitions",className:"nav-link",children:""})}),X.jsx("li",{children:X.jsx(Ge,{to:"/contact",className:"nav-link",children:" "})}),X.jsx("li",{children:X.jsx(Ge,{to:"/about-us",className:"nav-link",children:" "})})]})})]})}),X.jsx("div",{className:"social-icons",children:X.jsx("a",{href:"https://www.instagram.com/",target:"_blank",rel:"noopener noreferrer",children:X.jsx("i",{className:"bi bi-instagram"})})}),X.jsx("p",{children:" 2025 IPTV."})]}),sA=()=>{const[o,e]=j.useState(!1),[t,n]=j.useState(!1),i=Dn();return j.useEffect(()=>{const a=()=>{e(window.innerWidth<=800)};return a(),window.addEventListener("resize",a),()=>{window.removeEventListener("resize",a)}},[]),j.useEffect(()=>{n(!0);const a=setTimeout(()=>n(!1),500);return()=>clearTimeout(a)},[i]),X.jsxs(X.Fragment,{children:[X.jsx(qE,{}),o?X.jsx(QE,{}):X.jsx(XE,{}),X.jsxs(mE,{children:[X.jsx(Uu,{path:"*",element:X.jsx(rA,{})}),X.jsx(Uu,{path:"/",element:X.jsx(vL,{})})]}),X.jsx(iA,{})]})},aA=()=>X.jsx(BE,{children:X.jsx(sA,{})});Ry.createRoot(document.getElementById("root")).render(X.jsx(j.StrictMode,{children:X.jsx(aA,{})}));
